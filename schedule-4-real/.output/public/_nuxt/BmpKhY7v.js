import{u as ye,_ as te,P as oe,a as rt,b as lt,c as at,C as it,d as dt}from"./almKWk5M.js";import{u as _e}from"./Cz7lf8rL.js";import{r as Ye}from"./DFJA26za.js";import{r as he}from"./CzGeNOTF.js";import{e as Q,o as r,c as a,n as f,b as _,h as o,a as e,d as L,t as g,f as N,m as F,l as K,F as H,r as j,x as ee,w as G,V as q,B as me,X as je,A as ve,k as Be,Y as ge,Z as pe,K as We,g as Ge,E as xe,W as ct,i as ut,s as gt,I as pt}from"./BX4mYRdZ.js";import{_ as be}from"./DlAUqK2U.js";import{u as Ae}from"./CVT_MSpo.js";import{r as we,a as Ze}from"./Y-icRJYE.js";import{r as Ke}from"./F06shSjI.js";import{r as Xe}from"./B07yIJ9n.js";import{r as Je}from"./Bkx1wTcB.js";import{r as qe}from"./BjWiCCrg.js";import{_ as xt}from"./BdFmKGM_.js";import{u as Le}from"./fY7HK8F6.js";import{u as mt}from"./D6lpqsip.js";import{r as Re}from"./Cez9C7fJ.js";import{r as Se}from"./zbdaVbvj.js";import{r as yt}from"./DxwOEaLs.js";import{r as ze}from"./B-mFfkek.js";import{r as bt}from"./BIOD8Ggj.js";import{r as vt}from"./BACpAPNq.js";const ft={class:"flex items-center gap-2"},ht={class:"w-6 h-6 rounded-lg bg-blue-600 flex items-center justify-center shrink-0"},wt={key:0,class:"text-[8px] px-1 py-0.5 bg-purple-500/40 rounded text-purple-300 font-medium ml-auto flex items-center gap-0.5"},_t={class:"flex-1 flex flex-col justify-center"},kt={class:"text-sm font-bold text-white"},$t={class:"text-xs text-blue-200"},Ct={key:0,class:"text-blue-400"},Nt={key:0,class:"text-[9px] text-purple-300 mt-0.5"},St=Q({__name:"ConditionNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=_e(),x=$,l=F(()=>x.data.config),C=K(!1),{getEdges:h}=ye(),I=F(()=>h.value.some(w=>w.target===x.id)),V=F(()=>h.value.some(w=>w.source===x.id)),P=F(()=>l.value.timeSlots&&l.value.timeSlots.length>0?l.value.timeSlots[0]:{id:"default",startTime:"00:00",endTime:"00:00",weekmask:127,operator:l.value.operator||">",value:l.value.value||25,hysteresis:l.value.hysteresis||0}),T=F(()=>(l.value.timeSlots?.length||1)>1),n={temp:"Temperature",humi:"Humidity",co2:"COâ‚‚",vpd:"VPD",temp_soil:"Soil Temp",humi_soil:"Soil Moist",ec_soil:"Soil EC"},S={temp:"Â°C",humi:"%",co2:"ppm",vpd:"kPa",temp_soil:"Â°C",humi_soil:"%",ec_soil:"mS"},R={">":">","<":"<",">=":"â‰¥","<=":"â‰¤","==":"=","!=":"â‰ "},Z=F(()=>{const w=n[l.value.sensor]||l.value.sensor,p=l.value.deviceMac,D=l.value.sensor?.includes("soil"),E=v.lcDevices.length>1;return p&&E&&!D?`${v.devices[p]?.customName||p.slice(-4).toUpperCase()}: ${w}`:w}),U=F(()=>S[l.value.sensor]||""),m=F(()=>R[P.value.operator]||P.value.operator);return(w,p)=>(r(),a("div",{class:f(["condition-node px-4 py-3 rounded-xl border-2 min-w-[140px] min-h-[92px] shadow-lg transition-all flex flex-col",$.selected?"border-blue-400 bg-blue-900/90 shadow-blue-500/20":"border-blue-600/80 bg-blue-900/70"]),onMouseenter:p[0]||(p[0]=D=>C.value=!0),onMouseleave:p[1]||(p[1]=D=>C.value=!1)},[_(o(te),{type:"target",position:o(oe).Left,class:f(["!bg-blue-500 !border-blue-300 handle-hideable",{"handle-visible":o(C)||o(I)}])},null,8,["position","class"]),e("div",ft,[e("div",ht,[_(o(Ye),{class:"w-3.5 h-3.5 text-white"})]),p[2]||(p[2]=e("span",{class:"text-[10px] font-semibold text-blue-300 uppercase tracking-wide"},"Sensor",-1)),o(T)?(r(),a("span",wt,[_(o(he),{class:"w-2.5 h-2.5"}),L(" "+g(o(l).timeSlots?.length||1),1)])):N("",!0)]),e("div",_t,[e("div",kt,"IF "+g(o(Z)),1),e("div",$t,[L(g(o(m))+" "+g(o(P).value)+g(o(U))+" ",1),o(P).hysteresis>0?(r(),a("span",Ct,"(Â±"+g(o(P).hysteresis)+")",1)):N("",!0)]),o(T)?(r(),a("div",Nt," + "+g((o(l).timeSlots?.length||1)-1)+" more slots ",1)):N("",!0)]),_(o(te),{type:"source",position:o(oe).Right,class:f(["!bg-blue-500 !border-blue-300 handle-hideable",{"handle-visible":o(C)||o(V)}])},null,8,["position","class"])],34))}}),Tt=Object.assign(be(St,[["__scopeId","data-v-5935fd0c"]]),{__name:"TriggersNodesConditionNode"}),Ot={class:"flex items-center gap-2"},Mt={class:"w-6 h-6 rounded-lg bg-yellow-600 flex items-center justify-center shrink-0"},Ft={class:"flex-1 flex flex-col justify-center"},Dt={class:"text-sm font-bold text-white truncate"},Pt={class:"flex items-center gap-2"},It={key:0,class:"px-1 py-0.5 bg-green-600/50 text-green-300 text-[8px] font-bold rounded",title:"Mandatory ON"},Et={key:1,class:"px-1 py-0.5 bg-red-600/50 text-red-300 text-[8px] font-bold rounded",title:"Mandatory OFF"},Ht=Q({__name:"ActionNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const{getSocketDisplayName:v}=Ae(),x=_e(),l=$,C=F(()=>l.data.config),h=F(()=>{const T=v(C.value.socket,"name-only"),n=C.value.deviceMac,S=x.ps5Devices.length>1;return n&&S?`${x.devices[n]?.customName||n.slice(-4).toUpperCase()}: ${T}`:T}),I=K(!1),{getEdges:V}=ye(),P=F(()=>V.value.some(T=>T.target===l.id));return(T,n)=>(r(),a("div",{class:f(["action-node px-4 py-3 rounded-xl border-2 min-w-[140px] min-h-[92px] shadow-lg transition-all flex flex-col",$.selected?"border-yellow-400 bg-yellow-900/90 shadow-yellow-500/20":"border-yellow-600/80 bg-yellow-900/70"]),onMouseenter:n[0]||(n[0]=S=>I.value=!0),onMouseleave:n[1]||(n[1]=S=>I.value=!1)},[_(o(te),{type:"target",position:o(oe).Left,class:f(["!bg-yellow-500 !border-yellow-300 handle-hideable",{"handle-visible":o(I)||o(P)}])},null,8,["position","class"]),e("div",Ot,[e("div",Mt,[_(o(we),{class:"w-3.5 h-3.5 text-white"})]),n[2]||(n[2]=e("span",{class:"text-[10px] font-semibold text-yellow-300 uppercase tracking-wide"},"Action",-1))]),e("div",Ft,[e("div",Dt,g(o(h)),1),e("div",Pt,[e("div",{class:f(["text-sm font-semibold flex items-center gap-1",o(C).action==="on"?"text-green-400":"text-gray-400"])},[e("span",{class:f(["w-2 h-2 rounded-full",o(C).action==="on"?"bg-green-400":"bg-gray-500"])},null,2),L(" "+g(o(C).action==="on"?"ON":"OFF"),1)],2),o(C).mandatoryOn?(r(),a("span",It,"M-ON")):N("",!0),o(C).mandatoryOff?(r(),a("span",Et,"M-OFF")):N("",!0)])])],34))}}),Vt=Object.assign(be(Ht,[["__scopeId","data-v-7e2e60aa"]]),{__name:"TriggersNodesActionNode"}),jt={class:"flex items-center gap-2"},Rt={class:"w-6 h-6 rounded-lg bg-purple-600 flex items-center justify-center shrink-0"},Bt={key:0,class:"px-1 py-0.5 bg-green-600/50 text-green-300 text-[8px] font-bold rounded ml-auto",title:"Mandatory ON"},zt={class:"flex-1 flex flex-col justify-center overflow-hidden"},At={key:0},Lt={class:"text-sm font-bold text-white"},Ut={class:"text-[10px] text-purple-300 truncate"},Wt={key:1},Yt={class:"text-sm font-bold text-white"},Gt={class:"text-[10px] text-purple-300 truncate"},Zt={key:0},Kt=Q({__name:"ScheduleNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=$,x=F(()=>v.data.config),l=K(!1),{getEdges:C}=ye(),h=F(()=>C.value.some(T=>T.target===v.id)),I=F(()=>C.value.some(T=>T.source===v.id)),V=["M","T","W","T","F","S","S"],P=F(()=>{const T=x.value.weekmask||127;if(T===127)return"Every day";if(T===31)return"Weekdays";if(T===96)return"Weekends";const n=[];for(let S=0;S<7;S++)T&1<<S&&n.push(V[S]);return n.join("")});return(T,n)=>(r(),a("div",{class:f(["schedule-node px-4 py-3 rounded-xl border-2 min-w-[140px] min-h-[92px] shadow-lg transition-all flex flex-col",$.selected?"border-purple-400 bg-purple-900/90 shadow-purple-500/20":"border-purple-600/80 bg-purple-900/70"]),onMouseenter:n[0]||(n[0]=S=>l.value=!0),onMouseleave:n[1]||(n[1]=S=>l.value=!1)},[_(o(te),{type:"target",position:o(oe).Left,class:f(["!bg-purple-500 !border-purple-300 handle-hideable",{"handle-visible":o(l)||o(h)}])},null,8,["position","class"]),e("div",jt,[e("div",Rt,[_(o(he),{class:"w-3.5 h-3.5 text-white"})]),n[2]||(n[2]=e("span",{class:"text-[10px] font-semibold text-purple-300 uppercase tracking-wide"},"Schedule",-1)),o(x).mandatoryOn?(r(),a("span",Bt,"M-ON")):N("",!0),o(x).mandatoryOff?(r(),a("span",{key:1,class:f(["px-1 py-0.5 bg-red-600/50 text-red-300 text-[8px] font-bold rounded",{"ml-auto":!o(x).mandatoryOn}]),title:"Mandatory OFF"},"M-OFF",2)):N("",!0)]),e("div",zt,[o(x).scheduleType==="time_range"?(r(),a("div",At,[e("div",Lt,g(o(x).startTime)+" - "+g(o(x).endTime),1),e("div",Ut,g(o(P)),1)])):(r(),a("div",Wt,[e("div",Yt,"Every "+g(o(x).intervalMinutes)+"m / "+g(o(x).durationSeconds)+"s",1),e("div",Gt,[o(x).activeStartTime&&o(x).activeEndTime?(r(),a("span",Zt,g(o(x).activeStartTime)+"-"+g(o(x).activeEndTime)+" Â· ",1)):N("",!0),L(" "+g(o(P)),1)])]))]),_(o(te),{type:"source",position:o(oe).Right,class:f(["!bg-purple-500 !border-purple-300 handle-hideable",{"handle-visible":o(l)||o(I)}])},null,8,["position","class"])],34))}}),Xt=Object.assign(be(Kt,[["__scopeId","data-v-fe73c387"]]),{__name:"TriggersNodesScheduleNode"}),Jt={class:"flex items-center gap-2"},qt={class:"w-6 h-6 rounded-lg bg-green-600 flex items-center justify-center shrink-0"},Qt={class:"flex-1 flex flex-col justify-center"},eo={class:"text-sm font-bold text-white truncate"},to={class:"text-xs text-green-200 flex items-center gap-1"},oo=Q({__name:"StateNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const{getSocketDisplayName:v}=Ae(),x=_e(),l=$,C=F(()=>l.data.config),h=F(()=>{const n=v(C.value.socket,"name-only"),S=C.value.deviceMac,R=x.ps5Devices.length>1;return S&&R?`${x.devices[S]?.customName||S.slice(-4).toUpperCase()}: ${n}`:n}),I=K(!1),{getEdges:V}=ye(),P=F(()=>V.value.some(n=>n.target===l.id)),T=F(()=>V.value.some(n=>n.source===l.id));return(n,S)=>(r(),a("div",{class:f(["state-node px-4 py-3 rounded-xl border-2 min-w-[140px] min-h-[92px] shadow-lg transition-all flex flex-col",$.selected?"border-green-400 bg-green-900/90 shadow-green-500/20":"border-green-600/80 bg-green-900/70"]),onMouseenter:S[0]||(S[0]=R=>I.value=!0),onMouseleave:S[1]||(S[1]=R=>I.value=!1)},[_(o(te),{type:"target",position:o(oe).Left,class:f(["!bg-green-500 !border-green-300 handle-hideable",{"handle-visible":o(I)||o(P)}])},null,8,["position","class"]),e("div",Jt,[e("div",qt,[_(o(Ke),{class:"w-3.5 h-3.5 text-white"})]),S[2]||(S[2]=e("span",{class:"text-[10px] font-semibold text-green-300 uppercase tracking-wide"},"State",-1))]),e("div",Qt,[e("div",eo,"IF "+g(o(h)),1),e("div",to,[S[3]||(S[3]=L(" is ",-1)),e("span",{class:f(["font-semibold",o(C).checkState==="on"?"text-green-400":"text-gray-400"])},g(o(C).checkState==="on"?"ON":"OFF"),3),S[4]||(S[4]=L(" ? ",-1))])]),_(o(te),{type:"source",position:o(oe).Right,class:f(["!bg-green-500 !border-green-300 handle-hideable",{"handle-visible":o(I)||o(T)}])},null,8,["position","class"])],34))}}),so=Object.assign(be(oo,[["__scopeId","data-v-71d93881"]]),{__name:"TriggersNodesStateNode"}),no={class:"flex items-center gap-1.5 mb-1"},ro={class:"w-5 h-5 rounded-md bg-orange-600 flex items-center justify-center shrink-0"},lo={class:"text-[9px] font-semibold text-orange-300 uppercase tracking-wide truncate"},ao={key:0,class:"px-1 py-0.5 bg-green-600/50 text-green-300 text-[8px] font-bold rounded ml-auto",title:"Mandatory ON"},io={class:"flex items-center justify-between gap-2 min-w-[110px]"},co={class:"text-lg font-black text-white"},uo={key:0,class:"text-[9px] text-orange-300 flex items-center gap-1 mt-1"},go=Q({__name:"LogicNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=$,x=F(()=>v.data.config),l=K(!1),{getEdges:C}=ye(),h=F(()=>C.value.some(P=>P.target===v.id&&P.targetHandle==="input")),I=F(()=>C.value.some(P=>P.source===v.id&&P.sourceHandle==="then")),V=F(()=>C.value.some(P=>P.source===v.id&&(P.sourceHandle==="else"||P.sourceHandle==="else-top")));return(P,T)=>(r(),a("div",{class:f(["logic-node px-4 py-3 rounded-xl border-2 min-w-[140px] min-h-[92px] shadow-lg transition-all relative",$.selected?"border-orange-400 bg-orange-900/90 shadow-orange-500/20":"border-orange-600/80 bg-orange-900/70"]),onMouseenter:T[0]||(T[0]=n=>l.value=!0),onMouseleave:T[1]||(T[1]=n=>l.value=!1)},[_(o(te),{type:"target",position:o(oe).Left,id:"input",class:f(["!bg-orange-500 !border-orange-300 handle-hideable",{"handle-visible":o(l)||o(h)}])},null,8,["position","class"]),e("div",no,[e("div",ro,[_(o(Xe),{class:"w-3 h-3 text-white"})]),e("span",lo,g(o(x).name||"IF"),1),o(x).mandatoryOn?(r(),a("span",ao,"M-ON")):N("",!0),o(x).mandatoryOff?(r(),a("span",{key:1,class:f(["px-1 py-0.5 bg-red-600/50 text-red-300 text-[8px] font-bold rounded",{"ml-auto":!o(x).mandatoryOn}]),title:"Mandatory OFF"},"M-OFF",2)):N("",!0)]),e("div",io,[e("div",co,g(o(x).operator==="and"?"AND":"OR"),1),T[2]||(T[2]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-orange-400 text-sm"},"â†’"),e("span",{class:"text-lg font-black text-green-400"},"THEN")],-1))]),o(x).timeRestricted?(r(),a("div",uo,[_(o(he),{class:"w-3 h-3"}),L(" "+g(o(x).period==="day"?"Day":o(x).period==="night"?"Night":`${o(x).startTime} - ${o(x).endTime}`),1)])):N("",!0),T[3]||(T[3]=e("div",{class:"text-sm font-black text-red-400 text-center mt-1"},"ELSE",-1)),_(o(te),{type:"source",position:o(oe).Right,id:"then",class:f(["!bg-green-500 !border-green-300 handle-hideable",{"handle-visible":o(l)||o(I)}])},null,8,["position","class"]),_(o(te),{type:"source",position:o(oe).Top,id:"else-top",class:f(["!bg-red-500 !border-red-300 handle-hideable",{"handle-visible":o(l)||o(V)}])},null,8,["position","class"]),_(o(te),{type:"source",position:o(oe).Bottom,id:"else",class:f(["!bg-red-500 !border-red-300 handle-hideable",{"handle-visible":o(l)||o(V)}])},null,8,["position","class"])],34))}}),po=Object.assign(be(go,[["__scopeId","data-v-bec6103f"]]),{__name:"TriggersNodesLogicNode"}),xo={class:"flex items-center gap-2 mb-2"},mo={class:"text-sm text-white/90 whitespace-pre-wrap break-words"},yo=Q({__name:"NoteNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=$,x=F(()=>v.data.config),l={gray:"border-gray-500/80 bg-gray-800/90",blue:"border-blue-500/80 bg-blue-900/90",green:"border-green-500/80 bg-green-900/90",yellow:"border-yellow-500/80 bg-yellow-900/90",red:"border-red-500/80 bg-red-900/90",purple:"border-purple-500/80 bg-purple-900/90"},C={gray:"bg-gray-600",blue:"bg-blue-600",green:"bg-green-600",yellow:"bg-yellow-600",red:"bg-red-600",purple:"bg-purple-600"};return(h,I)=>(r(),a("div",{class:f(["px-4 py-3 rounded-xl border-2 min-w-[120px] max-w-[200px] shadow-lg transition-all",l[o(x).color]||l.gray,$.selected?"ring-2 ring-white/50":""])},[e("div",xo,[e("div",{class:f(["w-5 h-5 rounded flex items-center justify-center",C[o(x).color]||C.gray])},[_(o(Je),{class:"w-3 h-3 text-white"})],2),I[0]||(I[0]=e("span",{class:"text-[10px] font-semibold uppercase tracking-wide opacity-70"},"Note",-1))]),e("div",mo,g(o(x).text||"Empty note"),1)],2))}}),bo=Object.assign(yo,{__name:"TriggersNodesNoteNode"}),vo={class:"flex items-center gap-2"},fo={class:"w-6 h-6 rounded-lg bg-teal-600 flex items-center justify-center shrink-0"},ho={class:"text-sm font-bold text-white"},wo={class:"text-xs text-teal-200"},_o={class:"text-[10px] text-teal-400"},ko={class:"text-[9px] text-gray-500"},$o=Q({__name:"VpdControlNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=$,x=F(()=>v.data.config),l=F(()=>x.value.mode==="manual"?`${x.value.manualTarget.min} - ${x.value.manualTarget.max}`:"Phase-based");return(C,h)=>(r(),a("div",{class:f(["vpd-control-node px-4 py-3 rounded-xl border-2 min-w-[180px] shadow-lg transition-all flex flex-col gap-1",$.selected?"border-teal-400 bg-teal-900/90 shadow-teal-500/20":"border-teal-600/80 bg-teal-900/70"])},[e("div",vo,[e("div",fo,[_(o(Ze),{class:"w-3.5 h-3.5 text-white"})]),h[0]||(h[0]=e("span",{class:"text-[10px] font-semibold text-teal-300 uppercase tracking-wide"},"VPD Control",-1))]),e("div",ho,g(o(x).mode==="manual"?"Manual":"Plant Stage"),1),e("div",wo,g(o(l))+" kPa ",1),e("div",_o,g(o(x).roles.length)+" device"+g(o(x).roles.length!==1?"s":"")+" assigned ",1),e("div",ko," Escalation: "+g(Math.round(o(x).escalationTimeoutSeconds/60))+"min ",1)],2))}}),Co=Object.assign($o,{__name:"TriggersNodesVpdControlNode"}),No={class:"flex items-center justify-between"},So={class:"flex items-center gap-2"},To={class:"w-6 h-6 rounded-lg bg-cyan-600 flex items-center justify-center shrink-0"},Oo={class:"text-[10px] text-cyan-400 bg-cyan-900/60 px-2 py-0.5 rounded"},Mo={key:0,class:"space-y-3"},Fo={class:"flex items-center justify-between mb-2"},Do={class:"text-[11px] text-cyan-400 font-semibold uppercase tracking-wide"},Po={key:0,class:"text-[9px] text-amber-400"},Io=["viewBox"],Eo=["x1","y1","x2","y2"],Ho=["x1","y1","x2","y2"],Vo=["x1","y1","x2","y2"],jo=["x1","y1","x2","y2"],Ro=["x","y"],Bo=["x","y"],zo=["x","y"],Ao=["x","y"],Lo=["x","y"],Uo=["x","y"],Wo=["y"],Yo=["x","y"],Go=["points"],Zo=["points"],Ko=["cx","cy"],Xo=["x","y"],Jo={class:"flex flex-wrap gap-2 mt-2"},qo={key:1,class:"text-sm text-gray-500 text-center py-4 bg-gray-900/40 rounded-lg"},ce=280,W=90,Qo=Q({__name:"BlowerCurveNode",props:{id:{},data:{},selected:{type:Boolean}},setup($){const v=$,x=F(()=>v.data.config),l={left:32,right:12,top:14,bottom:18},C={temp:"Temperature",humi:"Humidity",co2:"CO2",vpd:"VPD"},h={temp:"Â°C",humi:"%",co2:"ppm",vpd:"kPa"},I=F(()=>x.value.curves?.filter(m=>m.enabled)||[]);function V(m){return h[m]||""}function P(m){return!m.points||m.points.length===0?0:Math.min(...m.points.map(w=>w.value))}function T(m){return!m.points||m.points.length===0?100:Math.max(...m.points.map(w=>w.value))}function n(m,w){return w==="vpd"?m.toFixed(1):w==="co2"?String(Math.round(m)):w==="temp"?m.toFixed(1):m.toFixed(0)}function S(m,w){const p=P(m),E=T(m)-p||1,B=ce-l.left-l.right;return l.left+(w-p)/E*B}function R(m){const w=W-l.top-l.bottom;return l.top+(1-m/100)*w}function Z(m){return!m.points||m.points.length===0?"":[...m.points].sort((p,D)=>p.value-D.value).map(p=>`${S(m,p.value)},${R(p.speed)}`).join(" ")}function U(m){if(!m.points||m.points.length===0)return"";const w=[...m.points].sort((se,k)=>se.value-k.value),p=w.map(se=>`${S(m,se.value)},${R(se.speed)}`).join(" "),D=W-l.bottom,E=S(m,w[0].value),B=S(m,w[w.length-1].value);return`${E},${D} ${p} ${B},${D}`}return(m,w)=>(r(),a("div",{class:f(["blower-curve-node px-4 py-3 rounded-xl border-2 min-w-[340px] shadow-lg transition-all flex flex-col gap-3",$.selected?"border-cyan-400 bg-cyan-900/90 shadow-cyan-500/20":"border-cyan-600/80 bg-cyan-900/70"])},[e("div",No,[e("div",So,[e("div",To,[_(o(qe),{class:"w-3.5 h-3.5 text-white"})]),w[0]||(w[0]=e("span",{class:"text-xs font-semibold text-cyan-300 uppercase tracking-wide"},"Blower Curve Control",-1))]),e("span",Oo," Standby: "+g(o(x).standbySpeed===0?"Off":o(x).standbySpeed+"%"),1)]),o(I).length>0?(r(),a("div",Mo,[(r(!0),a(H,null,j(o(I),p=>(r(),a("div",{key:p.id,class:"bg-gray-900/60 rounded-xl p-3"},[e("div",Fo,[e("span",Do,g(C[p.sensor]),1),p.escalation?.enabled?(r(),a("span",Po," âš¡ Escalation ")):N("",!0)]),(r(),a("svg",{viewBox:`0 0 ${ce} ${W}`,class:"w-full h-24 bg-gray-950/40 rounded-lg"},[(r(),a(H,null,j(4,D=>e("line",{key:"h"+D,x1:l.left,y1:l.top+(D-1)/3*(W-l.top-l.bottom),x2:ce-l.right,y2:l.top+(D-1)/3*(W-l.top-l.bottom),stroke:"#374151","stroke-width":"0.5","stroke-dasharray":"2,2"},null,8,Eo)),64)),(r(),a(H,null,j(5,D=>e("line",{key:"v"+D,x1:l.left+(D-1)/4*(ce-l.left-l.right),y1:l.top,x2:l.left+(D-1)/4*(ce-l.left-l.right),y2:W-l.bottom,stroke:"#374151","stroke-width":"0.5","stroke-dasharray":"2,2"},null,8,Ho)),64)),e("line",{x1:l.left,y1:l.top,x2:l.left,y2:W-l.bottom,stroke:"#4b5563","stroke-width":"1"},null,8,Vo),e("line",{x1:l.left,y1:W-l.bottom,x2:ce-l.right,y2:W-l.bottom,stroke:"#4b5563","stroke-width":"1"},null,8,jo),e("text",{x:l.left-4,y:l.top+3,class:"text-[8px] fill-gray-400","text-anchor":"end"},"100%",8,Ro),e("text",{x:l.left-4,y:(l.top+W-l.bottom)/2+2,class:"text-[8px] fill-gray-400","text-anchor":"end"},"50%",8,Bo),e("text",{x:l.left-4,y:W-l.bottom+3,class:"text-[8px] fill-gray-400","text-anchor":"end"},"0%",8,zo),e("text",{x:l.left,y:W-l.bottom+12,class:"text-[8px] fill-gray-400","text-anchor":"middle"},g(n(P(p),p.sensor)),9,Ao),e("text",{x:(l.left+ce-l.right)/2,y:W-l.bottom+12,class:"text-[8px] fill-gray-400","text-anchor":"middle"},g(n((P(p)+T(p))/2,p.sensor)),9,Lo),e("text",{x:ce-l.right,y:W-l.bottom+12,class:"text-[8px] fill-gray-400","text-anchor":"middle"},g(n(T(p),p.sensor)),9,Uo),e("text",{x:4,y:(l.top+W-l.bottom)/2,class:"text-[7px] fill-gray-500",transform:"rotate(-90, 4, 45)"},"Speed",8,Wo),e("text",{x:ce/2,y:W-2,class:"text-[7px] fill-gray-500","text-anchor":"middle"},g(V(p.sensor)),9,Yo),e("polygon",{points:U(p),fill:"url(#curveGradient)",opacity:"0.3"},null,8,Go),e("polyline",{points:Z(p),fill:"none",stroke:"#22d3ee","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Zo),(r(!0),a(H,null,j(p.points,(D,E)=>(r(),a("g",{key:E},[e("circle",{cx:S(p,D.value),cy:R(D.speed),r:"4",fill:"#22d3ee",stroke:"#0e7490","stroke-width":"1"},null,8,Ko),e("text",{x:S(p,D.value),y:R(D.speed)-7,class:"text-[7px] fill-cyan-300 font-medium","text-anchor":"middle"},g(D.speed)+"%",9,Xo)]))),128)),w[1]||(w[1]=e("defs",null,[e("linearGradient",{id:"curveGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"#22d3ee","stop-opacity":"0.6"}}),e("stop",{offset:"100%",style:{"stop-color":"#22d3ee","stop-opacity":"0"}})])],-1))],8,Io)),e("div",Jo,[(r(!0),a(H,null,j(p.points,(D,E)=>(r(),a("span",{key:E,class:"text-[9px] text-gray-300 bg-gray-800/60 px-1.5 py-0.5 rounded"},g(n(D.value,p.sensor))+g(V(p.sensor))+" â†’ "+g(D.speed)+"% ",1))),128))])]))),128))])):(r(),a("div",qo," No curves configured "))],2))}}),es=Object.assign(Qo,{__name:"TriggersNodesBlowerCurveNode"}),ts={name:"ControlButton",compatConfig:{MODE:3}},os=($,v)=>{const x=$.__vccOpts||$;for(const[l,C]of v)x[l]=C;return x},ss={type:"button",class:"vue-flow__controls-button"};function ns($,v,x,l,C,h){return r(),a("button",ss,[q($.$slots,"default")])}const Te=os(ts,[["render",ns]]),rs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ls=e("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),as=[ls];function is($,v){return r(),a("svg",rs,as)}const ds={render:is},cs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},us=e("path",{d:"M0 0h32v4.2H0z"},null,-1),gs=[us];function ps($,v){return r(),a("svg",cs,gs)}const xs={render:ps},ms={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},ys=e("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0 0 27.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94a.919.919 0 0 1-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"},null,-1),bs=[ys];function vs($,v){return r(),a("svg",ms,bs)}const fs={render:vs},hs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ws=e("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"},null,-1),_s=[ws];function ks($,v){return r(),a("svg",hs,_s)}const $s={render:ks},Cs={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Ns=e("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047z"},null,-1),Ss=[Ns];function Ts($,v){return r(),a("svg",Cs,Ss)}const Os={render:Ts},Ms={name:"Controls",compatConfig:{MODE:3}},Fs=Q({...Ms,props:{showZoom:{type:Boolean,default:!0},showFitView:{type:Boolean,default:!0},showInteractive:{type:Boolean,default:!0},fitViewParams:{},position:{default:()=>rt.BottomLeft}},emits:["zoomIn","zoomOut","fitView","interactionChange"],setup($,{emit:v}){const{nodesDraggable:x,nodesConnectable:l,elementsSelectable:C,setInteractive:h,zoomIn:I,zoomOut:V,fitView:P,viewport:T,minZoom:n,maxZoom:S}=ye(),R=je(()=>x.value||l.value||C.value),Z=je(()=>T.value.zoom<=n.value),U=je(()=>T.value.zoom>=S.value);function m(){I(),v("zoomIn")}function w(){V(),v("zoomOut")}function p(){P($.fitViewParams),v("fitView")}function D(){h(!R.value),v("interactionChange",!R.value)}return(E,B)=>(r(),ee(o(lt),{class:"vue-flow__controls",position:E.position},{default:G(()=>[q(E.$slots,"top"),E.showZoom?(r(),a(H,{key:0},[q(E.$slots,"control-zoom-in",{},()=>[_(Te,{class:"vue-flow__controls-zoomin",disabled:U.value,onClick:m},{default:G(()=>[q(E.$slots,"icon-zoom-in",{},()=>[(r(),ee(me(o(ds))))])]),_:3},8,["disabled"])]),q(E.$slots,"control-zoom-out",{},()=>[_(Te,{class:"vue-flow__controls-zoomout",disabled:Z.value,onClick:w},{default:G(()=>[q(E.$slots,"icon-zoom-out",{},()=>[(r(),ee(me(o(xs))))])]),_:3},8,["disabled"])])],64)):N("",!0),E.showFitView?q(E.$slots,"control-fit-view",{key:1},()=>[_(Te,{class:"vue-flow__controls-fitview",onClick:p},{default:G(()=>[q(E.$slots,"icon-fit-view",{},()=>[(r(),ee(me(o(fs))))])]),_:3})]):N("",!0),E.showInteractive?q(E.$slots,"control-interactive",{key:2},()=>[E.showInteractive?(r(),ee(Te,{key:0,class:"vue-flow__controls-interactive",onClick:D},{default:G(()=>[R.value?q(E.$slots,"icon-unlock",{key:0},()=>[(r(),ee(me(o(Os))))]):N("",!0),R.value?N("",!0):q(E.$slots,"icon-lock",{key:1},()=>[(r(),ee(me(o($s))))])]),_:3})):N("",!0)]):N("",!0),q(E.$slots,"default")]),_:3},8,["position"]))}}),Ds={key:0,class:"absolute inset-4 border-2 border-dashed border-spider-green-500/60 rounded-2xl bg-gradient-to-br from-spider-green-500/10 to-emerald-600/5 backdrop-blur-sm pointer-events-none z-10 flex items-center justify-center"},Ps={key:1,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},Is={class:"text-center p-8 rounded-2xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 relative overflow-hidden"},Es={class:"relative"},Hs={class:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-yellow-500/30 to-amber-600/20 flex items-center justify-center"},Oe=160,fe=100,Y=20,Vs=Q({__name:"FlowCanvas",emits:["nodeSelect"],setup($,{emit:v}){const x=v,l=Le(),C=K(null),h=K(!1),{screenToFlowCoordinate:I,addEdges:V,getSelectedNodes:P,getSelectedEdges:T,removeNodes:n,removeEdges:S,fitView:R}=ye();function Z(y){if(y.key==="Delete"||y.key==="Backspace"){let d=P.value;const b=T.value;if(d.length===0&&l.selectedNodeId){const O=m.value.find(M=>M.id===l.selectedNodeId);O&&(d=[O])}if(d.length>0){const O=d.map(M=>M.id);n(O);for(const M of O)l.deleteNode(M)}if(b.length>0){const O=b.map(M=>M.id);S(O);for(const M of O)l.deleteConnection(M)}(d.length>0||b.length>0)&&(x("nodeSelect",null),y.preventDefault())}}const U={type:"smoothstep",animated:!0,style:{stroke:"#6366f1",strokeWidth:2},pathOptions:{offset:15,borderRadius:20}},m=K([]),w=K([]);let p=!1;function D(y,d){return!(y.x+Oe<=d.x||d.x+Oe<=y.x||y.y+fe<=d.y||d.y+fe<=y.y)}function E(y,d){for(const b of m.value)if(b.id!==d&&D(y,b.position))return!0;return!1}function B(y,d){let b=Math.round(y.x/Y)*Y,O=Math.round(y.y/Y)*Y;if(!E({x:b,y:O},d))return{x:b,y:O};const M=[{dx:1,dy:0},{dx:0,dy:1},{dx:-1,dy:0},{dx:0,dy:-1},{dx:1,dy:1},{dx:-1,dy:1},{dx:1,dy:-1},{dx:-1,dy:-1}],z=Math.ceil(Oe/Y)*Y,X=Math.ceil(fe/Y)*Y;for(let ie=1;ie<=20;ie++)for(const ue of M){const re={x:b+ue.dx*z*ie,y:O+ue.dy*X*ie};if(!E(re,d))return re}return{x:b+Oe*2,y:O}}function se(y,d){return{id:y.id,type:y.type,position:{...y.position},data:{...y.data},selected:y.id===d}}ve(()=>l.currentFlow?.id,y=>{if(y&&l.currentFlow){const d=l.currentFlow;m.value=d.flow.nodes.map(b=>se(b,l.selectedNodeId)),w.value=d.flow.connections.map(b=>({id:b.id,source:b.source,sourceHandle:b.sourceHandle,target:b.target,targetHandle:b.targetHandle,...U})),p=!0,We(()=>{setTimeout(()=>{m.value.length>0&&(R({padding:.2,duration:200}),Ce())},100)})}},{immediate:!0}),ve(()=>l.currentFlow?.flow.nodes.length,(y,d)=>{if(!(!p||!l.currentFlow)&&(y??0)>(d??0)){const b=l.currentFlow.flow.nodes,O=new Set(m.value.map(z=>z.id)),M=b.filter(z=>!O.has(z.id));for(const z of M)m.value.push(se(z,l.selectedNodeId))}}),ve(()=>l.selectedNodeId,y=>{m.value=m.value.map(d=>({...d,selected:d.id===y}))}),ve(()=>l.currentFlow?.flow.nodes.map(y=>JSON.stringify(y.data.config)),()=>{if(!l.currentFlow)return;const y=l.currentFlow.flow.nodes;m.value=m.value.map(d=>{const b=y.find(O=>O.id===d.id);return b&&JSON.stringify(d.data.config)!==JSON.stringify(b.data.config)?{...d,data:{...d.data,config:{...b.data.config}}}:d})},{deep:!0}),ve(()=>l.currentFlow?.flow.nodes.length,(y,d)=>{if(l.currentFlow&&y!==void 0&&d!==void 0&&y<d){const b=new Set(l.currentFlow.flow.nodes.map(M=>M.id)),O=m.value.filter(M=>!b.has(M.id));if(O.length>0){const M=O.map(z=>z.id);n(M)}}}),ve(()=>l.currentFlow?.flow.connections.length,(y,d)=>{if(l.currentFlow&&y!==void 0&&d!==void 0&&y<d){const b=new Set(l.currentFlow.flow.connections.map(M=>M.id)),O=w.value.filter(M=>!b.has(M.id));if(O.length>0){const M=O.map(z=>z.id);S(M)}}});function k(y){y.preventDefault(),y.dataTransfer&&(y.dataTransfer.dropEffect="move"),h.value=!0}function Me(){h.value=!1}function le(y){y.preventDefault(),h.value=!1;const d=y.dataTransfer?.getData("application/vueflow");if(!d||!C.value)return;const b=I({x:y.clientX,y:y.clientY}),O=B({x:Math.round(b.x/Y)*Y,y:Math.round(b.y/Y)*Y}),M=l.addNode(d,O);M&&x("nodeSelect",M.id)}function ne(y){x("nodeSelect",y.node.id),C.value?.focus()}function Fe(){x("nodeSelect",null),C.value?.focus()}function De(y){const d=y.edge.id;S([d]),l.deleteConnection(d)}function ke(y){}function Pe(y){}function Ie(y,d){return l.currentFlow?l.currentFlow.flow.connections.some(b=>b.source===y&&b.target===d):!1}function Ee(y){const{source:d,target:b,sourceHandle:O,targetHandle:M}=y;if(d===b||Ie(d,b))return;const z=m.value.find(re=>re.id===d),X=m.value.find(re=>re.id===b);z?.type,X?.type;const ue={id:`conn-${Date.now()}`,source:d,sourceHandle:O,target:b,targetHandle:M,...U};w.value=[...w.value,ue],l.addConnection({source:d,sourceHandle:O,target:b,targetHandle:M})}function $e(y,d){const b=y.position.y,O=d.position.y,z=b+fe/2;return O+fe/2<z?"else-top":"else"}function Ce(){let y=!1;const d=w.value.map(b=>{if(b.sourceHandle!=="else"&&b.sourceHandle!=="else-top")return b;const O=m.value.find(X=>X.id===b.source),M=m.value.find(X=>X.id===b.target);if(!O||!M)return b;const z=$e(O,M);return b.sourceHandle!==z?(y=!0,l.updateConnection(b.id,{sourceHandle:z}),{...b,sourceHandle:z}):b});y&&(w.value=d)}function He(y){for(const d of y){if(d.type==="position"&&d.dragging===!1){const b=m.value.find(O=>O.id===d.id);if(b&&b.position){const O={x:Math.round(b.position.x/Y)*Y,y:Math.round(b.position.y/Y)*Y},M=B(O,d.id);l.updateNode(d.id,{position:M}),b.position=M,We(()=>{Ce()})}}d.type==="remove"&&l.deleteNode(d.id)}}function ae(y){for(const d of y)d.type==="remove"&&l.deleteConnection(d.id)}return(y,d)=>{const b=Tt,O=Vt,M=Xt,z=so,X=po,ie=bo,ue=Co,re=es,Ve=xt;return r(),a("div",{ref_key:"canvasWrapper",ref:C,class:"relative h-full bg-gray-900 outline-none",onDrop:le,onDragover:k,onDragleave:Me,onKeydown:Z,tabindex:"0"},[o(h)?(r(),a("div",Ds,[...d[2]||(d[2]=[e("div",{class:"px-4 py-2 bg-spider-green-500/20 rounded-xl border border-spider-green-500/40"},[e("span",{class:"text-spider-green-400 text-sm font-semibold"},"Drop node here")],-1)])])):N("",!0),_(Ve,null,{fallback:G(()=>[...d[3]||(d[3]=[e("div",{class:"h-full flex items-center justify-center"},[e("div",{class:"text-gray-500"},"Loading flow editor...")],-1)])]),default:G(()=>[_(o(at),{nodes:o(m),"onUpdate:nodes":d[0]||(d[0]=A=>Be(m)?m.value=A:null),edges:o(w),"onUpdate:edges":d[1]||(d[1]=A=>Be(w)?w.value=A:null),"default-viewport":{zoom:1,x:50,y:50},"min-zoom":.25,"max-zoom":2,"snap-to-grid":!0,"snap-grid":[20,20],"connection-mode":o(it).Loose,"delete-key-code":["Backspace","Delete"],"default-edge-options":U,"connect-on-click":!1,onNodeClick:ne,onPaneClick:Fe,onEdgeClick:De,onConnect:Ee,onConnectStart:ke,onConnectEnd:Pe,onNodesChange:He,onEdgesChange:ae},{"node-condition":G(A=>[_(b,ge(pe(A)),null,16)]),"node-action":G(A=>[_(O,ge(pe(A)),null,16)]),"node-schedule":G(A=>[_(M,ge(pe(A)),null,16)]),"node-state":G(A=>[_(z,ge(pe(A)),null,16)]),"node-logic":G(A=>[_(X,ge(pe(A)),null,16)]),"node-note":G(A=>[_(ie,ge(pe(A)),null,16)]),"node-vpd_control":G(A=>[_(ue,ge(pe(A)),null,16)]),"node-blower_curve":G(A=>[_(re,ge(pe(A)),null,16)]),default:G(()=>[_(o(dt),{gap:20,size:1,"pattern-color":"#374151"}),_(o(Fs),{position:"bottom-right","show-interactive":!1})]),_:1},8,["nodes","edges","connection-mode"])]),_:1}),!o(m).length&&!o(h)?(r(),a("div",Ps,[e("div",Is,[d[6]||(d[6]=e("div",{class:"absolute -top-6 -left-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-yellow-500/15"},null,-1)),e("div",Es,[e("div",Hs,[_(o(we),{class:"w-8 h-8 text-yellow-400"})]),d[4]||(d[4]=e("p",{class:"text-gray-300 text-lg font-semibold mb-1"},"No automation configured",-1)),d[5]||(d[5]=e("p",{class:"text-gray-500 text-sm"},"Drag nodes from the right panel to get started",-1))])])])):N("",!0)],544)}}}),js=Object.assign(Vs,{__name:"TriggersFlowCanvas"}),Rs={class:"w-64 sm:w-72 h-full flex-1 bg-gradient-to-b from-gray-800/95 to-gray-900/95 backdrop-blur-md border-l border-gray-700/50 flex flex-col overflow-hidden relative"},Bs={class:"px-3 sm:px-4 py-2.5 sm:py-3 border-b border-gray-700/50 flex items-center justify-between relative"},zs={class:"text-sm font-semibold text-white"},As={class:"flex-1 flex flex-col overflow-hidden p-3 sm:p-4 relative"},Ls={key:0,class:"space-y-2.5 overflow-y-auto"},Us=["onDragstart","onClick"],Ws={class:"flex-1"},Ys={class:"text-sm font-semibold text-white"},Gs={class:"text-[11px] text-gray-400 mt-0.5"},Zs={key:1,class:"flex flex-col flex-1 min-h-0 gap-4 overflow-y-auto"},Ks={class:"flex items-center gap-3 pb-3 border-b border-gray-700/50"},Xs={class:"text-sm font-semibold text-white"},Js={class:"text-[10px] text-gray-500 font-mono"},qs={key:0,class:"flex flex-col flex-1 min-h-0 gap-4"},Qs=["value"],en={key:0},tn=["value"],on=["value"],sn={class:"flex flex-col flex-1 min-h-0"},nn={class:"flex items-center justify-between mb-3"},rn={key:0,class:"p-2.5 bg-gradient-to-r from-red-900/30 to-red-800/20 border border-red-700/50 rounded-xl"},ln={class:"text-[10px] text-red-400 font-medium"},an={class:"space-y-2 flex-1 overflow-y-auto"},dn={class:"flex items-center justify-between mb-2"},cn=["onClick"],un={class:"text-xs font-medium text-white"},gn={class:"text-[10px] text-gray-500"},pn=["onClick"],xn={key:0,class:"text-xs text-blue-300"},mn={key:0,class:"text-blue-400"},yn={key:1,class:"space-y-3 mt-3 pt-3 border-t border-gray-600"},bn={class:"flex gap-1"},vn=["onClick"],fn={key:0,class:"text-[9px] text-gray-500 mt-1"},hn={key:0,class:"grid grid-cols-2 gap-2"},wn=["value","onChange"],_n=["value","onChange"],kn={class:"flex gap-1"},$n=["onClick"],Cn={class:"grid grid-cols-2 gap-2"},Nn=["value","onChange"],Sn=["value","onInput"],Tn=["value","onInput"],On={key:1,class:"space-y-4"},Mn={key:0},Fn=["value"],Dn=["value"],Pn={class:"grid grid-cols-1 gap-1"},In=["onClick"],En={class:"grid grid-cols-2 gap-2"},Hn={class:"space-y-2"},Vn={class:"flex items-center gap-3 p-3 bg-green-900/20 border border-green-800/50 rounded-lg cursor-pointer hover:bg-green-900/30"},jn=["checked"],Rn={class:"flex items-center gap-3 p-3 bg-red-900/20 border border-red-800/50 rounded-lg cursor-pointer hover:bg-red-900/30"},Bn=["checked"],zn={key:2,class:"space-y-4"},An={class:"grid grid-cols-2 gap-2"},Ln={key:0,class:"space-y-3"},Un={class:"flex gap-1"},Wn=["onClick"],Yn={key:0,class:"text-[10px] text-gray-500 mt-1"},Gn={key:0,class:"grid grid-cols-2 gap-3"},Zn=["value"],Kn=["value"],Xn={key:1,class:"space-y-3"},Jn={class:"p-3 bg-gray-700/50 rounded-lg space-y-3"},qn={class:"grid grid-cols-2 gap-3"},Qn=["value"],er=["value"],tr={class:"p-3 bg-gray-700/50 rounded-lg space-y-3"},or={class:"flex gap-1"},sr=["onClick"],nr={key:0,class:"text-[9px] text-gray-500 mt-1"},rr={key:0,class:"grid grid-cols-2 gap-3"},lr=["value"],ar=["value"],ir={class:"flex gap-1"},dr=["onClick"],cr={class:"space-y-2"},ur={class:"flex items-center gap-3 p-3 bg-green-900/20 border border-green-800/50 rounded-lg cursor-pointer hover:bg-green-900/30"},gr=["checked"],pr={class:"flex items-center gap-3 p-3 bg-red-900/20 border border-red-800/50 rounded-lg cursor-pointer hover:bg-red-900/30"},xr=["checked"],mr={key:3,class:"space-y-4"},yr={key:0},br=["value"],vr=["value"],fr={class:"grid grid-cols-1 gap-1"},hr=["onClick"],wr={class:"grid grid-cols-2 gap-2"},_r={class:"space-y-3"},kr={class:"flex items-center gap-3 p-3 bg-purple-900/20 border border-purple-800/50 rounded-lg cursor-pointer hover:bg-purple-900/30"},$r=["checked"],Cr={class:"flex gap-1"},Nr=["onClick"],Sr={key:0,class:"text-[10px] text-gray-500 mt-1"},Tr={key:0,class:"grid grid-cols-2 gap-3 p-3 bg-gray-700/50 rounded-lg"},Or=["value"],Mr=["value"],Fr={key:4,class:"space-y-4"},Dr=["value"],Pr={class:"grid grid-cols-2 gap-2"},Ir={class:"space-y-3"},Er={class:"flex items-center gap-3 p-3 bg-purple-900/20 border border-purple-800/50 rounded-lg cursor-pointer hover:bg-purple-900/30"},Hr=["checked"],Vr={key:0,class:"space-y-3"},jr={class:"flex gap-1"},Rr=["onClick"],Br={key:0,class:"text-[10px] text-gray-500 mt-1"},zr={key:0,class:"grid grid-cols-2 gap-3 p-3 bg-gray-700/50 rounded-lg"},Ar=["value"],Lr=["value"],Ur={class:"space-y-2"},Wr={class:"flex items-center gap-3 p-3 bg-green-900/20 border border-green-800/50 rounded-lg cursor-pointer hover:bg-green-900/30"},Yr=["checked"],Gr={class:"flex items-center gap-3 p-3 bg-red-900/20 border border-red-800/50 rounded-lg cursor-pointer hover:bg-red-900/30"},Zr=["checked"],Kr={key:5,class:"space-y-4"},Xr=["value"],Jr={class:"grid grid-cols-6 gap-1"},qr=["onClick","title"],Qr={key:6,class:"space-y-4"},el={class:"grid grid-cols-2 gap-2"},tl={key:0,class:"space-y-2"},ol={class:"grid grid-cols-2 gap-2"},sl=["value"],nl=["value"],rl={key:1,class:"space-y-2"},ll={class:"space-y-1.5"},al={class:"text-[10px] text-gray-400 w-14 shrink-0"},il=["value","onInput"],dl=["value","onInput"],cl={key:1,class:"text-[10px] text-gray-600 italic"},ul={key:2},gl=["value"],pl=["value"],xl={class:"space-y-2"},ml=["value","onChange"],yl=["value"],bl=["value","onChange"],vl=["value"],fl=["value","onChange"],hl=["onClick"],wl={class:"flex items-center gap-2"},_l=["value"],kl={class:"flex items-center gap-2"},$l=["value"],Cl={key:7,class:"space-y-4"},Nl={class:"flex items-center gap-3"},Sl=["value"],Tl={class:"text-sm font-medium text-cyan-400 w-12 text-right"},Ol={class:"space-y-3"},Ml={class:"flex items-center justify-between mb-2"},Fl={class:"flex items-center gap-2"},Dl=["onClick"],Pl={key:0,class:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Il=["value","onChange"],El=["onClick"],Hl={class:"space-y-1.5 mb-2"},Vl={class:"grid grid-cols-[1fr_1fr_auto] gap-1 text-[10px] text-gray-500 px-1"},jl=["step","value","onInput"],Rl=["value","onInput"],Bl=["onClick"],zl={key:1,class:"w-5"},Al=["onClick"],Ll={class:"mt-2"},Ul={class:"text-[10px] text-gray-400 cursor-pointer hover:text-gray-300"},Wl={class:"mt-2 p-2 bg-gray-900/40 rounded-lg space-y-2"},Yl={class:"flex items-center gap-2 text-xs text-gray-300"},Gl=["checked","onChange"],Zl={key:0,class:"grid grid-cols-3 gap-2"},Kl=["value","onInput"],Xl=["value","onInput"],Jl=["value","onInput"],ql=Q({__name:"RightPanel",props:{selectedNode:{}},emits:["update","delete","deselect","dragStart","closePalette"],setup($,{emit:v}){const x=mt(),l=_e();Ge(()=>{x.dayNight||x.fetchDayNight()});const C=$,h=v,I=["M","T","W","T","F","S","S"],V=[{type:"logic",label:"IF Condition",description:"IF...THEN logic (AND/OR)",icon:Xe,bgColor:"bg-orange-600"},{type:"condition",label:"Sensor Value",description:"Temperature, humidity, CO2...",icon:Ye,bgColor:"bg-blue-600"},{type:"state",label:"Socket State",description:"Check if socket is ON/OFF",icon:Ke,bgColor:"bg-green-600"},{type:"schedule",label:"Schedule",description:"Time-based activation",icon:he,bgColor:"bg-purple-600"},{type:"action",label:"Action (THEN)",description:"Turn socket ON or OFF",icon:we,bgColor:"bg-yellow-600"},{type:"note",label:"Note",description:"Text annotation / label",icon:Je,bgColor:"bg-gray-600"},{type:"vpd_control",label:"VPD Control",description:"Intelligent VPD auto-calibration",icon:Ze,bgColor:"bg-teal-600"},{type:"blower_curve",label:"Blower Curve",description:"Proportional blower speed control",icon:qe,bgColor:"bg-cyan-600"}],{getSocketDisplayName:P}=Ae(),T=F(()=>C.selectedNode&&V.find(i=>i.type===C.selectedNode.type)||V[0]),n=F(()=>C.selectedNode?.data.config||{}),S=F(()=>l.ps5Devices),R=F(()=>S.value.length>1),Z=F(()=>n.value.deviceMac||S.value[0]?.mac||""),U=F(()=>[1,2,3,4,5].map(i=>({id:`O${i}`,label:P(`O${i}`,"short")}))),m=F(()=>l.lcDevices),w=F(()=>m.value.length>1),p=F(()=>{const i=n.value.sensor;return i&&i.includes("soil")});function D(i,t){const s=l.devices[i],c=i.slice(-4).toUpperCase();return s?.customName?`${s.customName} (${c})`:t==="ps5"?`Power Strip (${c})`:`Light Controller (${c})`}const E=[{id:"gray",label:"Gray",bg:"bg-gray-600"},{id:"blue",label:"Blue",bg:"bg-blue-600"},{id:"green",label:"Green",bg:"bg-green-600"},{id:"yellow",label:"Yellow",bg:"bg-yellow-600"},{id:"red",label:"Red",bg:"bg-red-600"},{id:"purple",label:"Purple",bg:"bg-purple-600"}];function B(i,t){i.dataTransfer&&(i.dataTransfer.setData("application/vueflow",t),i.dataTransfer.effectAllowed="move")}function se(i){if(window.innerWidth>=1024)return;const t=Le(),s=t.currentFlow?.flow.nodes||[];let c=100,u=100;s.length>0&&(u=Math.max(...s.map(de=>de.position.y))+140),t.addNode(i,{x:c,y:u}),h("closePalette")}function k(i,t){h("update",{[i]:t})}function Me(i){const t=(n.value.weekmask||127)^1<<i;k("weekmask",t)}const le=K(null),ne=F(()=>{if(C.selectedNode?.type!=="condition")return[];const i=n.value.timeSlots;return!i||!Array.isArray(i)||i.length===0?[{id:"default",period:"custom",startTime:"00:00",endTime:"00:00",weekmask:127,operator:n.value.operator||">",value:n.value.value||25,hysteresis:n.value.hysteresis||0}]:i}),Fe=F(()=>{const t=ne.value.map(s=>s.period).filter(s=>s&&s!=="custom");return!(t.includes("day")&&t.includes("night"))}),De={temp:"Â°C",humi:"%",co2:"ppm",vpd:"kPa",temp_soil:"Â°C",humi_soil:"%",ec_soil:"mS/cm"};function ke(i){return De[i||n.value.sensor]||""}function Pe(i){return{">":">","<":"<",">=":"â‰¥","<=":"â‰¤","==":"=","!=":"â‰ "}[i]||i}function Ie(i){const s=["M","T","W","T","F","S","S"].filter((c,u)=>i&1<<u);return s.length===7?"All":s.length===0?"None":s.join("")}function Ee(i,t,s,c){const u=ot=>{const[st,nt]=ot.split(":").map(Number);return st*60+nt},J=u(i),de=u(t),et=u(s),tt=u(c);return J<tt&&et<de}const $e=F(()=>{const i=ne.value;for(let t=0;t<i.length;t++)for(let s=t+1;s<i.length;s++){const c=i[t],u=i[s];if((c.weekmask&u.weekmask)!==0&&Ee(c.startTime,c.endTime,u.startTime,u.endTime))return`Overlap detected between slots ${t+1} and ${s+1}`}return null});function Ce(){const i={id:`slot-${Date.now()}`,period:"custom",startTime:"08:00",endTime:"20:00",weekmask:127,operator:">",value:25,hysteresis:2},t=[...ne.value,i];h("update",{timeSlots:t}),le.value=i.id}function He(i){const t=ne.value.filter(s=>s.id!==i);t.length!==0&&(h("update",{timeSlots:t}),le.value===i&&(le.value=null))}function ae(i,t,s){const c=ne.value.map(u=>u.id===i?{...u,[t]:s}:u);h("update",{timeSlots:c})}function y(i,t){const s=ne.value.find(u=>u.id===i);if(!s)return;const c=s.weekmask^1<<t;ae(i,"weekmask",c)}function d(i){const t=x.dayNight?.dayStart||"06:00",s=x.dayNight?.dayEnd||"00:00";return i==="day"?`${t} - ${s}`:i==="night"?`${s} - ${t}`:""}const b=[{key:"germination",label:"Germ"},{key:"seedling",label:"Seedling"},{key:"vegetative",label:"Veg"},{key:"flower",label:"Flower"},{key:"flush",label:"Flush"},{key:"drying",label:"Drying"},{key:"curing",label:"Curing"}];function O(i,t,s){const c={...n.value.phaseTargets};c[i]={...c[i],[t]:s},h("update",{phaseTargets:c})}function M(){const i=[...n.value.roles||[]],t=i.map(c=>c.socket),s=["O1","O2","O3","O4","O5"].find(c=>!t.includes(c))||"O1";i.push({socket:s,role:"extractor"}),h("update",{roles:i})}function z(i){const t=[...n.value.roles||[]];t.splice(i,1),h("update",{roles:t})}function X(i,t,s){const c=[...n.value.roles||[]];c[i]={...c[i],[t]:s},h("update",{roles:c})}function ie(){const i=[...n.value.curves||[]],t=i.map(u=>u.sensor),c=["temp","humi","co2","vpd"].find(u=>!t.includes(u))||"temp";i.push({id:`curve-${Date.now()}`,sensor:c,enabled:!0,points:[{value:c==="temp"?25:c==="humi"?70:c==="co2"?1200:1.2,speed:30},{value:c==="temp"?27:c==="humi"?80:c==="co2"?1500:1.4,speed:100}],escalation:{enabled:!1,intervalSeconds:30,expectedImprovement:.5,speedIncrement:10}}),h("update",{curves:i})}function ue(i){const t=[...n.value.curves||[]];t.splice(i,1),h("update",{curves:t})}function re(i){const t=[...n.value.curves||[]];t[i]={...t[i],enabled:!t[i].enabled},h("update",{curves:t})}function Ve(i,t){const s=[...n.value.curves||[]];s[i]={...s[i],sensor:t},h("update",{curves:s})}function A(i){const t=[...n.value.curves||[]],s=t[i],c=s.points[s.points.length-1],u=s.sensor==="temp"?1:s.sensor==="humi"?5:s.sensor==="co2"?100:.1;s.points.push({value:c.value+u,speed:Math.min(100,c.speed+20)}),h("update",{curves:t})}function Qe(i,t){const s=[...n.value.curves||[]];s[i].points.splice(t,1),h("update",{curves:s})}function Ue(i,t,s,c){const u=[...n.value.curves||[]];u[i].points[t]={...u[i].points[t],[s]:c},h("update",{curves:u})}function Ne(i,t,s){const c=[...n.value.curves||[]];c[i].escalation={...c[i].escalation,[t]:s},h("update",{curves:c})}return(i,t)=>(r(),a("div",Rs,[t[137]||(t[137]=e("div",{class:"absolute -top-6 -right-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-spider-green-500/10"},null,-1)),e("div",Bs,[e("h3",zs,g($.selectedNode?"Configure Node":"Add Nodes"),1),$.selectedNode?(r(),a("button",{key:0,onClick:t[0]||(t[0]=s=>h("delete")),class:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded-lg transition-all",title:"Delete node"},[_(o(Re),{class:"w-4 h-4"})])):(r(),a("button",{key:1,onClick:t[1]||(t[1]=s=>h("closePalette")),class:"lg:hidden p-1.5 text-gray-400 hover:text-white hover:bg-gray-700/60 rounded-lg transition-all",title:"Close"},[_(o(Se),{class:"w-4 h-4"})]))]),e("div",As,[$.selectedNode?(r(),a("div",Zs,[e("button",{onClick:t[2]||(t[2]=s=>h("deselect")),class:"flex items-center gap-1.5 text-xs text-gray-400 hover:text-white transition-all group"},[_(o(yt),{class:"w-4 h-4 group-hover:-translate-x-0.5 transition-transform"}),t[45]||(t[45]=L(" Back to nodes ",-1))]),e("div",Ks,[e("div",{class:f(["w-9 h-9 rounded-xl flex items-center justify-center shadow-lg",o(T).bgColor])},[(r(),ee(me(o(T).icon),{class:"w-4 h-4 text-white"}))],2),e("div",null,[e("div",Xs,g(o(T).label),1),e("div",Js,g($.selectedNode.id),1)])]),$.selectedNode.type==="condition"?(r(),a("div",qs,[e("div",null,[t[47]||(t[47]=e("label",{class:"block text-xs font-medium text-gray-400 mb-1.5"},"Sensor",-1)),e("select",{value:o(n).sensor,onChange:t[3]||(t[3]=s=>k("sensor",s.target.value)),class:"w-full bg-gray-900/60 border border-gray-600/50 rounded-xl px-3 py-2.5 text-sm focus:border-spider-green-500/50 focus:outline-none transition-colors"},[...t[46]||(t[46]=[xe('<option value="temp" data-v-4aa54c3a>ğŸŒ¡ï¸ Temperature</option><option value="humi" data-v-4aa54c3a>ğŸ’§ Humidity</option><option value="co2" data-v-4aa54c3a>ğŸŒ¬ï¸ CO2</option><option value="vpd" data-v-4aa54c3a>ğŸ“Š VPD</option><option value="temp_soil" data-v-4aa54c3a>ğŸŒ± Soil Temp</option><option value="humi_soil" data-v-4aa54c3a>ğŸ’¦ Soil Moisture</option><option value="ec_soil" data-v-4aa54c3a>âš¡ Soil EC (mS/cm)</option>',7)])],40,Qs)]),o(w)&&!o(p)?(r(),a("div",en,[t[48]||(t[48]=e("label",{class:"block text-xs font-medium text-gray-400 mb-1.5"},"Sensor Device",-1)),e("select",{value:o(n).deviceMac||o(m)[0]?.mac,onChange:t[4]||(t[4]=s=>k("deviceMac",s.target.value)),class:"w-full bg-gray-900/60 border border-gray-600/50 rounded-xl px-3 py-2.5 text-sm focus:border-blue-500/50 focus:outline-none transition-colors"},[(r(!0),a(H,null,j(o(m),s=>(r(),a("option",{key:s.mac,value:s.mac},g(D(s.mac,"lc")),9,on))),128))],40,tn),t[49]||(t[49]=e("p",{class:"text-[10px] text-gray-500 mt-1"},"Select which Light Controller's sensor to read",-1))])):N("",!0),e("div",sn,[e("div",nn,[t[51]||(t[51]=e("label",{class:"text-xs font-medium text-gray-400"},"Time Slots",-1)),o(Fe)?(r(),a("button",{key:0,onClick:Ce,class:"text-[10px] px-2.5 py-1.5 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-400 hover:to-purple-500 rounded-lg text-white font-semibold flex items-center gap-1 shadow-lg shadow-purple-500/25 transition-all"},[_(o(ze),{class:"w-3 h-3"}),t[50]||(t[50]=L(" Add ",-1))])):N("",!0)]),o($e)?(r(),a("div",rn,[e("p",ln,"âš ï¸ "+g(o($e)),1)])):N("",!0),e("div",an,[(r(!0),a(H,null,j(o(ne),(s,c)=>(r(),a("div",{key:s.id,class:f(["p-3 rounded-xl border transition-all",o(le)===s.id?"bg-gradient-to-br from-blue-900/40 to-blue-800/20 border-blue-500/50 shadow-lg shadow-blue-500/10":"bg-gradient-to-br from-gray-700/40 to-gray-800/40 border-gray-600/50 hover:border-gray-500/50"])},[e("div",dn,[e("button",{onClick:u=>le.value=o(le)===s.id?null:s.id,class:"flex items-center gap-2 text-left flex-1"},[_(o(he),{class:"w-4 h-4 text-purple-400"}),e("span",un,g(s.period==="day"?"Day":s.period==="night"?"Night":`${s.startTime} - ${s.endTime}`),1),e("span",gn," ("+g(Ie(s.weekmask))+") ",1)],8,cn),o(ne).length>1?(r(),a("button",{key:0,onClick:u=>He(s.id),class:"p-1 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded"},[_(o(Re),{class:"w-3 h-3"})],8,pn)):N("",!0)]),o(le)!==s.id?(r(),a("div",xn,[L(g(Pe(s.operator))+" "+g(s.value)+g(ke())+" ",1),s.hysteresis>0?(r(),a("span",mn,"(Â±"+g(s.hysteresis)+")",1)):N("",!0)])):(r(),a("div",yn,[e("div",null,[t[52]||(t[52]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Period",-1)),e("div",bn,[(r(),a(H,null,j(["day","night","custom"],u=>e("button",{key:u,onClick:J=>ae(s.id,"period",u),class:f(["flex-1 py-1 rounded text-[10px] font-medium transition-colors",(s.period||"custom")===u?"bg-purple-600 text-white":"bg-gray-600 text-gray-500 hover:bg-gray-500"])},g(u==="day"?"Day":u==="night"?"Night":"Custom"),11,vn)),64))]),s.period&&s.period!=="custom"?(r(),a("p",fn," Uses light cycle: "+g(d(s.period)),1)):N("",!0)]),!s.period||s.period==="custom"?(r(),a("div",hn,[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"From",-1)),e("input",{type:"time",value:s.startTime,onChange:u=>ae(s.id,"startTime",u.target.value),class:"w-full bg-gray-600 border border-gray-500 rounded px-2 py-1 text-xs"},null,40,wn)]),e("div",null,[t[54]||(t[54]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"To",-1)),e("input",{type:"time",value:s.endTime,onChange:u=>ae(s.id,"endTime",u.target.value),class:"w-full bg-gray-600 border border-gray-500 rounded px-2 py-1 text-xs"},null,40,_n)])])):N("",!0),e("div",null,[t[55]||(t[55]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Days",-1)),e("div",kn,[(r(),a(H,null,j(I,(u,J)=>e("button",{key:J,onClick:de=>y(s.id,J),class:f(["flex-1 py-1 rounded text-[10px] font-medium transition-all",s.weekmask&1<<J?"bg-purple-600 text-white":"bg-gray-600 text-gray-500 hover:bg-gray-500"])},g(u),11,$n)),64))])]),e("div",Cn,[e("div",null,[t[57]||(t[57]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Operator",-1)),e("select",{value:s.operator,onChange:u=>ae(s.id,"operator",u.target.value),class:"w-full bg-gray-600 border border-gray-500 rounded px-2 py-1 text-xs"},[...t[56]||(t[56]=[xe('<option value="&gt;" data-v-4aa54c3a>&gt;</option><option value="&lt;" data-v-4aa54c3a>&lt;</option><option value="&gt;=" data-v-4aa54c3a>&gt;=</option><option value="&lt;=" data-v-4aa54c3a>&lt;=</option><option value="==" data-v-4aa54c3a>=</option><option value="!=" data-v-4aa54c3a>â‰ </option>',6)])],40,Nn)]),e("div",null,[t[58]||(t[58]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Valor",-1)),e("input",{type:"number",value:s.value,onInput:u=>ae(s.id,"value",parseFloat(u.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded px-2 py-1 text-xs"},null,40,Sn)])]),e("div",null,[t[59]||(t[59]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Hysteresis",-1)),e("input",{type:"number",value:s.hysteresis,onInput:u=>ae(s.id,"hysteresis",parseFloat(u.target.value)),min:"0",step:"0.5",class:"w-full bg-gray-600 border border-gray-500 rounded px-2 py-1 text-xs"},null,40,Tn)])]))],2))),128))])])])):$.selectedNode.type==="action"?(r(),a("div",On,[o(R)?(r(),a("div",Mn,[t[60]||(t[60]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Device",-1)),e("select",{value:o(Z),onChange:t[5]||(t[5]=s=>k("deviceMac",s.target.value)),class:"w-full bg-gray-900/60 border border-gray-600/50 rounded-xl px-3 py-2.5 text-sm focus:border-spider-green-500/50 focus:outline-none transition-colors"},[(r(!0),a(H,null,j(o(S),s=>(r(),a("option",{key:s.mac,value:s.mac},g(D(s.mac,"ps5")),9,Dn))),128))],40,Fn)])):N("",!0),e("div",null,[t[61]||(t[61]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Socket",-1)),e("div",Pn,[(r(!0),a(H,null,j(o(U),s=>(r(),a("button",{key:s.id,onClick:c=>k("socket",s.id),class:f(["py-2 px-3 rounded-lg text-sm font-medium transition-all text-left",o(n).socket===s.id?"bg-spider-green-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},g(s.label),11,In))),128))])]),e("div",null,[t[64]||(t[64]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Action",-1)),e("div",En,[e("button",{onClick:t[6]||(t[6]=s=>k("action","on")),class:f(["py-3 rounded-lg text-sm font-semibold transition-all flex items-center justify-center gap-2",o(n).action==="on"?"bg-spider-green-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},[_(o(we),{class:"w-4 h-4"}),t[62]||(t[62]=L(" ON ",-1))],2),e("button",{onClick:t[7]||(t[7]=s=>k("action","off")),class:f(["py-3 rounded-lg text-sm font-semibold transition-all flex items-center justify-center gap-2",o(n).action==="off"?"bg-gray-500 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},[_(o(Se),{class:"w-4 h-4"}),t[63]||(t[63]=L(" OFF ",-1))],2)])]),e("div",Hn,[t[67]||(t[67]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Priority Control",-1)),e("label",Vn,[e("input",{type:"checkbox",checked:o(n).mandatoryOn,onChange:t[8]||(t[8]=s=>k("mandatoryOn",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-green-600 focus:ring-green-500"},null,40,jn),t[65]||(t[65]=e("div",null,[e("div",{class:"text-sm font-medium text-green-400"},"Mandatory ON"),e("div",{class:"text-[10px] text-gray-400"},"Keeps ON while condition is met")],-1))]),e("label",Rn,[e("input",{type:"checkbox",checked:o(n).mandatoryOff,onChange:t[9]||(t[9]=s=>k("mandatoryOff",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-red-600 focus:ring-red-500"},null,40,Bn),t[66]||(t[66]=e("div",null,[e("div",{class:"text-sm font-medium text-red-400"},"Mandatory OFF"),e("div",{class:"text-[10px] text-gray-400"},"Forces OFF, overrides Mandatory ON")],-1))]),t[68]||(t[68]=e("p",{class:"text-[10px] text-gray-500 mt-2 leading-relaxed"},[e("strong",null,"Priority:"),L(" Mandatory OFF > Mandatory ON > No mandatory ")],-1))])])):$.selectedNode.type==="schedule"?(r(),a("div",zn,[e("div",null,[t[69]||(t[69]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Schedule Type",-1)),e("div",An,[e("button",{onClick:t[10]||(t[10]=s=>k("scheduleType","time_range")),class:f(["py-2 rounded-lg text-xs font-medium transition-all",o(n).scheduleType==="time_range"?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Time Range",2),e("button",{onClick:t[11]||(t[11]=s=>k("scheduleType","interval")),class:f(["py-2 rounded-lg text-xs font-medium transition-all",o(n).scheduleType==="interval"?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Interval",2)])]),o(n).scheduleType==="time_range"?(r(),a("div",Ln,[e("div",null,[t[70]||(t[70]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Period",-1)),e("div",Un,[(r(),a(H,null,j(["day","night","custom"],s=>e("button",{key:s,onClick:c=>k("period",s),class:f(["flex-1 py-1.5 rounded-lg text-xs font-medium transition-colors",(o(n).period||"custom")===s?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},g(s==="day"?"Day":s==="night"?"Night":"Custom"),11,Wn)),64))]),o(n).period&&o(n).period!=="custom"?(r(),a("p",Yn," Uses light cycle: "+g(d(o(n).period)),1)):N("",!0)]),!o(n).period||o(n).period==="custom"?(r(),a("div",Gn,[e("div",null,[t[71]||(t[71]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Start Time",-1)),e("input",{type:"time",value:o(n).startTime,onChange:t[12]||(t[12]=s=>k("startTime",s.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"},null,40,Zn)]),e("div",null,[t[72]||(t[72]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"End Time",-1)),e("input",{type:"time",value:o(n).endTime,onChange:t[13]||(t[13]=s=>k("endTime",s.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"},null,40,Kn)])])):N("",!0)])):(r(),a("div",Xn,[e("div",Jn,[t[75]||(t[75]=e("div",{class:"text-xs text-gray-400 font-medium"},"Interval Settings",-1)),e("div",qn,[e("div",null,[t[73]||(t[73]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Every (min)",-1)),e("input",{type:"number",value:o(n).intervalMinutes,onInput:t[14]||(t[14]=s=>k("intervalMinutes",parseInt(s.target.value))),min:"1",class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,Qn)]),e("div",null,[t[74]||(t[74]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Duration (sec)",-1)),e("input",{type:"number",value:o(n).durationSeconds,onInput:t[15]||(t[15]=s=>k("durationSeconds",parseInt(s.target.value))),min:"1",class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,er)])])]),e("div",tr,[t[78]||(t[78]=e("div",{class:"text-xs text-gray-400 font-medium"},"Active Window",-1)),e("div",null,[e("div",or,[(r(),a(H,null,j(["day","night","custom"],s=>e("button",{key:s,onClick:c=>k("activePeriod",s),class:f(["flex-1 py-1 rounded text-[10px] font-medium transition-colors",(o(n).activePeriod||"custom")===s?"bg-purple-600 text-white":"bg-gray-600 text-gray-500 hover:bg-gray-500"])},g(s==="day"?"Day":s==="night"?"Night":"Custom"),11,sr)),64))]),o(n).activePeriod&&o(n).activePeriod!=="custom"?(r(),a("p",nr," Uses light cycle: "+g(d(o(n).activePeriod)),1)):N("",!0)]),!o(n).activePeriod||o(n).activePeriod==="custom"?(r(),a("div",rr,[e("div",null,[t[76]||(t[76]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"From",-1)),e("input",{type:"time",value:o(n).activeStartTime||"00:00",onChange:t[16]||(t[16]=s=>k("activeStartTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,lr)]),e("div",null,[t[77]||(t[77]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"Until",-1)),e("input",{type:"time",value:o(n).activeEndTime||"00:00",onChange:t[17]||(t[17]=s=>k("activeEndTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,ar)])])):N("",!0),t[79]||(t[79]=e("p",{class:"text-[10px] text-gray-500"},"Interval only runs within this period",-1))])])),e("div",null,[t[80]||(t[80]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Days of Week",-1)),e("div",ir,[(r(),a(H,null,j(I,(s,c)=>e("button",{key:c,onClick:u=>Me(c),class:f(["flex-1 py-2 rounded-lg text-xs font-medium transition-all",o(n).weekmask&1<<c?"bg-purple-600 text-white":"bg-gray-700 text-gray-500 hover:bg-gray-600"])},g(s),11,dr)),64))])]),e("div",cr,[t[83]||(t[83]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Priority Control",-1)),e("label",ur,[e("input",{type:"checkbox",checked:o(n).mandatoryOn,onChange:t[18]||(t[18]=s=>k("mandatoryOn",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-green-600 focus:ring-green-500"},null,40,gr),t[81]||(t[81]=e("div",null,[e("div",{class:"text-sm font-medium text-green-400"},"Mandatory ON"),e("div",{class:"text-[10px] text-gray-400"},"Keeps ON while schedule is active")],-1))]),e("label",pr,[e("input",{type:"checkbox",checked:o(n).mandatoryOff,onChange:t[19]||(t[19]=s=>k("mandatoryOff",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-red-600 focus:ring-red-500"},null,40,xr),t[82]||(t[82]=e("div",null,[e("div",{class:"text-sm font-medium text-red-400"},"Mandatory OFF"),e("div",{class:"text-[10px] text-gray-400"},"Forces OFF, overrides Mandatory ON")],-1))]),t[84]||(t[84]=e("p",{class:"text-[10px] text-gray-500 mt-2 leading-relaxed"},[e("strong",null,"Priority:"),L(" Mandatory OFF > Mandatory ON > No mandatory ")],-1))])])):$.selectedNode.type==="state"?(r(),a("div",mr,[o(R)?(r(),a("div",yr,[t[85]||(t[85]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Device",-1)),e("select",{value:o(Z),onChange:t[20]||(t[20]=s=>k("deviceMac",s.target.value)),class:"w-full bg-gray-900/60 border border-gray-600/50 rounded-xl px-3 py-2.5 text-sm focus:border-green-500/50 focus:outline-none transition-colors"},[(r(!0),a(H,null,j(o(S),s=>(r(),a("option",{key:s.mac,value:s.mac},g(D(s.mac,"ps5")),9,vr))),128))],40,br)])):N("",!0),e("div",null,[t[86]||(t[86]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Check Socket",-1)),e("div",fr,[(r(!0),a(H,null,j(o(U),s=>(r(),a("button",{key:s.id,onClick:c=>k("socket",s.id),class:f(["py-2 px-3 rounded-lg text-sm font-medium transition-all text-left",o(n).socket===s.id?"bg-green-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},g(s.label),11,hr))),128))])]),e("div",null,[t[87]||(t[87]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Expected State",-1)),e("div",wr,[e("button",{onClick:t[21]||(t[21]=s=>k("checkState","on")),class:f(["py-3 rounded-lg text-sm font-semibold transition-all",o(n).checkState==="on"?"bg-spider-green-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Is ON",2),e("button",{onClick:t[22]||(t[22]=s=>k("checkState","off")),class:f(["py-3 rounded-lg text-sm font-semibold transition-all",o(n).checkState==="off"?"bg-gray-500 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Is OFF",2)])]),e("div",_r,[e("label",kr,[e("input",{type:"checkbox",checked:o(n).timeRestricted,onChange:t[23]||(t[23]=s=>k("timeRestricted",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-purple-600 focus:ring-purple-500"},null,40,$r),t[88]||(t[88]=e("div",null,[e("div",{class:"text-sm font-medium text-purple-400"},"Restrict to time range"),e("div",{class:"text-[10px] text-gray-400"},"Only active during specified period")],-1))]),o(n).timeRestricted?(r(),a(H,{key:0},[e("div",null,[t[89]||(t[89]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Period",-1)),e("div",Cr,[(r(),a(H,null,j(["day","night","custom"],s=>e("button",{key:s,onClick:c=>k("period",s),class:f(["flex-1 py-1.5 rounded-lg text-xs font-medium transition-colors",(o(n).period||"custom")===s?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},g(s==="day"?"Day":s==="night"?"Night":"Custom"),11,Nr)),64))]),o(n).period&&o(n).period!=="custom"?(r(),a("p",Sr," Uses light cycle: "+g(d(o(n).period)),1)):N("",!0)]),!o(n).period||o(n).period==="custom"?(r(),a("div",Tr,[e("div",null,[t[90]||(t[90]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"From",-1)),e("input",{type:"time",value:o(n).startTime,onChange:t[24]||(t[24]=s=>k("startTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,Or)]),e("div",null,[t[91]||(t[91]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"To",-1)),e("input",{type:"time",value:o(n).endTime,onChange:t[25]||(t[25]=s=>k("endTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,Mr)])])):N("",!0)],64)):N("",!0)])])):$.selectedNode.type==="logic"?(r(),a("div",Fr,[e("div",null,[t[92]||(t[92]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Name (optional)",-1)),e("input",{type:"text",value:o(n).name,onInput:t[26]||(t[26]=s=>k("name",s.target.value)),placeholder:"e.g., Day Mode, Night Mode...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500"},null,40,Dr)]),e("div",null,[t[95]||(t[95]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Condition Mode",-1)),e("div",Pr,[e("button",{onClick:t[27]||(t[27]=s=>k("operator","and")),class:f(["py-4 rounded-lg text-sm font-bold transition-all flex flex-col items-center gap-1",o(n).operator==="and"?"bg-orange-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},[...t[93]||(t[93]=[e("span",{class:"text-lg"},"AND",-1),e("span",{class:"text-[10px] font-normal opacity-70"},"All inputs TRUE",-1)])],2),e("button",{onClick:t[28]||(t[28]=s=>k("operator","or")),class:f(["py-4 rounded-lg text-sm font-bold transition-all flex flex-col items-center gap-1",o(n).operator==="or"?"bg-orange-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},[...t[94]||(t[94]=[e("span",{class:"text-lg"},"OR",-1),e("span",{class:"text-[10px] font-normal opacity-70"},"Any input TRUE",-1)])],2)])]),e("div",Ir,[e("label",Er,[e("input",{type:"checkbox",checked:o(n).timeRestricted,onChange:t[29]||(t[29]=s=>k("timeRestricted",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-purple-600 focus:ring-purple-500"},null,40,Hr),t[96]||(t[96]=e("div",null,[e("div",{class:"text-sm font-medium text-purple-400"},"Restrict to time range"),e("div",{class:"text-[10px] text-gray-400"},"Only active during specified hours")],-1))]),o(n).timeRestricted?(r(),a("div",Vr,[e("div",null,[t[97]||(t[97]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Period",-1)),e("div",jr,[(r(),a(H,null,j(["day","night","custom"],s=>e("button",{key:s,onClick:c=>k("period",s),class:f(["flex-1 py-1.5 rounded-lg text-xs font-medium transition-colors",(o(n).period||"custom")===s?"bg-purple-600 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},g(s==="day"?"Day":s==="night"?"Night":"Custom"),11,Rr)),64))]),o(n).period&&o(n).period!=="custom"?(r(),a("p",Br," Uses light cycle: "+g(d(o(n).period)),1)):N("",!0)]),!o(n).period||o(n).period==="custom"?(r(),a("div",zr,[e("div",null,[t[98]||(t[98]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"From",-1)),e("input",{type:"time",value:o(n).startTime,onChange:t[30]||(t[30]=s=>k("startTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,Ar)]),e("div",null,[t[99]||(t[99]=e("label",{class:"block text-[10px] text-gray-500 mb-1"},"To",-1)),e("input",{type:"time",value:o(n).endTime,onChange:t[31]||(t[31]=s=>k("endTime",s.target.value)),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-2 py-1.5 text-sm"},null,40,Lr)])])):N("",!0)])):N("",!0)]),e("div",Ur,[t[102]||(t[102]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Priority Control",-1)),e("label",Wr,[e("input",{type:"checkbox",checked:o(n).mandatoryOn,onChange:t[32]||(t[32]=s=>k("mandatoryOn",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-green-600 focus:ring-green-500"},null,40,Yr),t[100]||(t[100]=e("div",null,[e("div",{class:"text-sm font-medium text-green-400"},"Mandatory ON"),e("div",{class:"text-[10px] text-gray-400"},"Keeps ON while condition is true")],-1))]),e("label",Gr,[e("input",{type:"checkbox",checked:o(n).mandatoryOff,onChange:t[33]||(t[33]=s=>k("mandatoryOff",s.target.checked)),class:"w-4 h-4 rounded bg-gray-600 border-gray-500 text-red-600 focus:ring-red-500"},null,40,Zr),t[101]||(t[101]=e("div",null,[e("div",{class:"text-sm font-medium text-red-400"},"Mandatory OFF"),e("div",{class:"text-[10px] text-gray-400"},"Forces OFF, overrides Mandatory ON")],-1))]),t[103]||(t[103]=e("p",{class:"text-[10px] text-gray-500 mt-2 leading-relaxed"},[e("strong",null,"Priority:"),L(" Mandatory OFF > Mandatory ON > No mandatory ")],-1))]),t[104]||(t[104]=xe('<div class="p-3 bg-gray-700/50 rounded-lg space-y-2" data-v-4aa54c3a><p class="text-[11px] text-gray-400 leading-relaxed" data-v-4aa54c3a><strong class="text-gray-300" data-v-4aa54c3a>Inputs (left):</strong> Sensors, states or schedules </p><p class="text-[11px] text-gray-400 leading-relaxed" data-v-4aa54c3a><strong class="text-gray-300" data-v-4aa54c3a>Output (right):</strong> Connect to Action or another IF </p></div>',1))])):$.selectedNode.type==="note"?(r(),a("div",Kr,[e("div",null,[t[105]||(t[105]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Note Text",-1)),e("textarea",{value:o(n).text,onInput:t[34]||(t[34]=s=>k("text",s.target.value)),rows:"4",placeholder:"Enter your note...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm resize-none focus:border-gray-500 focus:ring-1 focus:ring-gray-500"},null,40,Xr)]),e("div",null,[t[106]||(t[106]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Color",-1)),e("div",Jr,[(r(),a(H,null,j(E,s=>e("button",{key:s.id,onClick:c=>k("color",s.id),class:f(["w-8 h-8 rounded-lg transition-all",s.bg,o(n).color===s.id?"ring-2 ring-white":""]),title:s.label},null,10,qr)),64))])])])):$.selectedNode.type==="vpd_control"?(r(),a("div",Qr,[e("div",null,[t[107]||(t[107]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Mode",-1)),e("div",el,[e("button",{onClick:t[35]||(t[35]=s=>k("mode","manual")),class:f(["py-2 rounded-lg text-xs font-medium transition-all",o(n).mode==="manual"?"bg-teal-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Manual",2),e("button",{onClick:t[36]||(t[36]=s=>k("mode","plant_stage")),class:f(["py-2 rounded-lg text-xs font-medium transition-all",o(n).mode==="plant_stage"||o(n).mode==="grow_phase"?"bg-teal-600 text-white shadow-lg":"bg-gray-700 text-gray-400 hover:bg-gray-600"])},"Plant Stage",2)])]),o(n).mode==="manual"?(r(),a("div",tl,[t[110]||(t[110]=e("label",{class:"block text-xs text-gray-400"},"Target Range (kPa)",-1)),e("div",ol,[e("div",null,[t[108]||(t[108]=e("label",{class:"block text-[10px] text-gray-500 mb-0.5"},"Min",-1)),e("input",{type:"number",step:"0.05",value:o(n).manualTarget?.min,onInput:t[37]||(t[37]=s=>k("manualTarget",{...o(n).manualTarget,min:parseFloat(s.target.value)})),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-2 py-1.5 text-sm"},null,40,sl)]),e("div",null,[t[109]||(t[109]=e("label",{class:"block text-[10px] text-gray-500 mb-0.5"},"Max",-1)),e("input",{type:"number",step:"0.05",value:o(n).manualTarget?.max,onInput:t[38]||(t[38]=s=>k("manualTarget",{...o(n).manualTarget,max:parseFloat(s.target.value)})),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-2 py-1.5 text-sm"},null,40,nl)])])])):N("",!0),o(n).mode==="plant_stage"||o(n).mode==="grow_phase"?(r(),a("div",rl,[t[112]||(t[112]=e("label",{class:"block text-xs text-gray-400 mb-1"},"Phase Targets (kPa)",-1)),e("div",ll,[(r(),a(H,null,j(b,s=>e("div",{key:s.key,class:"flex items-center gap-2"},[e("span",al,g(s.label),1),o(n).phaseTargets?.[s.key]?.min>=0?(r(),a(H,{key:0},[e("input",{type:"number",step:"0.05",value:o(n).phaseTargets?.[s.key]?.min,onInput:c=>O(s.key,"min",parseFloat(c.target.value)),class:"w-14 bg-gray-700 border border-gray-600 rounded px-1.5 py-1 text-[10px]"},null,40,il),t[111]||(t[111]=e("span",{class:"text-[10px] text-gray-600"},"-",-1)),e("input",{type:"number",step:"0.05",value:o(n).phaseTargets?.[s.key]?.max,onInput:c=>O(s.key,"max",parseFloat(c.target.value)),class:"w-14 bg-gray-700 border border-gray-600 rounded px-1.5 py-1 text-[10px]"},null,40,dl)],64)):(r(),a("span",cl,"Disabled"))])),64))])])):N("",!0),o(w)?(r(),a("div",ul,[t[113]||(t[113]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"VPD Sensor Device",-1)),e("select",{value:o(n).sensorDeviceMac||o(m)[0]?.mac,onChange:t[39]||(t[39]=s=>k("sensorDeviceMac",s.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"},[(r(!0),a(H,null,j(o(m),s=>(r(),a("option",{key:s.mac,value:s.mac},g(D(s.mac,"lc")),9,pl))),128))],40,gl),t[114]||(t[114]=e("p",{class:"text-[10px] text-gray-500 mt-1"},"Which sensor to read VPD from",-1))])):N("",!0),e("div",null,[t[117]||(t[117]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Device Roles",-1)),e("div",xl,[(r(!0),a(H,null,j(o(n).roles||[],(s,c)=>(r(),a("div",{key:c,class:"flex items-center gap-1.5"},[o(R)?(r(),a("select",{key:0,value:s.deviceMac||o(S)[0]?.mac,onChange:u=>X(Number(c),"deviceMac",u.target.value),class:"w-20 bg-gray-700 border border-gray-600 rounded-lg px-1 py-1.5 text-[10px]"},[(r(!0),a(H,null,j(o(S),u=>(r(),a("option",{key:u.mac,value:u.mac},g(u.customName||u.mac.slice(-4)),9,yl))),128))],40,ml)):N("",!0),e("select",{value:s.socket,onChange:u=>X(Number(c),"socket",u.target.value),class:"w-14 bg-gray-700 border border-gray-600 rounded-lg px-1 py-1.5 text-[10px]"},[(r(!0),a(H,null,j(o(U),u=>(r(),a("option",{key:u.id,value:u.id},g(u.label),9,vl))),128))],40,bl),e("select",{value:s.role,onChange:u=>X(Number(c),"role",u.target.value),class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-1 py-1.5 text-[10px]"},[...t[115]||(t[115]=[xe('<option value="extractor" data-v-4aa54c3a>Extractor</option><option value="heater" data-v-4aa54c3a>Heater</option><option value="humidifier" data-v-4aa54c3a>Humidifier</option><option value="cooler" data-v-4aa54c3a>Cooler/AC</option><option value="circulator" data-v-4aa54c3a>Circulator</option>',5)])],40,fl),e("button",{onClick:u=>z(Number(c)),class:"p-1 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded"},[_(o(Re),{class:"w-3 h-3"})],8,hl)]))),128))]),(o(n).roles||[]).length<10?(r(),a("button",{key:0,onClick:M,class:"mt-2 text-[10px] text-teal-400 hover:text-teal-300 flex items-center gap-1"},[_(o(ze),{class:"w-3 h-3"}),t[116]||(t[116]=L(" Add device ",-1))])):N("",!0)]),e("div",null,[t[119]||(t[119]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Escalation Timeout",-1)),e("div",wl,[e("input",{type:"number",value:o(n).escalationTimeoutSeconds,onInput:t[40]||(t[40]=s=>k("escalationTimeoutSeconds",parseInt(s.target.value)||180)),min:"30",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"},null,40,_l),t[118]||(t[118]=e("span",{class:"text-[10px] text-gray-500 shrink-0"},"sec",-1))]),t[120]||(t[120]=e("p",{class:"text-[10px] text-gray-500 mt-1"},"Time before escalating to next device if VPD hasn't improved",-1))]),e("div",null,[t[122]||(t[122]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Hysteresis",-1)),e("div",kl,[e("input",{type:"number",min:"20",max:"90",value:o(n).hysteresisPercent,onInput:t[41]||(t[41]=s=>k("hysteresisPercent",parseInt(s.target.value)||60)),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm"},null,40,$l),t[121]||(t[121]=e("span",{class:"text-[10px] text-gray-500 shrink-0"},"%",-1))]),t[123]||(t[123]=e("p",{class:"text-[10px] text-gray-500 mt-1"},"Devices deactivate only when VPD reaches this inner zone of the target range",-1))]),t[124]||(t[124]=xe('<div class="p-3 bg-gradient-to-br from-teal-900/30 to-teal-800/20 border border-teal-600/40 rounded-xl" data-v-4aa54c3a><p class="text-[10px] text-teal-300 leading-relaxed" data-v-4aa54c3a><strong class="text-teal-200" data-v-4aa54c3a>Escalation:</strong> If primary device can&#39;t reach target VPD after the timeout, secondary devices activate automatically. </p><p class="text-[10px] text-teal-300 leading-relaxed mt-1" data-v-4aa54c3a><strong class="text-teal-200" data-v-4aa54c3a>Priority:</strong> mandatoryOff &gt; VPD auto &gt; normal flows. </p></div>',1))])):$.selectedNode.type==="blower_curve"?(r(),a("div",Cl,[e("div",null,[t[125]||(t[125]=e("label",{class:"block text-xs text-gray-400 mb-1.5"},"Standby Speed",-1)),e("div",Nl,[e("input",{type:"range",min:"0",max:"50",step:"5",value:o(n).standbySpeed,onInput:t[42]||(t[42]=s=>k("standbySpeed",parseInt(s.target.value))),class:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-cyan-500"},null,40,Sl),e("span",Tl,g(o(n).standbySpeed===0?"Off":o(n).standbySpeed+"%"),1)]),t[126]||(t[126]=e("p",{class:"text-[10px] text-gray-500 mt-1"},"Minimum speed when no curve is active (0 = off)",-1))]),e("div",null,[e("div",{class:"flex items-center justify-between mb-2"},[t[127]||(t[127]=e("label",{class:"text-xs text-gray-400"},"Sensor Curves",-1)),e("button",{onClick:ie,class:"text-[10px] px-2 py-1 bg-cyan-600 hover:bg-cyan-500 text-white rounded-lg transition-all"},"+ Add Curve")]),e("div",Ol,[(r(!0),a(H,null,j(o(n).curves||[],(s,c)=>(r(),a("div",{key:s.id,class:"p-3 rounded-xl bg-gray-800/60 border border-gray-700/50"},[e("div",Ml,[e("div",Fl,[e("button",{onClick:u=>re(Number(c)),class:f(["w-5 h-5 rounded flex items-center justify-center transition-all",s.enabled?"bg-cyan-600":"bg-gray-600"])},[s.enabled?(r(),a("svg",Pl,[...t[128]||(t[128]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):N("",!0)],10,Dl),e("select",{value:s.sensor,onChange:u=>Ve(Number(c),u.target.value),class:"bg-gray-700 border border-gray-600 rounded-lg px-2 py-1 text-xs"},[...t[129]||(t[129]=[e("option",{value:"temp"},"Temperature",-1),e("option",{value:"humi"},"Humidity",-1),e("option",{value:"co2"},"CO2",-1),e("option",{value:"vpd"},"VPD",-1)])],40,Il)]),e("button",{onClick:u=>ue(Number(c)),class:"text-gray-500 hover:text-red-400 transition-all"},[_(o(Se),{class:"w-4 h-4"})],8,El)]),e("div",Hl,[e("div",Vl,[e("span",null,g(ke(s.sensor)),1),t[130]||(t[130]=e("span",null,"Speed %",-1)),t[131]||(t[131]=e("span",{class:"w-5"},null,-1))]),(r(!0),a(H,null,j(s.points,(u,J)=>(r(),a("div",{key:J,class:"grid grid-cols-[1fr_1fr_auto] gap-1"},[e("input",{type:"number",step:s.sensor==="vpd"?.05:s.sensor==="co2"?50:.5,value:u.value,onInput:de=>Ue(Number(c),Number(J),"value",parseFloat(de.target.value)),class:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-xs text-center"},null,40,jl),e("input",{type:"number",min:"25",max:"100",step:"5",value:u.speed,onInput:de=>Ue(Number(c),Number(J),"speed",parseInt(de.target.value)),class:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-xs text-center"},null,40,Rl),s.points.length>2?(r(),a("button",{key:0,onClick:de=>Qe(Number(c),Number(J)),class:"text-gray-500 hover:text-red-400 w-5 flex items-center justify-center"},[_(o(Se),{class:"w-3 h-3"})],8,Bl)):(r(),a("span",zl))]))),128)),e("button",{onClick:u=>A(Number(c)),class:"w-full py-1 text-[10px] text-cyan-400 hover:text-cyan-300 border border-dashed border-gray-600 rounded transition-all"},"+ Add Point",8,Al)]),e("details",Ll,[e("summary",Ul," Escalation "+g(s.escalation?.enabled?"(enabled)":""),1),e("div",Wl,[e("label",Yl,[e("input",{type:"checkbox",checked:s.escalation?.enabled,onChange:u=>Ne(Number(c),"enabled",u.target.checked),class:"rounded bg-gray-700 border-gray-600"},null,40,Gl),t[132]||(t[132]=L(" Enable escalation ",-1))]),s.escalation?.enabled?(r(),a("div",Zl,[e("div",null,[t[133]||(t[133]=e("label",{class:"text-[9px] text-gray-500"},"Check (s)",-1)),e("input",{type:"number",min:"10",max:"120",value:s.escalation.intervalSeconds,onInput:u=>Ne(Number(c),"intervalSeconds",parseInt(u.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-xs"},null,40,Kl)]),e("div",null,[t[134]||(t[134]=e("label",{class:"text-[9px] text-gray-500"},"Expect",-1)),e("input",{type:"number",step:"0.1",value:s.escalation.expectedImprovement,onInput:u=>Ne(Number(c),"expectedImprovement",parseFloat(u.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-xs"},null,40,Xl)]),e("div",null,[t[135]||(t[135]=e("label",{class:"text-[9px] text-gray-500"},"+Speed%",-1)),e("input",{type:"number",min:"5",max:"25",value:s.escalation.speedIncrement,onInput:u=>Ne(Number(c),"speedIncrement",parseInt(u.target.value)),class:"w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-xs"},null,40,Jl)])])):N("",!0)])])]))),128))])]),t[136]||(t[136]=xe('<div class="p-3 bg-gradient-to-br from-cyan-900/30 to-cyan-800/20 border border-cyan-600/40 rounded-xl" data-v-4aa54c3a><p class="text-[10px] text-cyan-300 leading-relaxed" data-v-4aa54c3a><strong class="text-cyan-200" data-v-4aa54c3a>Highest Wins:</strong> When multiple curves are active, the one demanding the highest speed is applied. </p><p class="text-[10px] text-cyan-300 leading-relaxed mt-1" data-v-4aa54c3a><strong class="text-cyan-200" data-v-4aa54c3a>Interpolation:</strong> Speed is smoothly interpolated between defined points. </p></div>',1))])):N("",!0)])):(r(),a("div",Ls,[t[43]||(t[43]=e("p",{class:"text-xs text-gray-500 mb-4"},"Drag nodes onto the canvas to build your automation flow.",-1)),(r(),a(H,null,j(V,s=>e("div",{key:s.type,draggable:"true",onDragstart:c=>B(c,s.type),onClick:c=>se(s.type),class:"p-3 bg-gradient-to-br from-gray-700/60 to-gray-800/60 hover:from-gray-600/60 hover:to-gray-700/60 rounded-xl transition-all cursor-grab active:cursor-grabbing flex items-center gap-3 border border-gray-600/50 hover:border-gray-500/50 hover:shadow-lg hover:shadow-black/20 hover:scale-[1.02] lg:cursor-grab backdrop-blur-sm"},[e("div",{class:f(["w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",s.bgColor])},[(r(),ee(me(s.icon),{class:"w-6 h-6 text-white"}))],2),e("div",Ws,[e("div",Ys,g(s.label),1),e("div",Gs,g(s.description),1)])],40,Us)),64)),t[44]||(t[44]=xe('<div class="mt-6 pt-4 border-t border-gray-700/50" data-v-4aa54c3a><h4 class="text-xs font-semibold text-gray-400 mb-2" data-v-4aa54c3a>Quick Tips</h4><ul class="text-[11px] text-gray-500 space-y-1.5" data-v-4aa54c3a><li class="flex items-start gap-2" data-v-4aa54c3a><span class="text-spider-green-400" data-v-4aa54c3a>â€¢</span> Drag nodes to the canvas </li><li class="flex items-start gap-2" data-v-4aa54c3a><span class="text-spider-green-400" data-v-4aa54c3a>â€¢</span> Connect by dragging between handles </li><li class="flex items-start gap-2" data-v-4aa54c3a><span class="text-spider-green-400" data-v-4aa54c3a>â€¢</span> Click a node to configure it </li><li class="flex items-start gap-2" data-v-4aa54c3a><span class="text-spider-green-400" data-v-4aa54c3a>â€¢</span> Click a connection to delete it </li><li class="flex items-start gap-2" data-v-4aa54c3a><span class="text-spider-green-400" data-v-4aa54c3a>â€¢</span> Press Delete to remove node </li></ul></div>',1))]))])]))}}),Ql=Object.assign(be(ql,[["__scopeId","data-v-4aa54c3a"]]),{__name:"TriggersRightPanel"}),ea={class:"flex-1 min-h-0 flex flex-col overflow-hidden"},ta={class:"flex-1 flex overflow-hidden min-h-0 relative"},oa={class:"absolute top-3 left-3 z-20 flex items-center gap-3 px-3 py-2 bg-gradient-to-r from-gray-800/95 to-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700/50 shadow-lg"},sa={class:"w-7 h-7 rounded-lg bg-gradient-to-br from-yellow-500/30 to-amber-600/20 flex items-center justify-center"},na={class:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-gray-800/95 to-gray-900/95 backdrop-blur-md border-b border-gray-700/50 w-64 sm:w-72 shrink-0"},ra=["disabled"],la={key:0,class:"absolute -top-6 -left-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-purple-500/15"},aa={class:"text-xs font-semibold text-gray-300 flex items-center gap-2"},ia={class:"w-5 h-5 rounded-lg bg-gradient-to-br from-purple-500/30 to-violet-600/20 flex items-center justify-center"},da={class:"flex-1 overflow-y-auto overflow-x-auto relative"},ca={class:"w-full text-[11px] sm:text-xs min-w-[320px]"},ua={class:"px-2 sm:px-4 py-2 text-gray-500 whitespace-nowrap font-medium"},ga={class:"px-2 sm:px-4 py-2 font-semibold text-gray-300"},pa={class:"px-2 sm:px-4 py-2"},xa={class:"px-2 sm:px-4 py-2 hidden sm:table-cell"},ma={class:"px-2 sm:px-4 py-2 text-gray-500 truncate max-w-[200px] hidden md:table-cell"},ya={key:0},ba=Q({__name:"triggers",setup($){const v=Le(),x=_e(),{requireAuth:l}=ct(),C=K("24h"),h=K(!1),I=K(!1),V=K(!1);Ge(async()=>{await x.fetchDevices(),await v.loadGlobalConfiguration(),h.value=v.currentFlow?.enabled||!1,await U()});function P(w){v.selectNode(w),w&&(V.value=!1)}function T(w){v.selectedNodeId&&v.updateNodeConfig(v.selectedNodeId,w)}function n(){v.selectedNodeId&&v.deleteNode(v.selectedNodeId)}function S(){v.selectNode(null)}async function R(){try{await l()}catch{return}v.currentFlow&&(v.currentFlow.enabled=h.value),await v.saveCurrentFlow()}async function Z(){try{await l()}catch{return}h.value=!h.value,v.currentFlow&&(v.currentFlow.enabled=h.value,await v.saveCurrentFlow())}async function U(){await v.fetchExecutionLogs({range:C.value})}function m(w){return new Date(w).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}return(w,p)=>{const D=js,E=Ql;return r(),a("div",ea,[e("div",ta,[_(D,{class:"flex-1",onNodeSelect:P}),e("div",oa,[e("div",sa,[_(o(we),{class:"w-4 h-4 text-yellow-400"})]),p[5]||(p[5]=e("h1",{class:"text-sm font-semibold text-white"},"Triggers",-1))]),!o(v).selectedNode&&!o(V)?(r(),a("button",{key:0,onClick:p[0]||(p[0]=B=>V.value=!0),class:"lg:hidden absolute top-3 right-3 z-20 w-11 h-11 bg-gradient-to-br from-spider-green-500 to-spider-green-600 hover:from-spider-green-400 hover:to-spider-green-500 rounded-2xl shadow-lg shadow-spider-green-500/40 flex items-center justify-center text-white transition-all"},[_(o(ze),{class:"w-5 h-5"})])):N("",!0),e("div",{class:f(["lg:static lg:translate-x-0 lg:h-full transition-transform duration-200 flex flex-col","absolute inset-y-0 right-0 z-30",o(v).selectedNode||o(V)?"translate-x-0":"translate-x-full lg:translate-x-0"])},[e("div",na,[e("button",{onClick:Z,class:f(["px-2.5 py-1.5 rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5",o(h)?"bg-gradient-to-r from-spider-green-500 to-spider-green-600 text-white shadow-lg shadow-spider-green-500/30":"bg-gray-700/60 text-gray-400 border border-gray-600/50 hover:bg-gray-600/60"])},[e("span",{class:f([o(h)?"bg-white animate-pulse":"bg-gray-500","w-2 h-2 rounded-full"])},null,2),L(" "+g(o(h)?"Active":"Inactive"),1)],2),e("button",{onClick:R,disabled:o(v).saving,class:"px-2.5 py-1.5 bg-gradient-to-r from-spider-green-500 to-spider-green-600 hover:from-spider-green-400 hover:to-spider-green-500 disabled:from-gray-600 disabled:to-gray-600 text-white rounded-lg text-xs font-semibold transition-all flex items-center gap-1.5 shadow-lg shadow-spider-green-500/25"},[o(v).saving?(r(),ee(o(vt),{key:1,class:"w-4 h-4 animate-spin"})):(r(),ee(o(bt),{key:0,class:"w-4 h-4"})),p[6]||(p[6]=L(" Save ",-1))],8,ra)]),_(E,{"selected-node":o(v).selectedNode,class:"flex-1 min-h-0",onUpdate:T,onDelete:n,onDeselect:S,onClosePalette:p[1]||(p[1]=B=>V.value=!1)},null,8,["selected-node"])],2)]),e("div",{class:f(["bg-gradient-to-r from-gray-800/95 to-gray-900/95 backdrop-blur-md border-t border-gray-700/50 overflow-hidden flex flex-col shrink-0 transition-[height] duration-200 relative",o(I)?"h-60":"h-9"])},[o(I)?(r(),a("div",la)):N("",!0),e("div",{class:"flex items-center justify-between px-3 sm:px-4 py-2 border-b border-gray-700/50 cursor-pointer relative",onClick:p[4]||(p[4]=B=>I.value=!o(I))},[e("h3",aa,[e("div",ia,[e("span",{class:f([o(I)?"rotate-90":"","transition-transform text-[9px] text-purple-400"])},"â–¶",2)]),p[7]||(p[7]=L(" Execution Logs ",-1))]),ut(e("select",{"onUpdate:modelValue":p[2]||(p[2]=B=>Be(C)?C.value=B:null),onChange:U,onClick:p[3]||(p[3]=pt(()=>{},["stop"])),class:"bg-gray-900/60 border border-gray-600/50 rounded-lg px-2.5 py-1.5 text-xs text-gray-300 focus:border-purple-500/50 focus:outline-none"},[...p[8]||(p[8]=[e("option",{value:"1h"},"1H",-1),e("option",{value:"4h"},"4H",-1),e("option",{value:"24h"},"24H",-1),e("option",{value:"7d"},"7D",-1)])],544),[[gt,o(C)]])]),e("div",da,[e("table",ca,[p[10]||(p[10]=e("thead",{class:"bg-gray-800/60 sticky top-0 backdrop-blur-sm"},[e("tr",null,[e("th",{class:"text-left px-2 sm:px-4 py-2 font-semibold text-gray-400"},"Time"),e("th",{class:"text-left px-2 sm:px-4 py-2 font-semibold text-gray-400"},"Socket"),e("th",{class:"text-left px-2 sm:px-4 py-2 font-semibold text-gray-400"},"Action"),e("th",{class:"text-left px-2 sm:px-4 py-2 font-semibold text-gray-400 hidden sm:table-cell"},"Result"),e("th",{class:"text-left px-2 sm:px-4 py-2 font-semibold text-gray-400 hidden md:table-cell"},"Reason")])],-1)),e("tbody",null,[(r(!0),a(H,null,j(o(v).executionLogs,B=>(r(),a("tr",{key:B.timestamp,class:"border-b border-gray-700/30 hover:bg-gray-700/40 transition-colors"},[e("td",ua,g(m(B.timestamp)),1),e("td",ga,g(B.socket),1),e("td",pa,[e("span",{class:f(["px-2 py-0.5 rounded-lg text-[10px] font-bold uppercase",B.action==="on"?"bg-spider-green-500/20 text-spider-green-400":"bg-gray-600/40 text-gray-400"])},g(B.action),3)]),e("td",xa,[e("span",{class:f([B.result==="success"?"text-spider-green-400":"text-red-400","font-medium"])},g(B.result),3)]),e("td",ma,g(B.triggerReason),1)]))),128)),o(v).executionLogs.length===0?(r(),a("tr",ya,[...p[9]||(p[9]=[e("td",{colspan:"5",class:"px-2 sm:px-4 py-6 text-center text-gray-500"}," No execution logs yet ",-1)])])):N("",!0)])])])],2)])}}}),Ra=be(ba,[["__scopeId","data-v-7c261dc6"]]);export{Ra as default};
