import*as e from"three";import{computeBoundsTree as t,disposeBoundsTree as n,acceleratedRaycast as o}from"three-mesh-bvh";import{ref as s}from"vue";const d=()=>{};e.BufferGeometry.prototype.computeBoundsTree=t,e.BufferGeometry.prototype.disposeBoundsTree=n,e.Mesh.prototype.raycast=o;const r=[];let a=null,c=null,u=null,p=null;function W(){return a}function C(){return c}function k(){return u}function Q(){return p}function X(e){a=e}function q(e){c=e}function J(e){u=e}function K(e){p=e}let l=1.7,m=0,f=200,y=.4,g=1;function Z(e){l=e}function $(e){m=e}function ee(e){f=e}function se(e){y=e}function te(e){g=e}const v=s(!1),h=!1,M=s(!1),x=[],w=[],b=[],B=new Map,E=new e.Raycaster,z=new e.Raycaster,A=[];for(let t=0;t<8;t++){const n=t/8*Math.PI*2;A.push(new e.Vector3(Math.cos(n),0,Math.sin(n)))}const T=new e.Color(26248),O=.8,S=new e.Color(21862),D=.4;function pe(e){return Math.round(1e4*e)/1e4}function ye(e){return e.split("/").pop()||""}function ge(e){return e.replace(/\.glb$/i,"").replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}const F=new e.Vector3;function de(){return C().getWorldDirection(F),Math.atan2(F.x,F.z)}function i(e){var t,n;e&&((null==(n=null==(t=e.source)?void 0:t.data)?void 0:n.close)&&e.source.data.close(),e.dispose())}function Me(e){e.traverse(e=>{if(e.geometry&&e.geometry.dispose(),e.material){const t=Array.isArray(e.material)?e.material:[e.material];for(const e of t)i(e.map),i(e.normalMap),i(e.roughnessMap),i(e.metalnessMap),i(e.emissiveMap),i(e.aoMap),i(e.lightMap),i(e.alphaMap),e.dispose()}})}function xe(e){e.traverse(e=>{e.geometry&&e.geometry.dispose()})}function he(e,t,n){const o=[];return e.traverse(e=>{var s;if(!e.isMesh||e.userData.isDisplayZone)return;const r=Array.isArray(e.material)?e.material:[e.material];for(const a of r)a.emissive&&(o.push({mesh:e,origEmissive:a.emissive.clone(),origEmissiveIntensity:null!=(s=a.emissiveIntensity)?s:1}),a.emissive.copy(t),a.emissiveIntensity=n)}),o}function ve(e){for(const t of e){const e=Array.isArray(t.mesh.material)?t.mesh.material:[t.mesh.material];for(const n of e)n.emissive&&(n.emissive.copy(t.origEmissive),n.emissiveIntensity=t.origEmissiveIntensity)}}function Te(e){I(e),e.traverse(e=>{if(!e.isMesh)return;let t=x.indexOf(e);t>=0&&x.splice(t,1),t=w.indexOf(e),t>=0&&w.splice(t,1)})}function V(e){var t,n,o;const s=e.geometry;if(!s||s.boundsTree)return;const r=s.index;(r?r.count/3:(null!=(o=null==(n=null==(t=s.attributes)?void 0:t.position)?void 0:n.count)?o:0)/3)>200&&s.computeBoundsTree({strategy:0,maxLeafSize:10})}function G(e){e.traverse(e=>{e.isMesh&&V(e)})}const P=[];let R=!1;function Ee(e){P.push(e),R||function(){if(0===P.length)return void(R=!1);R=!0}()}const U=new e.MeshBasicMaterial({visible:!1}),H=new Map,L=new e.Vector3,_=new e.Vector3;function j(t){I(t);const n=(new e.Box3).setFromObject(t);if(n.isEmpty())return;n.getSize(L),n.getCenter(_);const o=new e.BoxGeometry(L.x,L.y,L.z);o.computeBoundingSphere();const s=new e.Mesh(o,U);s.position.copy(_),s.visible=!1,s.matrixAutoUpdate=!1,s.updateMatrix(),s.matrixWorld.copy(s.matrix),s.userData.isCollisionProxy=!0,x.push(s),H.set(t,s)}function I(e){const t=H.get(e);if(!t)return;const n=x.indexOf(t);n>=0&&x.splice(n,1),t.geometry.dispose(),H.delete(e)}function Ie(t){var n;for(let o=0;o<b.length;o++){const s=b[o],r=H.get(s.group),a=null!=(n=null==t?void 0:t[o])?n:(new e.Box3).setFromObject(s.group);a.isEmpty()||(a.getSize(L),a.getCenter(_),r?(r.geometry.dispose(),r.geometry=new e.BoxGeometry(L.x,L.y,L.z),r.geometry.computeBoundingSphere(),r.position.copy(_),r.updateMatrix(),r.matrixWorld.copy(r.matrix)):j(s.group))}}const N=s(!1);function be(){return{sidebarOpen:N}}export{$,g as A,T as B,C,A as D,Ee as E,q as F,G,be as H,I,J,K,r as L,w as M,f as O,y as P,Q,l as R,m as S,Te as T,V,W,X,Z,xe as a,Me as b,de as c,d,ee as e,S as f,ge as g,he as h,B as i,j,k,z as l,D as m,h as n,v as o,pe as p,E as q,M as r,se as s,te as t,x as u,ve as v,Ie as w,b as x,ye as y,O as z};
