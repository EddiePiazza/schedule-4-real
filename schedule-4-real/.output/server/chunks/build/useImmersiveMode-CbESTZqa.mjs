import*as t from"three";import{computeBoundsTree as n,disposeBoundsTree as o,acceleratedRaycast as s}from"three-mesh-bvh";import{ref as r}from"vue";t.BufferGeometry.prototype.computeBoundsTree=n,t.BufferGeometry.prototype.disposeBoundsTree=o,t.Mesh.prototype.raycast=s;const a=[];let u=null,c=null,l=null,p=null;function L(){return u}function B(){return c}function W(){return l}function Q(){return p}function k(t){u=t}function X(t){c=t}function q(t){l=t}function J(t){p=t}let m=1.7,f=0,y=200,d=.4,g=1;function K(t){m=t}function Z(t){f=t}function $(t){y=t}function ee(t){d=t}function te(t){g=t}const v=r(!1),h=!1,M=r(!1),x=[],w=[],b=[],T=new Map,I=new t.Raycaster,A=new t.Raycaster,C=[];for(let n=0;n<8;n++){const o=n/8*Math.PI*2;C.push(new t.Vector3(Math.cos(o),0,Math.sin(o)))}const D=new t.Color(26248),O=.8,S=new t.Color(21862),G=.4;function le(t){return Math.round(1e4*t)/1e4}function pe(t){return t.split("/").pop()||""}function ye(t){return t.replace(/\.glb$/i,"").replace(/[-_]/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const j=new t.Vector3;function ge(){return B().getWorldDirection(j),Math.atan2(j.x,j.z)}function i(t){var n,o;t&&((null==(o=null==(n=t.source)?void 0:n.data)?void 0:o.close)&&t.source.data.close(),t.dispose())}function Me(t){t.traverse(t=>{if(t.geometry&&t.geometry.dispose(),t.material){const n=Array.isArray(t.material)?t.material:[t.material];for(const t of n)i(t.map),i(t.normalMap),i(t.roughnessMap),i(t.metalnessMap),i(t.emissiveMap),i(t.aoMap),i(t.lightMap),i(t.alphaMap),t.dispose()}})}function de(t){t.traverse(t=>{t.geometry&&t.geometry.dispose()})}function xe(t,n,o){var s;const r=[];return(null==(s=t.userData)?void 0:s.isTent)||t.traverse(t=>{var s;if(!t.isMesh||t.userData.isDisplayZone||t.userData.isTentSurface)return;const a=Array.isArray(t.material)?t.material:[t.material];for(const u of a)u.emissive&&(r.push({mesh:t,origEmissive:u.emissive.clone(),origEmissiveIntensity:null!=(s=u.emissiveIntensity)?s:1}),u.emissive.copy(n),u.emissiveIntensity=o)}),r}function he(t){for(const n of t){const t=Array.isArray(n.mesh.material)?n.mesh.material:[n.mesh.material];for(const o of t)o.emissive&&(o.emissive.copy(n.origEmissive),o.emissiveIntensity=n.origEmissiveIntensity)}}function ve(t){E(t),t.traverse(t=>{if(!t.isMesh)return;let n=x.indexOf(t);n>=0&&x.splice(n,1),n=w.indexOf(t),n>=0&&w.splice(n,1)})}function H(t){var n,o,s;const r=t.geometry;if(!r||r.boundsTree)return;const a=r.index;(a?a.count/3:(null!=(s=null==(o=null==(n=r.attributes)?void 0:n.position)?void 0:o.count)?s:0)/3)>200&&r.computeBoundsTree({strategy:0,maxLeafSize:10})}function V(t){t.traverse(t=>{t.isMesh&&H(t)})}const F=[];let P=!1;function Te(t){F.push(t),P||function(){if(0===F.length)return void(P=!1);P=!0;const e=()=>{const t=F.shift();t&&V(t),F.length>0?setTimeout(e,0):P=!1};setTimeout(e,0)}()}const R=new t.MeshBasicMaterial({visible:!1}),U=new Map,_=new t.Vector3,N=new t.Vector3;function z(n){E(n);const o=(new t.Box3).setFromObject(n);if(o.isEmpty())return;o.getSize(_),o.getCenter(N);const s=new t.BoxGeometry(_.x,_.y,_.z);s.computeBoundingSphere();const r=new t.Mesh(s,R);r.position.copy(N),r.visible=!1,r.matrixAutoUpdate=!1,r.updateMatrix(),r.matrixWorld.copy(r.matrix),r.userData.isCollisionProxy=!0,x.push(r),U.set(n,r)}function E(t){const n=U.get(t);if(!n)return;const o=x.indexOf(n);o>=0&&x.splice(o,1),n.geometry.dispose(),U.delete(t)}function Ee(n){var o;for(let s=0;s<b.length;s++){const r=b[s],a=U.get(r.group),u=null!=(o=null==n?void 0:n[s])?o:(new t.Box3).setFromObject(r.group);u.isEmpty()||(u.getSize(_),u.getCenter(N),a?(a.geometry.dispose(),a.geometry=new t.BoxGeometry(_.x,_.y,_.z),a.geometry.computeBoundingSphere(),a.position.copy(N),a.updateMatrix(),a.matrixWorld.copy(a.matrix)):z(r.group))}}const Y=r(!1);function Ie(){return{sidebarOpen:Y}}export{$,q as A,B,f as C,C as D,E,H,Ie as I,J,K,L,w as M,d as O,g as P,Q,y as R,m as S,Te as T,a as U,V,W,X,Z,de as a,Me as b,A as c,b as d,ee as e,G as f,ge as g,he as h,I as i,Ee as j,O as k,le as l,S as m,M as n,h as o,pe as p,D as q,T as r,v as s,te as t,x as u,ve as v,k as w,xe as x,ye as y,z};
