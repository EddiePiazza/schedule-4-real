import{defineStore as e}from"pinia";import{u as i}from"./useAuthGate-BgxmmIEE.mjs";const t=e("devices",{state:()=>({devices:{},loading:!1,loaded:!1}),getters:{allDevices:e=>Object.values(e.devices),getDevicesByType:e=>i=>Object.values(e.devices).filter(e=>e.deviceType===i),ps5Devices:e=>Object.values(e.devices).filter(e=>"PS5"===e.deviceType),lcDevices:e=>Object.values(e.devices).filter(e=>"LC"===e.deviceType),cbDevices:e=>Object.values(e.devices).filter(e=>"CB"===e.deviceType),primaryDevices:e=>Object.values(e.devices).filter(e=>"PS5"===e.deviceType||"CB"===e.deviceType),getDisplayName:e=>i=>{const t=e.devices[i];return t?t.customName||function(e){switch(e){case"PS5":return"Power Strip";case"CB":return"Control Box";case"LC":return"Light Controller";default:return e}}(t.deviceType):i},getSignalBars:()=>e=>e>=-50?4:e>=-60?3:e>=-70?2:e>=-80?1:0,getSignalLabel:()=>e=>e>=-50?"Excellent":e>=-60?"Good":e>=-70?"Fair":e>=-80?"Weak":"Poor"},actions:{async fetchDevices(){this.loaded||(this.loading=!0);try{const e=await $fetch("/api/devices");if(null==e?void 0:e.devices){for(const i of e.devices)this.devices[i.mac]=i;this.loaded=!0}}catch{}finally{this.loading=!1}},async updateDeviceName(e,t){try{const{getAuthHeaders:s}=i(),c=await $fetch(`/api/devices/${e}`,{method:"PUT",headers:s(),body:{customName:t}});return c&&(this.devices[e]=c),c}catch(e){throw e}},updateDevice(e,i){var t,s,c;this.devices[e]?this.devices[e]={...this.devices[e],...i}:this.devices[e]={mac:e,deviceType:i.deviceType||"UNKNOWN",connected:null==(t=i.connected)||t,lastSeen:null!=(s=i.lastSeen)?s:Date.now(),wifiRssi:null!=(c=i.wifiRssi)?c:0,...i}},updateWifi(e,i){this.devices[e]&&(this.devices[e].wifiRssi=i,this.devices[e].lastSeen=Date.now(),this.devices[e].connected=!0)}}});export{t as u};
