import{defineComponent as e,ref as t,computed as a,mergeProps as s,unref as l,provide as n,reactive as i,inject as r,watch as o,shallowRef as d,createVNode as c,resolveDynamicComponent as u,useSSRContext as v}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as x,ssrInterpolate as m,ssrRenderStyle as g,ssrRenderClass as b,ssrRenderList as f,ssrRenderAttr as h,ssrIncludeBooleanAttr as $,ssrLooseContain as S,ssrLooseEqual as j,ssrRenderTeleport as C,ssrRenderVNode as M}from"vue/server-renderer";import{BeakerIcon as _,PencilIcon as T}from"@heroicons/vue/24/outline";import{o as O,d as F,r as L,X as A,m as E,C as H}from"./lights-BCfJksXN.mjs";import{w as P}from"./useSocketNames-CMd40qB4.mjs";import{d as N}from"./triggers-BGw-F1Fy.mjs";import{BoltIcon as R,LightBulbIcon as W,ChartBarIcon as B,CalendarIcon as z,ArrowPathIcon as G,FireIcon as U,CloudIcon as X,BeakerIcon as J,SparklesIcon as K}from"@heroicons/vue/24/solid";import{Line as Y}from"vue-chartjs";import{Chart as Z,LinearScale as ee,TimeScale as te,PointElement as ae,LineElement as se,Title as le,Tooltip as ne,Legend as ie,Filler as re}from"chart.js";import{s as oe}from"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"pinia";import"./useAuthGate-BgxmmIEE.mjs";import"./server.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";const de=e({__name:"SensorCard",__ssrInlineRender:!0,props:{title:{},value:{},unit:{},icon:{},status:{},decimals:{default:1},stats:{},dayStats:{},nightStats:{}},setup:e=>(t,a,l,n)=>{a(`<div${p(s({class:"relative p-2.5 sm:p-3 rounded-xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 overflow-hidden group hover:border-gray-600/50 transition-all"},n))}>`),e.status?a(`<div class="${b([{"bg-spider-green-500":"normal"===e.status||"optimal"===e.status,"bg-yellow-500":"high"===e.status||"warn-high"===e.status,"bg-blue-500":"low"===e.status||"warn-low"===e.status},"absolute -top-4 -right-4 w-16 h-16 rounded-full blur-2xl opacity-30 pointer-events-none transition-opacity"])}"></div>`):a("\x3c!----\x3e"),a(`<div class="relative flex items-center justify-between gap-2"><div class="min-w-0 flex-1"><div class="flex items-center gap-1.5 mb-1"><span class="text-[10px] sm:text-xs text-gray-400 uppercase tracking-wider font-medium truncate">${m(e.title)}</span>`),e.status?a(`<span class="${b([{"bg-spider-green-400 ring-spider-green-400/30":"normal"===e.status||"optimal"===e.status,"bg-yellow-400 ring-yellow-400/30":"high"===e.status||"warn-high"===e.status,"bg-blue-400 ring-blue-400/30":"low"===e.status||"warn-low"===e.status},"w-1.5 h-1.5 rounded-full shrink-0 ring-2"])}"></span>`):a("\x3c!----\x3e"),a(`</div><div class="flex items-baseline"><span class="text-xl sm:text-2xl font-bold text-white tracking-tight">${m("number"==typeof e.value?e.value.toFixed(e.decimals):"--")}</span><span class="text-gray-500 ml-1 text-[10px] sm:text-xs font-medium">${m(e.unit)}</span></div></div>`),!e.stats||e.dayStats||e.nightStats?a("\x3c!----\x3e"):a(`<div class="text-[11px] sm:text-[13px] space-y-0.5 text-right shrink-0"><div class="flex items-center justify-end gap-1"><span class="text-gray-600">Min</span><span class="text-blue-400 font-medium">${m(e.stats.min)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-gray-600">Avg</span><span class="text-spider-green-400 font-medium">${m(e.stats.avg)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-gray-600">Max</span><span class="text-red-400 font-medium">${m(e.stats.max)}</span></div></div>`),e.dayStats||e.nightStats?(a('<div class="flex text-[11px] sm:text-[13px] shrink-0">'),e.dayStats?a(`<div class="space-y-0.5 text-right pr-2"><div class="flex items-center justify-end gap-1"><span class="text-yellow-500 font-medium">Day Min</span><span class="text-blue-400 font-semibold">${m(e.dayStats.min)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-yellow-500 font-medium">Avg</span><span class="text-spider-green-400 font-semibold">${m(e.dayStats.avg)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-yellow-500 font-medium">Max</span><span class="text-red-400 font-semibold">${m(e.dayStats.max)}</span></div></div>`):a("\x3c!----\x3e"),e.dayStats&&e.nightStats?a('<div class="w-px bg-gray-600/50 mx-1"></div>'):a("\x3c!----\x3e"),e.nightStats?a(`<div class="space-y-0.5 text-right pl-1"><div class="flex items-center justify-end gap-1"><span class="text-indigo-400 font-medium">Night Min</span><span class="text-blue-400 font-semibold">${m(e.nightStats.min)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-indigo-400 font-medium">Avg</span><span class="text-spider-green-400 font-semibold">${m(e.nightStats.avg)}</span></div><div class="flex items-center justify-end gap-1"><span class="text-indigo-400 font-medium">Max</span><span class="text-red-400 font-semibold">${m(e.nightStats.max)}</span></div></div>`):a("\x3c!----\x3e"),a("</div>")):a("\x3c!----\x3e"),a("</div></div>")}}),ce=de.setup;de.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/SensorCard.vue"),ce?ce(e,t):void 0};const ue=Object.assign(de,{__name:"SensorCard"}),ve=e({__name:"SoilSensorsPanel",__ssrInlineRender:!0,props:{stacked:{type:Boolean}},setup(e){const n=e,i=O(),r=t(null),o=t(""),d=a(()=>i.soilSensors.filter(e=>function(e){if(!e.lastSeen)return!1;const t=new Date(e.lastSeen).getTime();return Date.now()-t<6e5}(e)));function w(e){return i.soilSensorsCurrent[e]}function y(e,t=1){return null==e?"--":e.toFixed(t)}return a(()=>i.soilSensorsLoading),(e,t,a,i)=>{l(d).length>0?(t(`<div${p(s({class:["grid gap-2",n.stacked||1===l(d).length?"grid-cols-1":"grid-cols-2"]},i))}>\x3c!--[--\x3e`),f(l(d),(e,s)=>{var n,i,d;t('<div class="p-2.5 rounded-xl bg-gradient-to-br from-amber-900/20 to-gray-900/40 border border-amber-500/20 backdrop-blur-md"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2 min-w-0 flex-1"><div class="w-5 h-5 rounded bg-amber-500/20 flex items-center justify-center shrink-0">'),t(x(l(_),{class:"w-3 h-3 text-amber-400"},null,a)),t('</div><div class="min-w-0 flex-1">'),l(r)===e.id?t(`<div class="flex items-center gap-1"><input${h("value",l(o))} class="bg-gray-800 border border-gray-600 rounded px-1.5 py-0.5 text-base text-white w-full max-w-[120px]" placeholder="Name" autofocus></div>`):(t(`<button class="text-base font-medium text-white hover:text-amber-300 truncate text-left transition-colors flex items-center gap-1 group" title="Click to rename"><span class="truncate">${m(e.name||`Sensor ${s+1}`)}</span>`),t(x(l(T),{class:"w-3 h-3 text-gray-500 group-hover:text-amber-300 shrink-0"},null,a)),t("</button>")),t(`</div></div><span class="text-[9px] text-gray-500 font-mono shrink-0 ml-2">${m(e.shortId)}</span></div><div class="grid grid-cols-3 gap-1.5"><div class="text-center"><div class="text-base text-gray-500 opacity-60 mb-0.5">Temp</div><div class="text-base font-semibold text-white">${m(y(null==(n=w(e.id))?void 0:n.temp_soil,1))}<span class="text-base text-gray-400 opacity-60">Â°C</span></div></div><div class="text-center"><div class="text-base text-gray-500 opacity-60 mb-0.5">Moisture</div><div class="text-base font-semibold text-white">${m(y(null==(i=w(e.id))?void 0:i.humi_soil,1))}<span class="text-base text-gray-400 opacity-60">%</span></div></div><div class="text-center"><div class="text-base text-gray-500 opacity-60 mb-0.5">EC</div><div class="text-base font-semibold text-amber-400">${m(y(null==(d=w(e.id))?void 0:d.ec_soil,2))}<span class="text-base text-gray-400 opacity-60">mS</span></div></div></div></div>`)}),t("\x3c!--]--\x3e</div>")):t("\x3c!----\x3e")}}}),pe=ve.setup;ve.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/SoilSensorsPanel.vue"),pe?pe(e,t):void 0};const xe=Object.assign(ve,{__name:"SoilSensorsPanel"}),me=e({__name:"SocketCard",__ssrInlineRender:!0,props:{socket:{},state:{}},emits:["toggle"],setup(e,{emit:t}){const{getSocketDisplayName:n}=P(),i=F(),r=N(),o=e,d=a(()=>`O${o.socket}`),c=a(()=>n(d.value,"short")),u=a(()=>{var e;return(null==(e=i.wattage[d.value])?void 0:e.watts)||0}),v={0:"Manual",1:"Time Slot",2:"Cycle",3:"Temp",4:"Humidity",5:"CO2",14:"Drip"},x={1:"T",2:"C",3:"Te",4:"H",5:"CO",14:"D"},g=a(()=>{var e;return(null==(e=o.state)?void 0:e.isOn)?"bg-gradient-to-br from-spider-green-600/80 to-spider-green-700/60 border-2 border-spider-green-500/60 text-white shadow-lg shadow-spider-green-500/20":"bg-gradient-to-br from-gray-700/60 to-gray-800/60 border-2 border-gray-600/50 text-gray-400 hover:border-gray-500/60 hover:from-gray-700/70 hover:to-gray-800/70"}),f=a(()=>r.isSocketAiEnabled(d.value)),h=a(()=>{var e;return f.value?"Trigger":v[null==(e=o.state)?void 0:e.modeType]||"Manual"}),$=a(()=>{var e;return f.value?"Ai":x[null==(e=o.state)?void 0:e.modeType]||""});return(t,a,n,i)=>{var r,o,d,v,x;a(`<div${p(s({class:["relative p-2.5 sm:p-3 rounded-xl transition-all cursor-pointer min-h-[52px] sm:min-h-[60px] overflow-hidden group",l(g)]},i))}>`),(null==(r=e.state)?void 0:r.isOn)?a('<div class="absolute inset-0 bg-gradient-to-br from-spider-green-500/20 to-emerald-600/10 pointer-events-none"></div>'):a("\x3c!----\x3e"),(null==(o=e.state)?void 0:o.isOn)?a('<div class="absolute -top-4 -right-4 w-16 h-16 rounded-full bg-spider-green-500/30 blur-xl pointer-events-none"></div>'):a("\x3c!----\x3e"),a(`<div class="relative"><div class="flex items-center justify-between mb-1.5"><span class="font-bold text-sm truncate max-w-[80px]">${m(l(c))}</span><span class="${b([(null==(d=e.state)?void 0:d.isOn)?"bg-spider-green-400 ring-spider-green-400/40 shadow-lg shadow-spider-green-400/50":"bg-gray-500 ring-gray-500/30","w-2.5 h-2.5 rounded-full shrink-0 ring-2 transition-all"])}"></span></div><div class="flex items-center justify-between text-xs"><span class="${b([(null==(v=e.state)?void 0:v.isOn)?"text-gray-200":"text-gray-500","font-medium"])}">${m(l(h))}</span>`),l(u)>0?a(`<span class="${b([(null==(x=e.state)?void 0:x.isOn)?"text-yellow-400":"text-gray-500","font-semibold"])}">${m(l(u))}W</span>`):a("\x3c!----\x3e"),a("</div></div>"),l($)?a(`<span class="${b([l(f)?"bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-purple-500/40":"bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-blue-500/40","absolute -top-1.5 -right-1.5 w-5 h-5 rounded-full text-[9px] flex items-center justify-center font-bold shadow-lg"])}">${m(l($))}</span>`):a("\x3c!----\x3e"),a("</div>")}}}),ge=me.setup;me.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/SocketCard.vue"),ge?ge(e,t):void 0};const be=Object.assign(me,{__name:"SocketCard"}),ye=e({__name:"LightCard",__ssrInlineRender:!0,props:{title:{},lightId:{},state:{}},emits:["toggle"],setup(e){const n=F(),i=L(),r=e,o={0:"Manual",1:"Time Slot",2:"Cycle",12:"PPFD Auto"},d=a(()=>{var e;return o[null==(e=r.state)?void 0:e.modeType]||"Auto"}),c=a(()=>{var e;const t=n.lightWattage[r.lightId];return t&&t.watts?(null==(e=r.state)?void 0:e.isOn)&&r.state.mLevel>0?Math.round(t.watts*r.state.mLevel/100):t.watts:0}),u=a(()=>{var e;const t=i.configs[r.lightId];if(!t)return null;if(null==(e=t.timePeriod)?void 0:e.length){const e=t.timePeriod.find(e=>e.enabled);if(void 0!==(null==e?void 0:e.brightness))return e.brightness}return void 0!==t.ppfdMaxBrightness?t.ppfdMaxBrightness:null}),v=t("");return t(null),(t,a,n,i)=>{var r,o,x,f,h,$,S,j,C,M,_,T;a(`<div${p(s({class:"relative p-3 sm:p-4 rounded-xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 overflow-hidden"},i))}>`),(null==(r=e.state)?void 0:r.isOn)?a(`<div class="${b([e.state.mLevel>50?"bg-yellow-500/40":"bg-yellow-500/20","absolute -top-6 -right-6 w-24 h-24 rounded-full blur-2xl pointer-events-none"])}"></div>`):a("\x3c!----\x3e"),a(`<div class="relative"><div class="flex items-center justify-between mb-3"><span class="font-semibold text-sm text-white">${m(e.title)}</span><div class="flex items-center gap-2"><span class="text-[10px] text-gray-400 uppercase tracking-wider font-medium">${m(l(d))}</span><span class="${b([(null==(o=e.state)?void 0:o.isOn)?"bg-yellow-400 ring-yellow-400/40 shadow-lg shadow-yellow-400/50":"bg-gray-500 ring-gray-500/30","w-2.5 h-2.5 rounded-full ring-2 transition-all"])}"></span></div></div><div class="relative h-2.5 bg-gray-700/60 rounded-full overflow-hidden">`),null!==l(u)&&0!==(null==(x=e.state)?void 0:x.modeType)?a(`<div class="absolute inset-y-0 left-0 rounded-full bg-gray-500/50 transition-all duration-300" style="${g({width:`${l(u)}%`})}"></div>`):a("\x3c!----\x3e"),a(`<div class="${b([(null==(f=e.state)?void 0:f.isOn)?"bg-gradient-to-r from-yellow-500 to-amber-400":"bg-gray-600","absolute inset-y-0 left-0 rounded-full transition-all duration-300"])}" style="${g({width:`${(null==(h=e.state)?void 0:h.isOn)?e.state.mLevel:0}%`})}"></div>`),(null==($=e.state)?void 0:$.isOn)&&e.state.mLevel>0?a(`<div class="absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-yellow-400/50 to-transparent blur-sm" style="${g({width:`${e.state.mLevel}%`})}"></div>`):a("\x3c!----\x3e"),a(`</div><div class="flex justify-between mt-2 text-xs"><div class="flex items-center gap-2"><span class="${b((null==(S=e.state)?void 0:S.isOn)?"text-white font-semibold":"text-gray-500")}">${m((null==(j=e.state)?void 0:j.isOn)?`${e.state.mLevel}%`:"OFF")}</span>`),null!==l(u)&&0!==(null==(C=e.state)?void 0:C.modeType)?a(`<span class="text-gray-500 text-[10px]">/ ${m(l(u))}%</span>`):a("\x3c!----\x3e"),l(c)>0?a(`<span class="${b([(null==(M=e.state)?void 0:M.isOn)?"text-yellow-400 bg-yellow-400/10":"text-gray-500","font-semibold px-1.5 py-0.5 rounded-md"])}">${m(l(c))}W</span>`):a("\x3c!----\x3e"),a('</div><div class="flex items-center gap-2">'),l(v)?a(`<span class="text-[10px] text-blue-400 font-medium">${m(l(v))}</span>`):a("\x3c!----\x3e"),0===(null==(_=e.state)?void 0:_.modeType)?a(`<button class="${b([(null==(T=e.state)?void 0:T.isOn)?"text-gray-400 hover:text-white hover:bg-gray-700/50":"text-spider-green-400 hover:bg-spider-green-500/20","px-2.5 py-1 rounded-lg text-[10px] font-semibold uppercase tracking-wider transition-all"])}"> Toggle </button>`):a("\x3c!----\x3e"),a("</div></div></div></div>")}}}),fe=ye.setup;ye.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/LightCard.vue"),fe?fe(e,t):void 0};const he=Object.assign(ye,{__name:"LightCard"}),we=e({__name:"PowerSummaryCard",__ssrInlineRender:!0,setup(e){const a=F(),n=A(),{getSocketDisplayName:i}=P(),r=t("24h"),o=t(!0);function k(e){if(e<60)return`${e}m`;const t=Math.floor(e/60),a=e%60;return a>0?`${t}h${a}m`:`${t}h`}function w$1(e){return e>=1e3?{value:(e/1e3).toFixed(2),unit:"MWh"}:e>=100||e>=10?{value:e.toFixed(1),unit:"kWh"}:{value:e.toFixed(2),unit:"kWh"}}return(e,t,d,c)=>{t(`<div${p(s({class:"relative"},c))}>`),l(a).powerStats?(t('\x3c!--[--\x3e<div class="flex items-center gap-3 mb-3 flex-wrap"><div class="flex items-center gap-2"><div class="w-7 h-7 rounded-lg bg-gradient-to-br from-yellow-500/30 to-amber-600/20 flex items-center justify-center">'),t(x(l(R),{class:"w-4 h-4 text-yellow-400"},null,d)),t(`</div><div><span class="text-[10px] text-gray-500 uppercase tracking-wider font-medium block">Power</span><div class="flex items-baseline gap-1"><span class="text-xl font-bold text-white">${m(w$1(l(a).powerStats.totals.kWh).value)}</span><span class="text-xs text-gray-400">${m(w$1(l(a).powerStats.totals.kWh).unit)}</span></div></div></div><select class="bg-gray-800/60 border border-gray-600/50 rounded-lg px-2 py-1.5 text-[10px] text-gray-300 focus:border-yellow-500/50 focus:outline-none"><option value="24h"${$(Array.isArray(r.value)?S(r.value,"24h"):j(r.value,"24h"))?" selected":""}>24H</option><option value="7d"${$(Array.isArray(r.value)?S(r.value,"7d"):j(r.value,"7d"))?" selected":""}>7D</option><option value="30d"${$(Array.isArray(r.value)?S(r.value,"30d"):j(r.value,"30d"))?" selected":""}>30D</option></select>`),l(a).powerStats.extrapolated?t('<span class="text-[9px] text-yellow-500/80 px-1.5 py-0.5 rounded bg-yellow-500/10" title="Estimated from available data">~est</span>'):t("\x3c!----\x3e"),l(a).powerStats.totals.cost>0?t(`<div class="ml-auto flex items-baseline gap-1 px-2.5 py-1 rounded-lg bg-spider-green-500/10 border border-spider-green-500/30"><span class="text-sm font-bold text-spider-green-400">${m(l(a).powerStats.totals.cost.toFixed(2))}</span><span class="text-[10px] text-gray-400">EUR</span></div>`):t("\x3c!----\x3e"),t("</div>"),o.value?(t('<div class="space-y-1.5 border-t border-gray-700/50 pt-3">\x3c!--[--\x3e'),f(l(a).powerStats.lights.filter(e=>e.watts>0),e=>{t(`<div class="flex items-center justify-between text-[10px] sm:text-xs p-1.5 rounded-lg hover:bg-gray-800/40 transition-colors"><div class="flex items-center gap-2"><div class="w-5 h-5 rounded bg-yellow-500/20 flex items-center justify-center"><span class="text-[10px]">ðŸ’¡</span></div><span class="text-gray-300 font-medium">${m("light"===e.socket?"Light 1":"Light 2")}</span></div><div class="flex items-center gap-3"><span class="text-gray-500">${m(k(e.onTimeMinutes))} @ ${m(e.avgLevel)}%</span><span class="text-white font-semibold">${m(w$1(e.kWh).value)} ${m(w$1(e.kWh).unit)}</span>`),e.cost>0?t(`<span class="text-spider-green-400 font-medium">â‚¬${m(e.cost.toFixed(2))}</span>`):t("\x3c!----\x3e"),t("</div></div>")}),t("\x3c!--]--\x3e\x3c!--[--\x3e"),f(l(a).powerStats.sockets.filter(e=>e.watts>0),e=>{t(`<div class="flex items-center justify-between text-[10px] sm:text-xs p-1.5 rounded-lg hover:bg-gray-800/40 transition-colors"><div class="flex items-center gap-2"><div class="w-5 h-5 rounded bg-blue-500/20 flex items-center justify-center"><span class="text-[10px]">ðŸ”Œ</span></div><span class="text-gray-300 font-medium">${m(l(i)(e.socket,"short"))}</span></div><div class="flex items-center gap-3"><span class="text-gray-500">${m(k(e.onTimeMinutes))}</span><span class="text-white font-semibold">${m(w$1(e.kWh).value)} ${m(w$1(e.kWh).unit)}</span>`),e.cost>0?t(`<span class="text-spider-green-400 font-medium">â‚¬${m(e.cost.toFixed(2))}</span>`):t("\x3c!----\x3e"),t("</div></div>")}),t("\x3c!--]--\x3e"),l(n).loaded&&l(a).powerStats.blower?(t(`<div class="flex items-center justify-between text-[10px] sm:text-xs p-1.5 rounded-lg hover:bg-gray-800/40 transition-colors"><div class="flex items-center gap-2"><div class="w-5 h-5 rounded bg-cyan-500/20 flex items-center justify-center"><span class="text-[10px]">ðŸŒ€</span></div><span class="text-gray-300 font-medium">Blower</span></div><div class="flex items-center gap-3"><span class="text-gray-500">${m(k(l(a).powerStats.blower.onTimeMinutes))} @ ${m(l(a).powerStats.blower.avgLevel)}%</span><span class="text-white font-semibold">${m(w$1(l(a).powerStats.blower.kWh).value)} ${m(w$1(l(a).powerStats.blower.kWh).unit)}</span>`),l(a).powerStats.blower.cost>0?t(`<span class="text-spider-green-400 font-medium">â‚¬${m(l(a).powerStats.blower.cost.toFixed(2))}</span>`):t("\x3c!----\x3e"),t("</div></div>")):t("\x3c!----\x3e"),t("</div>")):t("\x3c!----\x3e"),t(`<button class="text-[10px] text-gray-500 hover:text-gray-300 mt-2 sm:hidden flex items-center gap-1 transition-colors"><span>${m(o.value?"Hide details":"Show details")}</span><svg class="${b([o.value&&"rotate-180","w-3 h-3 transition-transform"])}" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>\x3c!--]--\x3e`)):t('<div class="text-xs text-gray-500 py-4 text-center"><div class="animate-pulse flex items-center justify-center gap-2"><div class="w-4 h-4 rounded-full bg-gray-700"></div><span>Loading power data...</span></div></div>'),t("</div>")}}}),$e=we.setup;we.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/PowerSummaryCard.vue"),$e?$e(e,t):void 0};const ke=Object.assign(we,{__name:"PowerSummaryCard"}),Se=e({__name:"SocketTimeline",__ssrInlineRender:!0,props:{events:{},syncRangeStart:{},syncRangeEnd:{}},setup(e){const{getSocketDisplayName:t}=P(),s=e,n=i({visible:!1,x:0,y:0,socket:"",startTime:"",endTime:"",duration:"",isActive:!1}),r={O1:"bg-green-500/80 hover:bg-green-400",O2:"bg-blue-500/80 hover:bg-blue-400",O3:"bg-orange-500/80 hover:bg-orange-400",O4:"bg-purple-500/80 hover:bg-purple-400",O5:"bg-yellow-500/80 hover:bg-yellow-400"};function D(e){return r[e]||"bg-gray-500/80 hover:bg-gray-400"}const o=a(()=>{var e;return(null==(e=s.events)?void 0:e.sockets)?s.events.sockets.filter(e=>e.events.length>0):[]}),d=a(()=>{var e,t;const a=s.syncRangeStart?new Date(s.syncRangeStart).getTime():(null==(e=s.events)?void 0:e.rangeStart)?new Date(s.events.rangeStart).getTime():Date.now()-36e5,l=s.syncRangeEnd?new Date(s.syncRangeEnd).getTime():(null==(t=s.events)?void 0:t.rangeEnd)?new Date(s.events.rangeEnd).getTime():Date.now();return{start:a,end:l,total:l-a}});return(e,a,s,i)=>{a(`<div${p(i)}><div class="flex items-start justify-between gap-2 mb-2 sm:mb-3"><h3 class="text-xs text-gray-400 flex items-center gap-1 shrink-0">`),a(x(l(R),{class:"w-3 h-3 text-yellow-400"},null,s)),a('<span class="hidden sm:inline">Socket Activity</span><span class="sm:hidden">Sockets</span></h3>'),l(o).length>0?(a('<div class="flex flex-wrap gap-x-3 gap-y-1 text-xs justify-end">\x3c!--[--\x3e'),f(l(o),e=>{a(`<span class="text-gray-500"><span class="text-gray-400">${m(l(t)(e.socket,"short"))}:</span><span class="text-spider-green-400">${m(function(e){if(e<60)return`${e}s`;if(e<3600){const t=Math.floor(e/60),a=e%60;return a>0?`${t}m ${a}s`:`${t}m`}const t=Math.floor(e/3600),a=Math.floor(e%3600/60);return a>0?`${t}h ${a}m`:`${t}h`}(e.totalSeconds))}</span></span>`)}),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),a("</div>"),0===l(o).length?a('<div class="text-center py-4 text-gray-500 text-sm"> No socket activity in this time range </div>'):(a('<div><div class="flex"><div class="w-[40px] sm:w-[60px] shrink-0 flex flex-col justify-between pr-1 sm:pr-2 py-1">\x3c!--[--\x3e'),f(l(o),e=>{a(`<div class="h-5 flex items-center justify-end text-[9px] text-gray-400 truncate">${m(l(t)(e.socket,"short"))}</div>`)}),a('\x3c!--]--\x3e</div><div class="flex-1 relative"><div class="relative flex flex-col gap-1 py-1">\x3c!--[--\x3e'),f(l(o),e=>{a('<div class="h-5 bg-gray-900/50 rounded relative overflow-hidden">\x3c!--[--\x3e'),f(e.events,(t,s)=>{a(`<div class="${b([D(e.socket),"absolute h-full rounded-sm cursor-pointer transition-colors"])}" style="${g(function(e){const{start:t,end:a,total:s}=d.value;if(s<=0)return{display:"none"};const l=new Date(e.start).getTime(),n=e.end?new Date(e.end).getTime():Date.now(),i=Math.max(l,t),r=Math.min(n,a);if(r<=t||i>=a)return{display:"none"};const o=(r-i)/s*100;return{left:(i-t)/s*100+"%",width:`${Math.max(o,.5)}%`}}(t))}"></div>`)}),a("\x3c!--]--\x3e</div>")}),a("\x3c!--]--\x3e</div></div></div></div>")),C(a,e=>{l(n).visible?e(`<div class="fixed z-50 bg-gray-900 border border-gray-600 rounded-lg shadow-xl px-3 py-2 text-xs pointer-events-none" style="${g({left:l(n).x+"px",top:l(n).y+"px"})}"><div class="font-medium text-white mb-1">${m(l(t)(l(n).socket,"full"))}</div><div class="space-y-0.5 text-gray-300"><div class="flex items-center gap-2"><span class="text-gray-500">Inicio:</span><span>${m(l(n).startTime)}</span></div><div class="flex items-center gap-2"><span class="text-gray-500">Fin:</span><span class="${b(l(n).isActive?"text-spider-green-400":"")}">${m(l(n).endTime)}</span></div><div class="flex items-center gap-2 pt-1 border-t border-gray-700 mt-1"><span class="text-gray-500">DuraciÃ³n:</span><span class="text-spider-green-400 font-medium">${m(l(n).duration)}</span></div></div></div>`):e("\x3c!----\x3e")},"body",!1,s),a("</div>")}}}),je=Se.setup;Se.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/SocketTimeline.vue"),je?je(e,t):void 0};const Ce=Object.assign(Se,{__name:"SocketTimeline"}),Me=e({__name:"SensorChart",__ssrInlineRender:!0,props:{title:{},icon:{},iconColor:{},data:{},color:{},emptyMessage:{},yOptions:{},yAxisWidth:{},stepped:{type:[Boolean,String]},timeMin:{},timeMax:{}},setup(e){Z.register(ee,te,ae,se,le,ne,ie,re);const s=e,n=t(null),i=r("chartsCrosshairX",t(null)),v=r("chartsContainerEl",t(null));o(i,e=>{var t,a,s,l,i;const r=null==(t=n.value)?void 0:t.chart;if(!r||!r.chartArea)return;if(null===e)return r.setActiveElements([]),null==(a=r.tooltip)||a.setActiveElements([],{x:0,y:0}),void r.update("none");const o=r.canvas,d=null==(s=v.value)?void 0:s.getBoundingClientRect(),c=o.getBoundingClientRect();if(!d)return;const u=e-(c.left-d.left),{left:p,right:x}=r.chartArea;if(u<p||u>x)return r.setActiveElements([]),null==(l=r.tooltip)||l.setActiveElements([],{x:0,y:0}),void r.update("none");const m=r.getDatasetMeta(0);if(!m||!m.data||0===m.data.length)return;let g=0,b=1/0;for(let e=0;e<m.data.length;e++){const t=Math.abs(m.data[e].x-u);t<b&&(b=t,g=e)}const f=m.data[g],h=[{datasetIndex:0,index:g}];r.setActiveElements(h),null==(i=r.tooltip)||i.setActiveElements(h,{x:f.x,y:f.y}),r.update("none")});const g=a(()=>s.data&&s.data.length>0),b=a(()=>{const e=s.yAxisWidth?parseInt(s.yAxisWidth,10):void 0;return{responsive:!0,maintainAspectRatio:!1,animation:!1,events:["mousemove"],interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1},tooltip:{backgroundColor:"#1f2937",borderColor:"#374151",borderWidth:1}},scales:{x:{type:"time",time:{displayFormats:{minute:"HH:mm",hour:"HH:mm",day:"dd/MM HH:mm"}},...s.timeMin?{min:s.timeMin}:{},...s.timeMax?{max:s.timeMax}:{},grid:{color:"#374151"},ticks:{color:"#9ca3af",maxTicksLimit:8,font:{size:9}}},y:{grid:{color:"#374151"},ticks:{color:"#9ca3af",font:{size:9}},...s.yOptions,...e?{afterFit:t=>{t.width=e}}:{}}}}}),f=d({datasets:[]});let h="";return o(()=>s.data,e=>{if(!e||0===e.length)return;const t=`${e.length}:${e[0].timestamp}:${e[e.length-1].timestamp}`;t!==h&&(h=t,f.value={datasets:[{label:s.title,data:e.map(e=>({x:new Date(e.timestamp).getTime(),y:e.value})),borderColor:s.color,backgroundColor:s.color+"1A",fill:!0,tension:s.stepped?0:.3,stepped:s.stepped||!1,pointRadius:0}]})},{immediate:!0}),(t,a,s,i)=>{a(`<div${p(i)}><h3 class="text-base text-gray-400 mb-1 flex items-center gap-1">`),M(a,c(u(e.icon),{class:["w-3 h-3",e.iconColor]},null),s),a(` ${m(e.title)}</h3><div class="h-32 sm:h-40">`),l(g)?a(x(l(Y),{ref_key:"chartRef",ref:n,data:f.value,options:l(b)},null,s)):a(`<div class="flex items-center justify-center h-full text-gray-500 text-base">${m(e.emptyMessage||"No data available")}</div>`),a("</div></div>")}}}),_e=Me.setup;Me.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/SensorChart.vue"),_e?_e(e,t):void 0};const Te=Object.assign(Me,{__name:"SensorChart"}),De=e({__name:"ChartsSection",__ssrInlineRender:!0,setup(e){const i=O(),r=F(),o=t(null),d=t(null);n("chartsCrosshairX",d),n("chartsContainerEl",o);const c=[{value:"1h",label:"1H",hours:1},{value:"4h",label:"4H",hours:4},{value:"6h",label:"6H",hours:6},{value:"12h",label:"12H",hours:12},{value:"24h",label:"24H",hours:24},{value:"48h",label:"48H",hours:48},{value:"7d",label:"7D",hours:168},{value:"30d",label:"30D",hours:720},{value:"60d",label:"60D",hours:1440},{value:"90d",label:"90D",hours:2160}],u=t({oldestTimestamp:null}),v=t(!1),$=t(""),S=t(""),j=t(!1),C=a(()=>{if(!u.value.oldestTimestamp)return c.slice(0,5);const e=new Date(u.value.oldestTimestamp).getTime(),t=(Date.now()-e)/36e5;return c.filter(e=>e.hours<=t+1)}),M=a(()=>i.history.map(e=>({timestamp:e.timestamp,value:e.temp}))),_=a(()=>i.history.map(e=>({timestamp:e.timestamp,value:e.humi}))),T=a(()=>i.history.map(e=>({timestamp:e.timestamp,value:e.co2}))),L=a(()=>i.history.map(e=>({timestamp:e.timestamp,value:e.vpd}))),A=a(()=>i.blowerHistory),E={min:0,max:100,ticks:{callback:e=>`${e}%`}},H=a(()=>i.fanHistory),P={min:0,max:10,ticks:{stepSize:1}},N={ticks:{callback:e=>e.toFixed(1)}},W=a(()=>i.soilSensors.map((e,t)=>({id:e.id,label:e.name||`Sensor ${t+1}`})));function I(e){return(i.soilSensorsHistory[e]||[]).map(e=>({timestamp:e.timestamp,value:e.temp_soil}))}function q(e){return(i.soilSensorsHistory[e]||[]).map(e=>({timestamp:e.timestamp,value:e.humi_soil}))}function Q(e){return(i.soilSensorsHistory[e]||[]).map(e=>({timestamp:e.timestamp,value:e.ec_soil}))}const Y=a(()=>{const e=i.history;return e&&0!==e.length?{start:e[0].timestamp,end:e[e.length-1].timestamp}:{start:void 0,end:void 0}}),Z=a(()=>{const e=i.history;return e&&0!==e.length?{min:new Date(e[0].timestamp).getTime(),max:new Date(e[e.length-1].timestamp).getTime()}:{min:void 0,max:void 0}});return(e,t,a,n)=>{var o;const c=Ce,u=Te;t(`<div${p(s({class:"rounded-2xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 relative"},n))}><div class="flex items-center justify-between p-4 pb-3 border-b border-gray-700/50 relative overflow-hidden"><div class="absolute -top-6 -left-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-spider-green-500/30"></div><h2 class="text-base font-semibold text-white flex items-center gap-2 shrink-0"><div class="w-7 h-7 rounded-lg bg-gradient-to-br from-spider-green-500/30 to-emerald-600/20 flex items-center justify-center">`),t(x(l(B),{class:"w-4 h-4 text-spider-green-400"},null,a)),t('</div><span>Charts</span></h2><div class="flex gap-1 flex-wrap justify-end ml-2">\x3c!--[--\x3e'),f(l(C),e=>{t(`<button class="${b([l(i).selectedRange===e.value?"bg-gradient-to-r from-spider-green-500 to-spider-green-600 text-white shadow-lg shadow-spider-green-500/30":"bg-gray-800/60 text-gray-400 hover:bg-gray-700/60 hover:text-gray-300","px-2.5 py-1.5 rounded-lg text-xs font-medium transition-all"])}">${m(e.label)}</button>`)}),t(`\x3c!--]--\x3e<button class="${b([l(j)?"bg-gradient-to-r from-spider-green-500 to-spider-green-600 text-white shadow-lg shadow-spider-green-500/30":"bg-gray-800/60 text-gray-400 hover:bg-gray-700/60 hover:text-gray-300","px-2 py-1.5 rounded-lg text-xs transition-all"])}">`),t(x(l(z),{class:"w-3.5 h-3.5"},null,a)),t("</button></div></div>"),l(v)?t(`<div class="px-4 py-3 border-b border-gray-700/50 bg-gray-800/30"><div class="flex flex-col sm:flex-row gap-3 sm:items-center"><div class="flex items-center gap-2 flex-1 min-w-0"><label class="text-xs text-gray-400 shrink-0 font-medium">From:</label><input type="datetime-local"${h("value",l($))} class="flex-1 min-w-0 bg-gray-900/60 border border-gray-600/50 rounded-lg px-3 py-2 text-xs text-gray-300 focus:border-spider-green-500/50 focus:outline-none"></div><div class="flex items-center gap-2 flex-1 min-w-0"><label class="text-xs text-gray-400 shrink-0 font-medium">To:</label><input type="datetime-local"${h("value",l(S))} class="flex-1 min-w-0 bg-gray-900/60 border border-gray-600/50 rounded-lg px-3 py-2 text-xs text-gray-300 focus:border-spider-green-500/50 focus:outline-none"></div><button class="px-4 py-2 bg-gradient-to-r from-spider-green-500 to-spider-green-600 text-white rounded-lg text-xs font-semibold hover:from-spider-green-400 hover:to-spider-green-500 shadow-lg shadow-spider-green-500/20 transition-all shrink-0"> Apply </button></div></div>`):t("\x3c!----\x3e"),t('<div class="lg:sticky lg:-top-6 z-20 bg-gradient-to-b from-gray-800/95 to-gray-900/95 px-4 py-3 border-b border-gray-700/50 shadow-lg shadow-gray-900/50">'),t(x(c,{events:l(r).events,"sync-range-start":l(Y).start,"sync-range-end":l(Y).end},null,a)),t(`</div><div class="px-4 py-4 space-y-4 relative"><div class="${b([null!==l(d)?"opacity-100":"opacity-0","absolute top-0 bottom-0 w-px bg-spider-green-400/50 pointer-events-none z-10"])}" style="${g({left:(null!=(o=l(d))?o:0)+"px"})}"></div>`),l(A).length>0?t(x(u,{title:"Blower Power Level",icon:l(G),"icon-color":"text-cyan-400",data:l(A),color:"#06b6d4","y-options":E,"empty-message":"No blower data available","y-axis-width":"50px",stepped:"after","time-min":l(Z).min,"time-max":l(Z).max},null,a)):t("\x3c!----\x3e"),l(H).length>0?t(x(u,{title:"Fan Gear Level",icon:l(G),"icon-color":"text-teal-400",data:l(H),color:"#14b8a6","y-options":P,"empty-message":"No fan data available","y-axis-width":"50px",stepped:"after","time-min":l(Z).min,"time-max":l(Z).max},null,a)):t("\x3c!----\x3e"),t(x(u,{title:"Temperature",icon:l(U),"icon-color":"text-green-400",data:l(M),color:"#22c55e","empty-message":"No data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a)),t(x(u,{title:"Humidity",icon:l(X),"icon-color":"text-blue-400",data:l(_),color:"#3b82f6","empty-message":"No data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a)),t(x(u,{title:"VPD (Vapor Pressure Deficit)",icon:l(J),"icon-color":"text-purple-400",data:l(L),color:"#a855f7","y-options":N,"empty-message":"No data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a)),t("\x3c!--[--\x3e"),f(l(W),e=>{t(x(u,{key:`temp-${e.id}`,title:`Soil Temperature - ${e.label}`,icon:l(U),"icon-color":"text-orange-400",data:I(e.id),color:"#f97316","empty-message":"No soil data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a))}),t("\x3c!--]--\x3e\x3c!--[--\x3e"),f(l(W),e=>{t(x(u,{key:`moisture-${e.id}`,title:`Soil Moisture - ${e.label}`,icon:l(X),"icon-color":"text-yellow-400",data:q(e.id),color:"#eab308","empty-message":"No soil data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a))}),t("\x3c!--]--\x3e\x3c!--[--\x3e"),f(l(W),e=>{t(x(u,{key:`ec-${e.id}`,title:`Soil EC - ${e.label}`,icon:l(R),"icon-color":"text-cyan-400",data:Q(e.id),color:"#06b6d4","empty-message":"No soil data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a))}),t("\x3c!--]--\x3e"),l(i).hasCo2Sensor?t(x(u,{title:"CO2",icon:l(K),"icon-color":"text-amber-400",data:l(T),color:"#f59e0b","empty-message":"No data available","y-axis-width":"50px","time-min":l(Z).min,"time-max":l(Z).max},null,a)):t("\x3c!----\x3e"),t("</div></div>")}}}),Oe=De.setup;De.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("components/ChartsSection.vue"),Oe?Oe(e,t):void 0};const Fe=Object.assign(De,{__name:"ChartsSection"}),Le=e({__name:"index",__ssrInlineRender:!0,setup(e){const n=O(),i=F(),r=L(),o=A();N();const{getSocketDisplayName:d}=P(),c=t(!0),u=t(!1),v=a(()=>u.value?i.log:i.log.slice(0,8));a(()=>{var e,t,a;const s=r.configs.light;if(!(null==(e=null==s?void 0:s.timePeriod)?void 0:e.length))return null;const l=s.timePeriod.find(e=>e.enabled);if(!l)return null;const n=new Date,i=3600*n.getHours()+60*n.getMinutes()+n.getSeconds(),o=null!=(t=l.startTime)?t:0,d=null!=(a=l.endTime)?a:0,c=o<=d?i>=o&&i<d:i>=o||i<d,u=new Date(n);u.setHours(0,0,0,0);const v=864e5;if(c){let e;e=i>=o?new Date(u.getTime()+1e3*o):new Date(u.getTime()-v+1e3*o);const t=e;let a;return a=o<=d||i>=o?new Date(u.getTime()-v+1e3*d):new Date(u.getTime()-2*v+1e3*d),{dayStart:e,dayEnd:null,nightStart:a,nightEnd:t,isCurrentlyDay:!0}}{let e;e=i>=d?new Date(u.getTime()+1e3*d):new Date(u.getTime()-v+1e3*d);const t=e;let a;return a=o<=d&&i>=d?new Date(u.getTime()+1e3*o):new Date(u.getTime()-v+1e3*o),{dayStart:a,dayEnd:t,nightStart:e,nightEnd:null,isCurrentlyDay:!1}}});const h=t(null),$=t(null),S=t(null);const j=a(()=>{var e,t,a,s;const l=null==(e=h.value)?void 0:e.temp;return l?{min:`${(null==(t=l.min)?void 0:t.toFixed(1))||"--"}Â°`,avg:`${(null==(a=l.avg)?void 0:a.toFixed(1))||"--"}Â°`,max:`${(null==(s=l.max)?void 0:s.toFixed(1))||"--"}Â°`}:null}),C=a(()=>{var e,t,a,s;const l=null==(e=h.value)?void 0:e.humi;return l?{min:`${(null==(t=l.min)?void 0:t.toFixed(1))||"--"}%`,avg:`${(null==(a=l.avg)?void 0:a.toFixed(1))||"--"}%`,max:`${(null==(s=l.max)?void 0:s.toFixed(1))||"--"}%`}:null}),M=a(()=>{var e,t,a,s;const l=null==(e=h.value)?void 0:e.vpd;return l?{min:(null==(t=l.min)?void 0:t.toFixed(2))||"--",avg:(null==(a=l.avg)?void 0:a.toFixed(2))||"--",max:(null==(s=l.max)?void 0:s.toFixed(2))||"--"}:null}),_=a(()=>{var e,t,a,s;const l=null==(e=$.value)?void 0:e.temp;return l?{min:`${(null==(t=l.min)?void 0:t.toFixed(1))||"--"}Â°`,avg:`${(null==(a=l.avg)?void 0:a.toFixed(1))||"--"}Â°`,max:`${(null==(s=l.max)?void 0:s.toFixed(1))||"--"}Â°`}:null}),T=a(()=>{var e,t,a,s;const l=null==(e=$.value)?void 0:e.humi;return l?{min:`${(null==(t=l.min)?void 0:t.toFixed(1))||"--"}%`,avg:`${(null==(a=l.avg)?void 0:a.toFixed(1))||"--"}%`,max:`${(null==(s=l.max)?void 0:s.toFixed(1))||"--"}%`}:null}),B=a(()=>{var e,t,a,s;const l=null==(e=$.value)?void 0:e.vpd;return l?{min:(null==(t=l.min)?void 0:t.toFixed(2))||"--",avg:(null==(a=l.avg)?void 0:a.toFixed(2))||"--",max:(null==(s=l.max)?void 0:s.toFixed(2))||"--"}:null});function V(e){return.6108*Math.exp(17.27*e/(e+237.3))}const z=a(()=>{var e,t;const a=null==(e=n.current)?void 0:e.temp,s=null==(t=n.current)?void 0:t.humi;if(null==a||null==s)return null;return V(a-2.8)-V(a)*(s/100)}),G=a(()=>{const e=z.value;if(null!==e)return e<.4?"low":e<.8?"warn-low":e<=1.2?"optimal":e<=1.6?"warn-high":"high"});function I(e,t){return V(e-2.8)-V(e)*(t/100)}const U=a(()=>{var e,t;const a=null==(e=h.value)?void 0:e.temp,s=null==(t=h.value)?void 0:t.humi;if(!a||!s)return null;const l=void 0!==a.min&&void 0!==s.max?I(a.min,s.max):null,n=void 0!==a.avg&&void 0!==s.avg?I(a.avg,s.avg):null,i=void 0!==a.max&&void 0!==s.min?I(a.max,s.min):null;return{min:(null==l?void 0:l.toFixed(2))||"--",avg:(null==n?void 0:n.toFixed(2))||"--",max:(null==i?void 0:i.toFixed(2))||"--"}}),X=a(()=>{var e,t;const a=null==(e=$.value)?void 0:e.temp,s=null==(t=$.value)?void 0:t.humi;if(!a||!s)return null;const l=void 0!==a.min&&void 0!==s.max?I(a.min,s.max):null,n=void 0!==a.avg&&void 0!==s.avg?I(a.avg,s.avg):null,i=void 0!==a.max&&void 0!==s.min?I(a.max,s.min):null;return{min:(null==l?void 0:l.toFixed(2))||"--",avg:(null==n?void 0:n.toFixed(2))||"--",max:(null==i?void 0:i.toFixed(2))||"--"}});a(()=>{const e=o.modeType;return e===E?"Trigger":H(e)?"Environment":0===e?"Manual":1===e?"Time Slot":2===e?"Cycle":`Mode ${e}`});const J=a(()=>o.on?Math.round(62*o.level/100):0),K=a(()=>{const e=Object.entries(i.states);return e.sort((e,t)=>parseInt(e[0].replace("O",""))-parseInt(t[0].replace("O",""))),Object.fromEntries(e)}),Y=a(()=>n.soilSensors.length),Z=a(()=>{const e={};for(const[t,a]of Object.entries(r.states))"light"===t&&i.isLight1Disabled||"light2"===t&&i.isLight2Disabled||(e[t]=a);return e});return(e,t,a,h)=>{var $,O,F,L,A,E,H,P,N,ee,te,ae,se,le;const ne=ue,ie=xe,re=be,oe=he,de=ke,ce=Fe;t(`<div${p(s({class:"space-y-4 sm:space-y-5 lg:space-y-6 p-2 sm:p-4"},h))} data-v-48a21929><div class="grid grid-cols-12 gap-2 sm:gap-4 lg:gap-5" data-v-48a21929>`),l(Y)<3?(t('<div class="col-span-12 lg:col-span-4 flex flex-col gap-2 lg:gap-0 lg:justify-between" data-v-48a21929>'),t(x(ne,{title:"Temperature",value:null==($=l(n).current)?void 0:$.temp,unit:"C",status:l(n).temperatureStatus,"day-stats":l(j),"night-stats":l(_)},null,a)),t(x(ne,{title:"Humidity",value:null==(O=l(n).current)?void 0:O.humi,unit:"%",status:l(n).humidityStatus,"day-stats":l(C),"night-stats":l(T)},null,a)),t(x(ne,{title:"Air VPD",value:null==(F=l(n).current)?void 0:F.vpd,unit:"kPa",status:l(n).vpdStatus,decimals:2,"day-stats":l(M),"night-stats":l(B)},null,a)),t(x(ne,{title:"Leaf VPD",value:l(z),unit:"kPa",status:l(G),decimals:2,"day-stats":l(U),"night-stats":l(X)},null,a)),(null==(L=l(S))?void 0:L.enabled)&&l(S).targetMin>0?(t(`<div class="p-2.5 rounded-xl bg-gradient-to-br from-teal-900/40 to-gray-900/40 border border-teal-500/30 backdrop-blur-md" data-v-48a21929><div class="flex items-center justify-between mb-1.5" data-v-48a21929><span class="text-[9px] text-teal-400 font-semibold uppercase tracking-wider" data-v-48a21929>VPD Control</span><span class="text-[9px] text-gray-500 font-medium" data-v-48a21929>${m(l(S).targetMin)}-${m(l(S).targetMax)} kPa</span></div><div class="h-2 bg-gray-800/60 rounded-full relative overflow-hidden" data-v-48a21929><div class="absolute h-full bg-gradient-to-r from-teal-600/60 to-teal-500/40 rounded-full" style="${g({left:l(S).targetMin/2.5*100+"%",width:(l(S).targetMax-l(S).targetMin)/2.5*100+"%"})}" data-v-48a21929></div>`),(null==(A=l(n).current)?void 0:A.vpd)?t(`<div class="${b([l(n).current.vpd>=l(S).targetMin&&l(n).current.vpd<=l(S).targetMax?"bg-teal-400 shadow-teal-400/50":"bg-red-400 shadow-red-400/50","absolute h-full w-1.5 rounded-full -translate-x-1/2 shadow-lg"])}" style="${g({left:`${Math.min(l(n).current.vpd/2.5*100,100)}%`})}" data-v-48a21929></div>`):t("\x3c!----\x3e"),t(`</div><div class="flex items-center justify-between mt-1.5" data-v-48a21929><span class="text-[8px] text-gray-500 font-medium" data-v-48a21929>${m("grow_phase"===l(S).mode&&l(S).phase?l(S).phase:"manual")}</span><span class="text-[8px] text-gray-500" data-v-48a21929>${m((null==(E=l(S).roles)?void 0:E.length)||0)} devices</span></div></div>`)):t("\x3c!----\x3e"),l(n).hasCo2Sensor?t(x(ne,{title:"CO2",value:null==(H=l(n).current)?void 0:H.co2,unit:"ppm"},null,a)):t("\x3c!----\x3e"),t(x(ie,null,null,a)),t("</div>")):(t('\x3c!--[--\x3e<div class="col-span-6 lg:col-span-2 flex flex-col gap-2 lg:gap-0 lg:justify-between" data-v-48a21929>'),t(x(ne,{title:"Temperature",value:null==(P=l(n).current)?void 0:P.temp,unit:"C",status:l(n).temperatureStatus,"day-stats":l(j),"night-stats":l(_)},null,a)),t(x(ne,{title:"Humidity",value:null==(N=l(n).current)?void 0:N.humi,unit:"%",status:l(n).humidityStatus,"day-stats":l(C),"night-stats":l(T)},null,a)),t(x(ne,{title:"Air VPD",value:null==(ee=l(n).current)?void 0:ee.vpd,unit:"kPa",status:l(n).vpdStatus,decimals:2,"day-stats":l(M),"night-stats":l(B)},null,a)),t(x(ne,{title:"Leaf VPD",value:l(z),unit:"kPa",status:l(G),decimals:2,"day-stats":l(U),"night-stats":l(X)},null,a)),(null==(te=l(S))?void 0:te.enabled)&&l(S).targetMin>0?(t(`<div class="p-2.5 rounded-xl bg-gradient-to-br from-teal-900/40 to-gray-900/40 border border-teal-500/30 backdrop-blur-md" data-v-48a21929><div class="flex items-center justify-between mb-1.5" data-v-48a21929><span class="text-[9px] text-teal-400 font-semibold uppercase tracking-wider" data-v-48a21929>VPD Control</span><span class="text-[9px] text-gray-500 font-medium" data-v-48a21929>${m(l(S).targetMin)}-${m(l(S).targetMax)} kPa</span></div><div class="h-2 bg-gray-800/60 rounded-full relative overflow-hidden" data-v-48a21929><div class="absolute h-full bg-gradient-to-r from-teal-600/60 to-teal-500/40 rounded-full" style="${g({left:l(S).targetMin/2.5*100+"%",width:(l(S).targetMax-l(S).targetMin)/2.5*100+"%"})}" data-v-48a21929></div>`),(null==(ae=l(n).current)?void 0:ae.vpd)?t(`<div class="${b([l(n).current.vpd>=l(S).targetMin&&l(n).current.vpd<=l(S).targetMax?"bg-teal-400 shadow-teal-400/50":"bg-red-400 shadow-red-400/50","absolute h-full w-1.5 rounded-full -translate-x-1/2 shadow-lg"])}" style="${g({left:`${Math.min(l(n).current.vpd/2.5*100,100)}%`})}" data-v-48a21929></div>`):t("\x3c!----\x3e"),t(`</div><div class="flex items-center justify-between mt-1.5" data-v-48a21929><span class="text-[8px] text-gray-500 font-medium" data-v-48a21929>${m("grow_phase"===l(S).mode&&l(S).phase?l(S).phase:"manual")}</span><span class="text-[8px] text-gray-500" data-v-48a21929>${m((null==(se=l(S).roles)?void 0:se.length)||0)} devices</span></div></div>`)):t("\x3c!----\x3e"),l(n).hasCo2Sensor?t(x(ne,{title:"CO2",value:null==(le=l(n).current)?void 0:le.co2,unit:"ppm"},null,a)):t("\x3c!----\x3e"),t('</div><div class="col-span-6 lg:col-span-2" data-v-48a21929>'),t(x(ie,{stacked:""},null,a)),t("</div>\x3c!--]--\x3e")),t(`<div class="${b([l(c)?"lg:col-span-6":"lg:col-span-8","col-span-12 rounded-2xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 p-3 sm:p-4 flex flex-col overflow-hidden relative"])}" data-v-48a21929><div class="absolute -top-6 -left-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-yellow-500/30" data-v-48a21929></div>`),l(c)?(t('\x3c!--[--\x3e<h2 class="text-sm font-semibold text-white mb-3 flex items-center gap-2 relative" data-v-48a21929><div class="w-7 h-7 rounded-lg bg-gradient-to-br from-yellow-500/30 to-amber-600/20 flex items-center justify-center" data-v-48a21929>'),t(x(l(R),{class:"w-4 h-4 text-yellow-400"},null,a)),t("</div> Sockets </h2>"),l(i).loading?t('<div class="text-center py-6 text-gray-500" data-v-48a21929><div class="animate-pulse" data-v-48a21929>Loading...</div></div>'):0===Object.keys(l(i).states).length?t('<div class="text-center py-6 text-gray-500" data-v-48a21929> No socket data available </div>'):(t('<div class="grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 lg:grid-cols-5 gap-2 sm:gap-3 overflow-visible" data-v-48a21929>\x3c!--[--\x3e'),f(l(K),(e,s)=>{t(x(re,{key:s,socket:parseInt(s.replace("O","")),state:e,onToggle:e=>l(i).toggleSocket(s)},null,a))}),t("\x3c!--]--\x3e</div>")),t("\x3c!--]--\x3e")):t("\x3c!----\x3e"),t(`<div class="${b([l(c)?"mt-4 border-t border-gray-700/50 pt-4":"","flex-1 min-h-0 flex gap-4"])}" data-v-48a21929><div class="flex-1 min-w-0 flex flex-col gap-3" data-v-48a21929><h3 class="text-xs text-gray-400 flex items-center gap-2 font-medium" data-v-48a21929><div class="w-7 h-7 rounded-lg bg-gradient-to-br from-yellow-500/30 to-amber-600/20 flex items-center justify-center" data-v-48a21929>`),t(x(l(W),{class:"w-4 h-4 text-yellow-400"},null,a)),t("</div> Lights </h3>"),l(r).loading?t('<div class="text-center py-3 text-gray-500 text-xs" data-v-48a21929> Loading... </div>'):0===Object.keys(l(r).states).length?t('<div class="text-center py-3 text-gray-500 text-xs" data-v-48a21929> No light data </div>'):(t('<div class="flex gap-3 flex-wrap" data-v-48a21929>\x3c!--[--\x3e'),f(l(Z),(e,s)=>{t(x(oe,{key:s,title:"light"===s?"Light 1":"Light 2","light-id":s,state:e,class:"flex-1 min-w-[140px]",onToggle:e=>l(r).toggleLight(s)},null,a))}),t("\x3c!--]--\x3e</div>")),l(o).loaded?(t('<div class="relative p-3 rounded-xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 overflow-hidden" data-v-48a21929>'),l(o).on?t('<div class="absolute -top-8 -left-8 w-32 h-32 rounded-full blur-3xl pointer-events-none bg-cyan-500/20" data-v-48a21929></div>'):t("\x3c!----\x3e"),t(`<div class="relative flex items-center gap-4" data-v-48a21929><div class="relative w-14 h-14 rounded-xl bg-gradient-to-br from-cyan-500/20 to-blue-600/10 flex items-center justify-center shrink-0" data-v-48a21929><svg class="${b([l(o).on?"text-cyan-400 blower-spin":"text-gray-500","w-10 h-10 transition-all duration-300"])}" viewBox="0 0 512 512" fill="currentColor" data-v-48a21929><path d="M258.6 0c-1.7 0-3.4 .1-5.1 .5C168 17 115.6 102.3 130.5 189.3c2.9 17 8.4 32.9 15.9 47.4L32 224H29.4C13.2 224 0 237.2 0 253.4c0 1.7 .1 3.4 .5 5.1C17 344 102.3 396.4 189.3 381.5c17-2.9 32.9-8.4 47.4-15.9L224 480v2.6c0 16.2 13.2 29.4 29.4 29.4c1.7 0 3.4-.1 5.1-.5C344 495 396.4 409.7 381.5 322.7c-2.9-17-8.4-32.9-15.9-47.4L480 288h2.6c16.2 0 29.4-13.2 29.4-29.4c0-1.7-.1-3.4-.5-5.1C495 168 409.7 115.6 322.7 130.5c-17 2.9-32.9 8.4-47.4 15.9L288 32V29.4C288 13.2 274.8 0 258.6 0zM256 224a32 32 0 1 1 0 64 32 32 0 1 1 0-64z" data-v-48a21929></path></svg></div><div class="flex-1 min-w-0" data-v-48a21929><div class="flex items-center gap-2 mb-1.5" data-v-48a21929><span class="text-sm font-semibold text-white" data-v-48a21929>Blower</span><span class="${b([l(o).on?"bg-cyan-500/20 text-cyan-400":"bg-gray-700/50 text-gray-500","px-1.5 py-0.5 rounded text-[9px] font-bold uppercase tracking-wide"])}" data-v-48a21929>${m(l(o).on?"ON":"OFF")}</span>`),l(o).on&&l(o).closeCO2?t('<span class="text-[9px] text-amber-400 font-medium" data-v-48a21929> CO2 Closed </span>'):t("\x3c!----\x3e"),t(`<span class="${b([l(o).on?"text-yellow-400":"text-gray-600","ml-auto text-sm font-semibold"])}" data-v-48a21929>${m(l(J))}W </span></div><div class="flex items-center gap-3" data-v-48a21929><div class="flex-1 h-2 bg-gray-700/60 rounded-full overflow-hidden" data-v-48a21929><div class="${b([l(o).on?"bg-gradient-to-r from-cyan-500 to-cyan-400":"bg-gray-600","h-full rounded-full transition-all duration-500"])}" style="${g({width:`${l(o).on?l(o).level:0}%`})}" data-v-48a21929></div></div><span class="${b([l(o).on?"text-cyan-400":"text-gray-500","text-sm font-bold w-12 text-right"])}" data-v-48a21929>${m(l(o).on?`${l(o).level}%`:"0%")}</span></div></div></div></div>`)):t("\x3c!----\x3e"),t('</div><div class="flex-1 min-w-0 hidden sm:block" data-v-48a21929>'),t(x(de,null,null,a)),t("</div></div></div>"),l(c)?(t('<div class="col-span-12 lg:col-span-2 lg:relative" data-v-48a21929><div class="rounded-2xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 p-3 sm:p-4 flex flex-col lg:absolute lg:inset-0 overflow-hidden relative" data-v-48a21929><div class="absolute -top-6 -left-6 w-24 h-24 rounded-full blur-2xl pointer-events-none bg-purple-500/30" data-v-48a21929></div><h2 class="text-sm font-semibold text-white mb-3 flex items-center gap-2 relative" data-v-48a21929><div class="w-6 h-6 rounded-lg bg-gradient-to-br from-purple-500/30 to-indigo-600/20 flex items-center justify-center" data-v-48a21929><svg class="w-3 h-3 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-48a21929><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-v-48a21929></path></svg></div> Event Log </h2><div class="flex-1 min-h-0 flex flex-col" data-v-48a21929>'),0===l(i).log.length?t('<div class="text-gray-600 text-center py-6" data-v-48a21929><div class="w-10 h-10 mx-auto mb-2 rounded-xl bg-gray-800/50 flex items-center justify-center" data-v-48a21929><svg class="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-48a21929><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" data-v-48a21929></path></svg></div><p class="text-xs" data-v-48a21929>No events</p></div>'):t("\x3c!----\x3e"),t(`<div class="${b([l(u)?"flex-1 overflow-y-auto scrollbar-thin":"","space-y-1 text-[10px] sm:text-[11px]"])}" data-v-48a21929>\x3c!--[--\x3e`),f(l(v),(e,a)=>{t(`<div class="py-1.5 rounded-lg hover:bg-gray-800/40 transition-colors" data-v-48a21929><div class="flex items-center gap-2" data-v-48a21929><span class="${b(["on"===e.action?"text-spider-green-400 bg-spider-green-400/10":"text-red-400 bg-red-400/10","shrink-0 px-1.5 py-0.5 rounded text-[9px] font-bold uppercase"])}" data-v-48a21929>${m("on"===e.action?"ON":"OFF")}</span><span class="text-gray-300 truncate font-medium" data-v-48a21929>${m(l(d)(e.socket,"short"))}</span><span class="text-gray-600 shrink-0 ml-auto" data-v-48a21929>${m(function(e){return new Date(e).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}(e.timestamp))}</span></div>`),"trigger"===e.source?t(`<div class="mt-0.5 ml-9" data-v-48a21929><span class="text-purple-400 truncate text-[9px] font-medium" data-v-48a21929>${m(e.flowName||"trigger")}</span></div>`):t("\x3c!----\x3e"),t("</div>")}),t("\x3c!--]--\x3e</div>"),l(i).log.length>8&&!l(u)?t(`<button class="mt-2 text-[10px] text-gray-500 hover:text-purple-400 transition-colors text-center py-1" data-v-48a21929> Ver mÃ¡s (${m(l(i).log.length-8)} eventos) </button>`):t("\x3c!----\x3e"),l(u)&&l(i).log.length>8?t('<button class="mt-2 text-[10px] text-gray-500 hover:text-purple-400 transition-colors text-center py-1 shrink-0" data-v-48a21929> Ver menos </button>'):t("\x3c!----\x3e"),t("</div></div></div>")):t("\x3c!----\x3e"),t('<div class="col-span-12 sm:hidden" data-v-48a21929><div class="rounded-2xl bg-gradient-to-br from-gray-800/60 to-gray-900/60 backdrop-blur-md border border-gray-700/50 p-3" data-v-48a21929>'),t(x(de,null,null,a)),t("</div></div></div>"),t(x(ce,null,null,a)),t("</div>")}}}),Ae=Le.setup;Le.setup=(e,t)=>{const a=v();return(a.modules||(a.modules=new Set)).add("pages/index.vue"),Ae?Ae(e,t):void 0};const Ie=oe(Le,[["__scopeId","data-v-48a21929"]]);export{Ie as default};
