import{d as t,g as o,c as e,b as r,n as s,i}from"../../nitro/nitro.mjs";import{createReadStream as n}from"fs";import{stat as p}from"fs/promises";import{join as m,extname as a}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:url";const f={".woff2":"font/woff2",".woff":"font/woff",".ttf":"font/ttf",".otf":"font/otf"},d=t(async t=>{const d=o(t,"path")||"",c=decodeURIComponent(d);if(!c||c.includes("..")||c.includes("\\"))throw e({statusCode:400,message:"Invalid path"});const u=m(r(),"data","room3d","fonts",c);let h;try{h=await p(u)}catch{throw e({statusCode:404,message:"Not found"})}if(!h.isFile())throw e({statusCode:404,message:"Not found"});const l=a(u).toLowerCase();return s(t,"Content-Type",f[l]||"application/octet-stream"),s(t,"Cache-Control","public, max-age=31536000, immutable"),s(t,"Content-Length",h.size),i(t,n(u))});export{d as default};
