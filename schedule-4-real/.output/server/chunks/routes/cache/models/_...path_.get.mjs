import{d as t,g as o,c as e,b as r,n as s,i}from"../../../nitro/nitro.mjs";import{createReadStream as p}from"fs";import{stat as m}from"fs/promises";import{join as n}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:url";const a=t(async t=>{const a=o(t,"path")||"",d=decodeURIComponent(a);if(!d||d.includes("..")||d.includes("\\")||!d.endsWith(".jpg"))throw e({statusCode:400,message:"Invalid path"});const c=n(r(),"data","cache","models",d);let f;try{f=await m(c)}catch{throw e({statusCode:404,message:"Not found"})}if(!f.isFile())throw e({statusCode:404,message:"Not found"});return s(t,"Content-Type","image/jpeg"),s(t,"Cache-Control","public, max-age=86400"),s(t,"Content-Length",f.size),i(t,p(c))});export{a as default};
