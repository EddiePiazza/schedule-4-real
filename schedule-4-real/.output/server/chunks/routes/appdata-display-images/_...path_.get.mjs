import{d as t,g as o,c as e,b as i,n as p,i as m}from"../../nitro/nitro.mjs";import{createReadStream as r}from"fs";import{stat as s}from"fs/promises";import{join as a,extname as n}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:url";const d={".jpg":"image/jpeg",".jpeg":"image/jpeg",".png":"image/png",".gif":"image/gif",".webp":"image/webp",".svg":"image/svg+xml",".mp4":"video/mp4",".webm":"video/webm"},g=t(async t=>{const g=o(t,"path")||"",f=decodeURIComponent(g);if(!f||f.includes("..")||f.includes("\\"))throw e({statusCode:400,message:"Invalid path"});const c=a(i(),"data","appdata","display-images",f);let l;try{l=await s(c)}catch{throw e({statusCode:404,message:"Not found"})}if(!l.isFile())throw e({statusCode:404,message:"Not found"});const u=n(c).toLowerCase();return p(t,"Content-Type",d[u]||"application/octet-stream"),p(t,"Cache-Control","public, max-age=31536000, immutable"),p(t,"Content-Length",l.size),m(t,r(c))});export{g as default};
