import{d as t,g as o,c as e}from"../../../../nitro/nitro.mjs";import{query as r}from"../../../../_/db.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const i=t(async t=>{const i=o(t,"id");if(!i)throw e({statusCode:400,message:"Flow ID is required"});try{const t=await r("\n      SELECT id, name, description, enabled, flow_json, created_at, updated_at\n      FROM automation_flows\n      WHERE id = $1\n      LIMIT 1\n    ",[i]);if(0===t.length)throw e({statusCode:404,message:"Flow not found"});const o=t[0];return{id:o.id,name:o.name,description:o.description,enabled:1===o.enabled,flow:o.flow_json?JSON.parse(o.flow_json):{nodes:[],connections:[]},createdAt:o.created_at,updatedAt:o.updated_at}}catch(t){if(t.statusCode)throw t;throw console.error("Failed to fetch flow:",t),e({statusCode:500,message:"Failed to fetch flow"})}});export{i as default};
