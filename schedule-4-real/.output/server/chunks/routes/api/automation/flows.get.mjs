import{d as t,c as o}from"../../../nitro/nitro.mjs";import{query as e}from"../../../_/db.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const r=t(async()=>{var t;try{const t=await e("\n      SELECT id, name, description, enabled, flow_json, created_at, updated_at\n      FROM automation_flows\n      ORDER BY updated_at DESC\n    "),o=new Set;return t.filter(t=>!o.has(t.id)&&(o.add(t.id),!0)).map(t=>({id:t.id,name:t.name,description:t.description,enabled:1===t.enabled,flow:t.flow_json?JSON.parse(t.flow_json):{nodes:[],connections:[]},createdAt:t.created_at,updatedAt:t.updated_at}))}catch(e){if(null==(t=e.message)?void 0:t.includes("does not exist"))return[];throw console.error("Failed to fetch automation flows:",e),o({statusCode:500,message:"Failed to fetch automation flows"})}});export{r as default};
