import{d as t,r as o,c as r}from"../../nitro/nitro.mjs";import{query as s}from"../../_/db.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const e=t(async t=>{const e=await o(t),{sensorId:n,name:p,plantId:m,sensorType:i="soil"}=e;if(!n)throw r({statusCode:400,message:"sensorId is required"});try{const t=(new Date).toISOString(),o=(p||"").replace(/'/g,"''"),r=m?`'${m}'`:"null";return await s(`\n      INSERT INTO sensor_names (timestamp, sensor_id, sensor_type, name, plant_id)\n      VALUES ('${t}', '${n}', '${i}', '${o}', ${r})\n    `),{success:!0,sensorId:n,name:p||"",plantId:m||null}}catch(t){throw console.error("Error saving sensor name:",t.message),r({statusCode:500,message:"Failed to save sensor name"})}});export{e as default};
