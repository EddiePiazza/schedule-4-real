import{d as t,r as o,c as i}from"../../../nitro/nitro.mjs";import{query as r,sanitizeString as n,sanitizeInt as e}from"../../../_/db.mjs";import{v4 as s}from"uuid";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const m=t(async t=>{const m=await o(t);if(!m.name)throw i({statusCode:400,message:"Room name is required"});const a=m.id||s();try{const t=1e3*Date.now();return await r(`\n      INSERT INTO lab_grow_rooms (\n        timestamp, id, name, description, room_type, dimensions_cm,\n        cover_color, icon, layout_data, device_macs, light_ids,\n        outlet_ids, sensor_ids, active_plant_ids, environment_profile,\n        status, sort_order, is_deleted\n      ) VALUES (\n        ${t},\n        '${a}',\n        '${n(m.name)}',\n        ${m.description?`'${n(m.description)}'`:"NULL"},\n        '${n(m.room_type||"tent")}',\n        ${m.dimensions_cm?`'${n(JSON.stringify(m.dimensions_cm))}'`:"NULL"},\n        ${m.cover_color?`'${n(m.cover_color)}'`:"'#06b6d4'"},\n        ${m.icon?`'${n(m.icon)}'`:"NULL"},\n        ${m.layout_data?`'${n(JSON.stringify(m.layout_data))}'`:"NULL"},\n        '${n(JSON.stringify(m.device_macs||[]))}',\n        '${n(JSON.stringify(m.light_ids||[]))}',\n        '${n(JSON.stringify(m.outlet_ids||[]))}',\n        '${n(JSON.stringify(m.sensor_ids||[]))}',\n        '${n(JSON.stringify(m.active_plant_ids||[]))}',\n        ${m.environment_profile?`'${n(JSON.stringify(m.environment_profile))}'`:"NULL"},\n        '${n(m.status||"active")}',\n        ${void 0!==m.sort_order?e(m.sort_order):0},\n        0\n      )\n    `),{success:!0,id:a,name:m.name}}catch(t){throw console.error("Failed to create room:",t),i({statusCode:500,message:"Failed to create room"})}});export{m as default};
