import{d as t,c as r}from"../../../nitro/nitro.mjs";import{g as o,c as e,j as a,s as i}from"../../../_/mqtt.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"mqtt";import"child_process";const n=t(async()=>{var t,n,d,m,l,p,s,u,g,h,c,v,f,y;try{const r=o();let b=(null==(n=null==(t=e(r))?void 0:t.data)?void 0:n.target)||null;if(!b)try{if(!(await a()).macs[r])return null;const t=await i({method:"getConfigField",params:{keyPath:["target"]}},r,8e3);b=(null==(d=null==t?void 0:t.data)?void 0:d.target)||null}catch{}if(!b)return null;const formatTime=t=>{if(null==t)return"";const r=Math.floor(t/3600),o=Math.floor(t%3600/60);return`${r.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`};return{dayTime:{startTime:formatTime(null==(m=b.dayTime)?void 0:m.startTime),endTime:formatTime(null==(l=b.dayTime)?void 0:l.endTime)},temp:{targetDay:null==(p=b.temp)?void 0:p.targetDay,targetNight:null==(s=b.temp)?void 0:s.targetNight,deadband:null==(u=b.temp)?void 0:u.deadband},humi:{targetDay:null==(g=b.humi)?void 0:g.targetDay,targetNight:null==(h=b.humi)?void 0:h.targetNight,deadband:null==(c=b.humi)?void 0:c.deadband},co2:{targetDay:null==(v=b.co2)?void 0:v.targetDay,targetNight:null==(f=b.co2)?void 0:f.targetNight,deadband:null==(y=b.co2)?void 0:y.deadband}}}catch(t){throw console.error("Failed to fetch environment targets:",t),r({statusCode:500,message:"Failed to fetch environment targets from device"})}});export{n as default};
