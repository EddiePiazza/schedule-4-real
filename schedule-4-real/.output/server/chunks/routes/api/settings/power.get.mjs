import{d as t,c as o}from"../../../nitro/nitro.mjs";import{query as s}from"../../../_/db.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const e=t(async()=>{var t;try{const t=await s("\n      SELECT socket, watts, cost_per_kwh\n      FROM socket_wattage\n      ORDER BY timestamp DESC\n      LIMIT 7\n    "),o={},e={},r=new Set;for(const s of t)if(!r.has(s.socket)){r.add(s.socket);const t={watts:s.watts,costPerKwh:s.cost_per_kwh};s.socket.startsWith("light")?e[s.socket]=t:o[s.socket]=t}return{sockets:o,lights:e}}catch(s){if(null==(t=s.message)?void 0:t.includes("does not exist"))return{sockets:{},lights:{}};throw console.error("Failed to fetch power settings:",s),o({statusCode:500,message:"Failed to fetch power settings"})}});export{e as default};
