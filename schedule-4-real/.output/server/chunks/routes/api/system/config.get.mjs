import{d as t,e as o,b as T,c as r}from"../../../nitro/nitro.mjs";import{readFileSync as i}from"fs";import{resolve as e}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs/promises";import"node:url";const s=["MQTT_HOST","MQTT_PORT","MQTT_LAN_PORT","PROXY_PORT","RELAY_PORT","QUESTDB_HOST","QUESTDB_PG_PORT","QUESTDB_HTTP_PORT","QUESTDB_ILP_PORT","DATA_RETENTION_DAYS","API_PORT","WS_PORT","APP_PASSWORD","APP_DOMAIN","RELAY_DOMAIN"],P=["API_PORT","WS_PORT","MQTT_PORT","MQTT_LAN_PORT","PROXY_PORT","RELAY_PORT","MQTT_HOST","QUESTDB_HOST","QUESTDB_PG_PORT","QUESTDB_HTTP_PORT","QUESTDB_ILP_PORT"],_=t(async t=>{const _=process.env.APP_PASSWORD||"",n=o(t,"x-auth-token")||"",p=!_||n===_;try{const t=e(T(),".env"),o=i(t,"utf-8"),r={};for(const t of o.split("\n")){const o=t.trim();if(!o||o.startsWith("#"))continue;const T=o.indexOf("=");if(-1===T)continue;const i=o.slice(0,T).trim(),e=o.slice(T+1).trim();if(s.includes(i))if("APP_PASSWORD"===i)r[i]=e?"••••••••":"";else{if(!p&&P.includes(i))continue;r[i]=e}}return r}catch(t){throw r({statusCode:500,message:"Failed to read config: "+t.message})}});export{_ as default};
