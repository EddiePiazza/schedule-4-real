import{d as t,r as o,c as s,b as e}from"../../../nitro/nitro.mjs";import{existsSync as r,unlinkSync as i}from"fs";import{resolve as a}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs/promises";import"node:url";const m=t(async t=>{const m=await o(t),{filename:p}=m;if(!p)throw s({statusCode:400,message:"Missing filename"});if(p.includes("..")||p.includes("/"))throw s({statusCode:400,message:"Invalid filename"});if(!p.endsWith(".json")&&!p.endsWith(".json.gz"))throw s({statusCode:400,message:"Invalid backup file type"});const n=a(e(),"database/backups",p);if(!r(n))throw s({statusCode:404,message:"Backup not found"});try{return i(n),{success:!0}}catch(t){throw s({statusCode:500,message:"Failed to delete backup: "+t.message})}});export{m as default};
