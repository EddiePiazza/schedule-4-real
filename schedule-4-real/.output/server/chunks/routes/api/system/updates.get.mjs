import t from"node:process";globalThis._importMeta_=globalThis._importMeta_||{url:"file:///_entry.js",env:t.env};import{d as e,b as s}from"../../../nitro/nitro.mjs";import{readFileSync as o,existsSync as r}from"fs";import{resolve as n}from"path";import{createRequire as i}from"module";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs/promises";import"node:url";const l=i(globalThis._importMeta_.url);const a=e(async()=>{var t,e,i,a,p,m,d,u,c;const h=n(s(),"versions.local.json"),g=function(){const t=s();return r(n(t,".git"))||r(n(t,"CLAUDE.md"))||r(n(t,"package.json"))||r(n(t,"node_modules"))||r(n(t,"build-release.sh"))}();let f=!1,v=null;try{const t=function(){const t=n(s(),"src/services/update-checker.cjs");return delete l.cache[l.resolve(t)],l(t)}();f=t.isUpdateLocked(),f&&(v=t.getProgress())}catch{}try{const s=JSON.parse(o(h,"utf-8")),r=s.lastUpdate?new Date(s.lastUpdate).getTime():0,n=s.changelogDismissedAt?new Date(s.changelogDismissedAt).getTime():0,l=Array.isArray(s.updateHistory)&&s.updateHistory.length>0&&r>0&&r>n;return{autoUpdate:null!=(t=s.autoUpdate)&&t,lastCheck:null!=(e=s.lastCheck)?e:null,lastUpdate:null!=(i=s.lastUpdate)?i:null,schemaVersion:null!=(a=s.schemaVersion)?a:1,installed:null!=(p=s.components)?p:{},pending:null!=(m=s.pending)?m:[],history:(null!=(d=s.updateHistory)?d:[]).slice(0,5),manifestChangelogs:null!=(u=s.manifestChangelogs)?u:{},showChangelog:l,advertDismissed:null!=(c=s.advertDismissed)&&c,inProgress:f,updateProgress:v,isDev:g}}catch{return{autoUpdate:!1,lastCheck:null,lastUpdate:null,schemaVersion:1,installed:{},pending:[],history:[],advertDismissed:!1,inProgress:f,updateProgress:v,isDev:g}}});export{a as default};
