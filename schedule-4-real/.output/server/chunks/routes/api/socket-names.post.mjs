import{d as t,r as o,c as e}from"../../nitro/nitro.mjs";import{query as r}from"../../_/db.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";import"pg";const s=t(async t=>{const s=await o(t),{socket:m,name:i}=s;if(!m)throw e({statusCode:400,message:"Socket is required"});if(!/^O[1-5]$/.test(m))throw e({statusCode:400,message:"Invalid socket format. Must be O1-O5"});try{const t=(new Date).toISOString(),o=(i||"").replace(/'/g,"''");return await r(`\n      INSERT INTO socket_names (timestamp, socket, name)\n      VALUES ('${t}', '${m}', '${o}')\n    `),{success:!0,socket:m,name:i||""}}catch(t){throw console.error("Error saving socket name:",t.message),e({statusCode:500,message:"Failed to save socket name"})}});export{s as default};
