import{d as o,a as r}from"../../../nitro/nitro.mjs";import{existsSync as t,readdirSync as e}from"node:fs";import{join as s}from"node:path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"fs";import"path";import"fs/promises";import"node:url";const i={color:[/[_-]Color\./i,/[_-]BaseColor\./i,/[_-]COL[_.\s]/i,/[_-]Albedo\./i,/[_-]Diffuse\./i],normalGL:[/[_-]NormalGL\./i],normalDX:[/[_-]NormalDX\./i],normal:[/[_-]Normal\./i,/[_-]NRM[_.\s]/i],roughness:[/[_-]Roughness\./i,/[_-]ROUGH[_.\s]/i],glossiness:[/[_-]Gloss(iness)?[_.\s]/i,/[_-]GLOSS[_.\s]/i],metalness:[/[_-]Metalness\./i,/[_-]Metallic\./i,/[_-]REFL[_.\s]/i],ao:[/[_-]AmbientOcclusion\./i,/[_-]AO[_.\s]/i],displacement:[/[_-]Displacement\./i,/[_-]DISP[_.\s]/i,/[_-]Height\./i]},n=new Set([".jpg",".jpeg",".png",".webp",".tiff",".tif"]),l=o(o=>{const l=r(o),m=String(l.folder||"").replace(/[^a-zA-Z0-9_\-/]/g,"");if(!m)return{error:"Missing folder parameter"};const a=s(process.cwd(),"data","appdata","models","textures",m);if(!t(a))return{error:`Texture folder not found: ${m}`};let p;try{p=e(a).filter(o=>{const r=o.substring(o.lastIndexOf(".")).toLowerCase();return n.has(r)})}catch{return{error:"Failed to read texture folder"}}const f={color:null,normalGL:null,roughness:null,metalness:null,ao:null,displacement:null,glossiness:null};for(const o of p)for(const[r,t]of Object.entries(i))for(const e of t)if(e.test(o)){if("normalDX"===r)break;const t="normal"===r?"normalGL":r;f[t]||(f[t]=o);break}return{folder:m,urlPrefix:`/models/textures/${m}/`,maps:f,files:p}});export{l as default};
