import{d as t,r,c as o,b as i}from"../../../nitro/nitro.mjs";import{mkdir as e,readFile as p,writeFile as s}from"fs/promises";import{join as m}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"node:url";const n=t(async t=>{const n=await r(t);if(!n||"string"!=typeof n.url||!n.url.trim())throw o({statusCode:400,message:"url (non-empty string) required"});const a=n.url.trim(),f=m(i(),"data","appdata","defaults");await e(f,{recursive:!0});const l=m(f,"tv-channels.json");let u=[];for(const t of[l])try{u=JSON.parse(await p(t,"utf-8"));break}catch{}const d=u.length;u=u.filter(t=>t.url!==a);const c=d-u.length;return await s(l,JSON.stringify(u,null,2),"utf-8"),{ok:!0,removed:c}});export{n as default};
