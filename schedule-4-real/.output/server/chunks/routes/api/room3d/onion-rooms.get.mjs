import{d as t,a as r}from"../../../nitro/nitro.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";const o=t(async t=>{const o=(r(t).trackers||"").split(",").map(t=>t.trim()).filter(t=>t.startsWith("https://")||t.startsWith("http://")).slice(0,10);if(!o.length)return{rooms:[]};const e=new Map,i=await Promise.allSettled(o.map(async t=>{const r=new AbortController,o=setTimeout(()=>r.abort(),3e3);try{const o=await fetch(`${t}/rooms`,{signal:r.signal});if(!o.ok)throw new Error(`HTTP ${o.status}`);return await o.json()}finally{clearTimeout(o)}}));for(const t of i){if("fulfilled"!==t.status)continue;const r=t.value;if((null==r?void 0:r.rooms)&&Array.isArray(r.rooms))for(const t of r.rooms)t.id&&t.metadata&&!e.has(t.id)&&e.set(t.id,{id:t.id,metadata:t.metadata,relay:t.relay||"",federated:!!t.federated})}return{rooms:Array.from(e.values())}});export{o as default};
