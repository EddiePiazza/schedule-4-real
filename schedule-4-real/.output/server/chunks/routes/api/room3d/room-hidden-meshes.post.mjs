import{d as t,r,c as o,b as e}from"../../../nitro/nitro.mjs";import{mkdir as i,readFile as s,writeFile as m}from"fs/promises";import{join as p}from"path";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"node:url";const n=t(async t=>{const n=await r(t);if(!n||"string"!=typeof n.roomId)throw o({statusCode:400,message:"roomId (string) required"});if(!Array.isArray(n.indices))throw o({statusCode:400,message:"indices (number[]) required"});const a=n.roomId.replace(/[^a-zA-Z0-9._-]/g,""),d=n.indices.filter(t=>"number"==typeof t&&Number.isInteger(t)&&t>=0),f=p(e(),"data","room3d");await i(f,{recursive:!0});const u=p(f,"room-hidden-meshes.json");let c={};try{c=JSON.parse(await s(u,"utf-8"))}catch{}return 0===d.length?delete c[a]:c[a]=d,await m(u,JSON.stringify(c,null,2),"utf-8"),{ok:!0}});export{n as default};
