import{d as t,a as o,c as r,k as e,h as s}from"../../../nitro/nitro.mjs";import"node:http";import"node:https";import"node:crypto";import"stream";import"events";import"http";import"crypto";import"buffer";import"zlib";import"https";import"net";import"tls";import"url";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"fs";import"path";import"fs/promises";import"node:url";const p=t(async t=>{const p=o(t).src;if(!p)throw r({statusCode:400,message:"src query parameter required"});const a=await e(t);if(!a)throw r({statusCode:400,message:"SDP offer body required"});try{const o=await fetch(`http://127.0.0.1:1984/api/webrtc?src=${encodeURIComponent(p)}`,{method:"POST",headers:{"Content-Type":"application/sdp"},body:a});if(!o.ok){const t=await o.text();throw r({statusCode:o.status,message:`go2rtc error: ${t}`})}const e=await o.text();return s(t,"Content-Type","application/sdp"),e}catch(t){if(t.statusCode)throw t;throw r({statusCode:502,message:`go2rtc unreachable: ${t.message}`})}});export{p as default};
