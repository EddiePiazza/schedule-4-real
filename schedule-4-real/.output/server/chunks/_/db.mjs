import r from"pg";const{Pool:t,types:e}=r;e.setTypeParser(1114,r=>r),e.setTypeParser(1184,r=>r);let n=null;function getPool(){return n||(n=new t({host:process.env.QUESTDB_HOST||"127.0.0.1",port:parseInt(process.env.QUESTDB_PG_PORT||"8812"),database:process.env.QUESTDB_DATABASE||"qdb",user:process.env.QUESTDB_USER||"spider",password:process.env.QUESTDB_PASSWORD||"spider123"})),n}async function query(r,t){const e=getPool();try{return(await e.query(r,t)).rows}catch(r){throw console.error("Database query error:",r),r}}const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function sanitizeUUID(r){if(!r||"string"!=typeof r)throw new Error("Invalid UUID: empty or not a string");if(!o.test(r))throw new Error(`Invalid UUID format: ${r}`);return r}function sanitizeString(r){return null==r?"":String(r).replace(/'/g,"''")}function sanitizeInt(r){const t=parseInt(r,10);if(isNaN(t))throw new Error(`Invalid integer: ${r}`);return t}function sanitizeFloat(r){const t=parseFloat(r);if(isNaN(t))throw new Error(`Invalid number: ${r}`);return t}export{getPool,query,sanitizeFloat,sanitizeInt,sanitizeString,sanitizeUUID};
